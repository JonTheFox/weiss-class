{"version":3,"sources":["../../node_modules/@firebase/app/node_modules/tslib/tslib.es6.js","../../src/logger.ts","../../src/errors.ts","../../src/constants.ts","../../src/firebaseApp.ts","../../src/firebaseNamespaceCore.ts","../../src/firebaseNamespace.ts","../../src/platformLoggerService.ts","../../index.ts","../../src/registerCoreComponents.ts","../../src/crypt.ts","../../src/deepCopy.ts","../../src/deferred.ts","../../src/environment.ts","../../src/obj.ts","../../src/sha1.ts","../../src/subscribe.ts","../../node_modules/@firebase/storage/node_modules/tslib/tslib.es6.js","../../src/implementation/error.ts","../../src/implementation/string.ts","../../src/implementation/taskenums.ts","../../src/implementation/xhrio.ts","../../src/implementation/xhrio_network.ts","../../src/implementation/xhriopool.ts","../../src/implementation/type.ts","../../src/implementation/fs.ts","../../src/implementation/blob.ts","../../src/implementation/location.ts","../../src/implementation/constants.ts","../../src/implementation/json.ts","../../src/implementation/path.ts","../../src/implementation/url.ts","../../src/implementation/metadata.ts","../../src/implementation/list.ts","../../src/implementation/requestinfo.ts","../../src/implementation/requests.ts","../../src/implementation/observer.ts","../../src/tasksnapshot.ts","../../src/implementation/async.ts","../../src/task.ts","../../src/reference.ts","../../compat/tasksnapshot.ts","../../compat/task.ts","../../compat/list.ts","../../compat/reference.ts","../../src/implementation/failrequest.ts","../../src/implementation/request.ts","../../src/implementation/backoff.ts","../../src/service.ts","../../compat/service.ts","../../compat/index.ts","../../node_modules/@firebase/component/node_modules/tslib/tslib.es6.js","../../src/component.ts","../../src/provider.ts","../../src/component_container.ts","../node_modules/@material-ui/core/esm/Grid/Grid.js","../node_modules/react-images-upload/compiled.js","../node_modules/react-flip-move/dist/react-flip-move.es.js","../node_modules/react-images-upload/UploadIcon.svg","../../node_modules/@firebase/util/node_modules/tslib/tslib.es6.js","../node_modules/@material-ui/core/esm/Step/Step.js","../node_modules/@material-ui/core/esm/internal/svg-icons/CheckCircle.js","../node_modules/@material-ui/core/esm/internal/svg-icons/Warning.js","../node_modules/@material-ui/core/esm/StepIcon/StepIcon.js","../node_modules/@material-ui/core/esm/StepLabel/StepLabel.js","../node_modules/@material-ui/core/esm/StepConnector/StepConnector.js","../node_modules/@material-ui/core/esm/Stepper/Stepper.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__values","o","Symbol","iterator","m","next","value","done","TypeError","_a","logger","Logger","options","config","firebase_","isDeleted_","name_","name","automaticDataCollectionEnabled_","automaticDataCollectionEnabled","options_","container","_addComponent","INTERNAL","components","values","component","checkDestroyed_","val","delete","Promise","resolve","then","removeApp","all","getProviders","map","provider","_getService","instanceIdentifier","getProvider","getImmediate","identifier","_removeServiceInstance","clearInstance","addComponent","e","debug","_addOrOverwriteComponent","addOrOverwriteComponent","toJSON","ERROR_FACTORY","create","appName","console","log","createFirebaseNamespaceCore","firebaseAppImpl","apps","Map","namespace","__esModule","initializeApp","rawConfig","undefined","String","app","registerVersion","libraryKeyOrName","version","variant","library","PLATFORM_LOG_STRING","libraryMismatch","match","versionMismatch","warning","push","warn","join","registerComponent","setLogLevel","onLog","logCallback","setUserLogHandler","SDK_VERSION","useAsService","componentName","has","type","set","serviceNamespace","appArg","serviceProps","serviceFxn","bind","multipleInstances","args","keys","defineProperty","get","createFirebaseNamespace","extendNamespace","props","createSubscribe","ErrorFactory","deepExtend","getPlatformInfoString","getComponent","isVersionServiceProvider","service","filter","logString","firebaseNamespace","firebase","PlatformLoggerService","stringToByteArray","str","out","c","charCodeAt","deepCopy","target","source","constructor","Date","getTime","Array","prop","reject","promise","wrapCallback","callback","error","catch","isNode","toString","global","process","isBrowser","self","code","message","customData","setPrototypeOf","FirebaseError","Error","captureStackTrace","serviceName","errors","data","fullCode","template","replaceTemplate","fullMessage","replace","PATTERN","_","key","contains","obj","chain_","buf_","W_","pad_","inbuf_","total_","blockSize","reset","compress_","buf","offset","W","f","k","a","b","d","update","bytes","lengthMinusBlock","inbuf","digest","totalBits","j","executor","onNoObservers","proxy","ObserverProxy","subscribe","observers","unsubscribes","observerCount","task","finalized","forEachObserver","observer","close","complete","nextOrObserver","methods","method","implementsAnyMethods","noop","unsub","unsubscribeOne","finalError","fn","sendOne","err","extendStatics","__proto__","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","rejected","result","__generator","body","y","g","label","sent","trys","ops","verb","v","op","pop","__spreadArrays","il","r","jl","prependCode","serverResponse","FirebaseStorageError","__","codeEquals","Code","unknown","cannotSliceBlob","invalidArgument","appDeleted","invalidRootOperation","invalidFormat","format","internalError","StringFormat","RAW","BASE64","BASE64URL","DATA_URL","contentType","dataFromString","stringData","StringData","utf8Bytes_","base64Bytes_","dataUrl","parts","DataURLParts","base64","rest","decoded","decodeURIComponent","percentEncodedBytes_","dataURLBytes_","Uint8Array","hasMinus","indexOf","hasUnder","hasPlus","hasSlash","atob","array","dataURL","matches","middle","end","substring","ErrorCode","TaskEvent","STATE_CHANGED","InternalTaskState","TaskState","RUNNING","PAUSED","SUCCESS","CANCELED","ERROR","taskStateFromInternalTaskState","state","sent_","xhr_","XMLHttpRequest","errorCode_","NO_ERROR","sendPromise_","addEventListener","ABORT","NETWORK_ERROR","send","url","headers","open","setRequestHeader","getErrorCode","getStatus","status","getResponseText","responseText","abort","getResponseHeader","header","addUploadProgressListener","listener","upload","removeUploadProgressListener","removeEventListener","createXhrIo","NetworkXhrIo","isString","isNativeBlob","isNativeBlobDefined","Blob","validateNumber","argument","minValue","maxValue","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","getBlob","bb","append","type.isNativeBlobDefined","elideCopy","size","blobType","type.isNativeBlob","data_","ArrayBuffer","byteLength","size_","type_","slice","startByte","endByte","sliced","blob","start","webkitSlice","mozSlice","fs.sliceBlob","FbsBlob","buffer","blobby","fs.getBlob","uint8Arrays","type.isString","forEach","uploadData","bucket","path","path_","fullServerUrl","encode","encodeURIComponent","bucketOnlyServerUrl","makeFromBucketSpec","bucketString","bucketLocation","Location","makeFromUrl","location","gsRegex","RegExp","httpModify","loc","firebaseStorageHost","groups","regex","indices","postModify","charAt","group","captures","exec","bucketValue","pathValue","invalidUrl","jsonObjectOrNull","JSON","parse","isArray","lastComponent","index","lastIndexOf","makeUrl","urlPart","makeQueryString","params","queryPart","noXform_","metadata","server","local","writable","xform","mappings_","getMappings","mappings","Mapping","nameMapping","_metadata","fullPath","path.lastComponent","xformPath","sizeMapping","Number","fromResource","resource","len","mapping","makeStorageReference","addRef","fromResourceString","resourceString","json.jsonObjectOrNull","toResourceString","stringify","fromResponseString","listResult","prefixes","items","nextPageToken","pathWithoutTrailingSlash","reference","item","fromBackendResponse","handler","timeout","urlParams","errorHandler","progressCallback","successCodes","additionalRetryCodes","handlerCheck","cndn","metadataHandler","xhr","text","MetadataUtils.fromResourceString","downloadUrlHandler","tokens","split","token","UrlUtils.makeUrl","UrlUtils.makeQueryString","alt","MetadataUtils.downloadUrlFromResourceString","sharedErrorHandler","newErr","objectErrorHandler","shared","getMetadata","maxOperationRetryTime","requestInfo","RequestInfo","list","delimiter","pageToken","maxResults","isRoot","ListResultUtils.fromResponseString","listHandler","metadataForUpload_","metadataClone","determineContentType_","current","total","checkResumeHeader_","allowed","continueResumableUpload","chunkSize","status_","ResumableUploadStatus","bytesLeft","bytesToUpload","Math","min","maxUploadRetryTime","uploadStatus","newCurrent","bytesTransferred","totalBytes","ref","argsToForward","_transferred","_needToFetchStatus","_needToFetchMetadata","_observers","_error","_uploadUrl","_request","_chunkMultiplier","_resolve","_reject","_ref","_blob","_mappings","_resumable","_shouldDoResumable","_state","_errorHandler","completeTransitions_","_transition","_metadataErrorHandler","_promise","_start","_makeProgressCallback","sizeBefore","loaded","_updateProgress","_createResumable","_fetchStatus","_fetchMetadata","_continueUpload","_oneShotUpload","_resolveToken","storage","getAuthToken","authToken","metadataForUpload","MetadataUtils.toResourceString","fbsRequests.createResumableUpload","_location","createRequest","makeRequest","getPromise","sizeString","isNaN","fbsRequests.getResumableUploadStatus","statusRequest","fbsRequests.ResumableUploadStatus","fbsRequests.continueResumableUpload","uploadRequest","newStatus","_increaseMultiplier","fbsRequests.getMetadata","metadataRequest","boundary","random","genBoundary","metadata_","preBlobPart","postBlobPart","fbsRequests.multipartUpload","multipartRequest","transferred","old","_notifyObservers","cancel","wasPaused","externalState","UploadTaskSnapshot","on","completed","Observer","_addObserver","_removeObserver","onFulfilled","onRejected","_notifyObserver","splice","_finishPromise","triggered","fbsAsync","snapshot","resume","valid","pause","_service","newRef","Reference","newPath","_throwIfRoot","listAll","accumulator","listAllHelper","nextPage","requestsList","updateMetadata","requestsUpdateMetadata","getDownloadURL","requestsGetDownloadUrl","deleteObject","_xhr","_text","requestsDeleteObject","getChild","childPath","canonicalChildPath","child","_delegate","_snapshot","UploadTaskSnapshotCompat","wrappedNextOrObserver","taskSnapshot","ReferenceCompat","root","parent","put","UploadTaskCompat","UploadTask","uploadBytesResumable","putString","uploadString","ListResultCompat","requestsGetMetadata","promise_","_appDelete","errorCallback","pool","pendingXhr_","backoffId_","canceled_","appDelete_","url_","method_","headers_","body_","successCodes_","additionalRetryCodes_","callback_","errorCallback_","progressCallback_","timeout_","pool_","resolve_","reject_","start_","backoffDone","requestWentThrough","wasSuccessCode","canceled","RequestEndStatus","waitSeconds","timeoutId","hitTimeout","cancelState","triggeredCallback","triggerCallback","callWithDelay","millis","setTimeout","success","waitMillis","mustStop","stopped","stop","wasTimeout","clearTimeout","backoff.start","backoffCallback","progressListener","hitServer","isRetryStatusCode_","successCode","wasCanceled","progressEvent","lengthComputable","appDelete","backoff.stop","isFiveHundredCode","isExtraRetryCode","isRequestSpecificRetryCode","appId","addGmpidHeader_","addAuthHeader_","addVersionHeader_","NetworkRequest","isUrl","test","refFromPath","_bucket","includes","serviceOrRef","pathOrUrl","_authProvider","_pool","_url","_appId","_deleted","_maxOperationRetryTime","_maxUploadRetryTime","_requests","Set","extractBucket","time","POSITIVE_INFINITY","auth","optional","getToken","tokenData","accessToken","_delete","request","clear","FailRequest","add","refFromURL","setMaxUploadRetryTime","setMaxOperationRetryTime","factory","authProvider","StorageServiceCompat","XhrIoPool","instance","namespaceExports","Storage","setServiceProps","setMultipleInstances","registerStorage","__read","ar","__spread","concat","instanceFactory","instantiationMode","setInstantiationMode","mode","instances","instancesDeferred","normalizedIdentifier","normalizeInstanceIdentifier","deferred","getOrInitializeService","setComponent","isComponentEager","entries","instanceDeferred","services","from","isComponentSet","normalizeIdentifierForFactory","providers","SPACINGS","GRID_SIZES","getOffset","div","parseFloat","Grid","React","_props$alignContent","alignContent","_props$alignItems","alignItems","classes","classNameProp","className","_props$component","Component","_props$container","_props$direction","direction","_props$item","_props$justify","justify","_props$lg","lg","_props$md","md","_props$sm","sm","_props$spacing","spacing","_props$wrap","wrap","_props$xl","xl","_props$xs","xs","_props$zeroMinWidth","zeroMinWidth","other","_objectWithoutProperties","clsx","_extends","StyledGrid","withStyles","theme","boxSizing","display","flexWrap","width","margin","minWidth","flexDirection","justifyContent","breakpoint","styles","themeSpacing","padding","generateGutter","breakpoints","reduce","globalStyles","round","flexBasis","flexGrow","maxWidth","up","generateGrid","exports","_createClass","defineProperties","descriptor","enumerable","configurable","Constructor","protoProps","staticProps","_react2","_interopRequireDefault","require","_propTypes2","_reactFlipMove2","_UploadIcon2","default","_toConsumableArray","arr","arr2","ReactImageUploadComponent","_React$Component","_classCallCheck","_this","ReferenceError","_possibleConstructorReturn","getPrototypeOf","pictures","defaultImages","files","fileErrors","inputElement","onDropFile","onUploadClick","triggerFileUpload","subClass","superClass","_inherits","prevProps","prevState","onChange","nextProps","setState","fileName","pattern","imgExtension","_this2","allFilePromises","file","fileError","hasExtension","maxFileSize","readFile","singleImage","newFilesData","dataURLs","newFileData","reader","FileReader","onload","readAsDataURL","picture","_this3","removeIndex","findIndex","filteredPictures","filteredFiles","_this4","createElement","errorClass","style","errorStyle","fileSizeError","fileTypeError","withIcon","src","withLabel","labelClass","labelStyles","enterAnimation","leaveAnimation","renderPreviewPictures","_this5","onClick","removeImage","click","_this6","fileContainerStyle","renderIcon","renderLabel","renderErrors","buttonType","buttonClassName","buttonStyles","buttonText","input","multiple","accept","withPreview","renderPreview","defaultProps","propTypes","object","string","func","onDelete","bool","number","warnOnce","msg","hasWarned","parentNodePositionStatic","childIsDisabled","enterPresets","elevator","transform","opacity","to","fade","accordionVertical","transformOrigin","accordionHorizontal","none","leavePresets","appearPresets","find","predicate","_isArray","arg","hyphenate","cache","memoizeString","toLowerCase","_typeof","classCallCheck","inherits","possibleConstructorReturn","propConverter","ComposedComponent","_class","_temp","_Component","FlipMovePropConverter","checkChildren","children","convertProps","workingProps","easing","onStart","onFinish","onStartAll","onFinishAll","typeName","disableAllAnimations","getPosition","maintainContainerHeight","verticalAlignment","duration","convertTimingProp","delay","staggerDurationBy","staggerDelayBy","appearAnimation","convertAnimationProp","delegated","primaryPropKeys","delegatedProps","attrs","omit","position","rawValue","parseInt","animation","presets","render","node","getBoundingClientRect","applyStylesToDOMNode","domNode","setProperty","getPositionDelta","_ref3","childDomNode","defaultBox","top","left","right","bottom","height","oldRelativeBox","childBoundingBox","parentBox","parentBoundingBox","newAbsoluteBox","newRelativeBox","createTransitionString","transitionEnd","transitions","transition","document","el","getPropertyValue","whichTransitionEvent","noBrowserSupport","getKey","childData","getElementChildren","Children","toArray","enhancedFlipMove","FlipMove","_len","_key","element","appearing","childrenData","parentData","boundingBox","heightPlaceholderData","remainingAnimations","childrenToAnimate","findDOMContainer","ReactDOM","findDOMNode","parentNode","HTMLElement","window","getComputedStyle","runAnimation","dynamicChildren","doesChildNeedToBeAnimated","childrenInitialStyles","computeInitialStyles","animateChild","callChildrenHook","getChildData","_this$props","isAppearingWithAnimation","isEnteringWithAnimation","entering","isLeavingWithAnimation","leaving","_getPositionDelta","dX","dY","componentDidMount","isAnimationDisabled","prepForAnimation","componentDidUpdate","previousProps","notBothArrays","differentLengths","every","arraysEqual","calculateNextSetOfChildren","nextChildren","updatedChildren","nextChild","findChildByKey","isEntering","numOfChildrenLeaving","nextChildIndex","_props","leavingChild","disabled","computed","margins","acc","_babelHelpers$extends","propertyVal","removeNodeFromDOMFlow","_ref4","parentDomNode","reductionInHeight","updateHeightPlaceholder","UNSAFE_componentWillReceiveProps","updateBoundingBoxCaches","childInitialStyles","requestAnimationFrame","bindTransitionEndHandler","transitionEndHandler","ev","triggerFinishHooks","removeChildData","_ref2","hook","_this7","elements","domNodes","childKey","hasChildData","_this8","childrenBoundingBoxes","_getPosition","getRelativeBoundingBox","setChildData","_getPositionDelta2","createHeightPlaceholder","_this9","placeholderType","visibility","childrenWithRefs","_this10","cloneElement","foundNode","nodeType","Node","TEXT_NODE","getNativeNode","_this11","_props2","module","__extends","Step","_props$active","active","alternativeLabel","_props$completed","connector","_props$disabled","_props$expanded","expanded","last","orientation","icon","horizontal","paddingLeft","paddingRight","vertical","flex","createSvgIcon","cx","cy","StepIcon","_props$error","Warning","CheckCircle","SvgIcon","x","textAnchor","color","palette","primary","main","fill","contrastText","fontSize","typography","caption","fontFamily","StepLabel","_props$alternativeLab","_props$orientation","StepIconComponentProp","StepIconComponent","StepIconProps","iconContainer","labelContainer","Typography","muiName","cursor","secondary","fontWeight","textAlign","marginTop","flexShrink","StepConnector","line","lineHorizontal","lineVertical","marginLeft","borderColor","grey","borderTopStyle","borderTopWidth","borderLeftStyle","borderLeftWidth","minHeight","defaultConnector","Stepper","_props$activeStep","activeStep","_props$connector","connectorProp","_props$nonLinear","nonLinear","childrenArray","steps","controlProps","Paper","square","elevation"],"mappings":"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","file":"static/js/5.a5163848.chunk.js","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Logger } from '@firebase/logger';\n\nexport const logger = new Logger('@firebase/app');\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Standardized Firebase Error.\n *\n * Usage:\n *\n *   // Typescript string literals for type-safe codes\n *   type Err =\n *     'unknown' |\n *     'object-not-found'\n *     ;\n *\n *   // Closure enum for type-safe error codes\n *   // at-enum {string}\n *   var Err = {\n *     UNKNOWN: 'unknown',\n *     OBJECT_NOT_FOUND: 'object-not-found',\n *   }\n *\n *   let errors: Map<Err, string> = {\n *     'generic-error': \"Unknown error\",\n *     'file-not-found': \"Could not find file: {$file}\",\n *   };\n *\n *   // Type-safe function - must pass a valid error code as param.\n *   let error = new ErrorFactory<Err>('service', 'Service', errors);\n *\n *   ...\n *   throw error.create(Err.GENERIC);\n *   ...\n *   throw error.create(Err.FILE_NOT_FOUND, {'file': fileName});\n *   ...\n *   // Service: Could not file file: foo.txt (service/file-not-found).\n *\n *   catch (e) {\n *     assert(e.message === \"Could not find file: foo.txt.\");\n *     if (e.code === 'service/file-not-found') {\n *       console.log(\"Could not read file: \" + e['file']);\n *     }\n *   }\n */\n\nexport type ErrorMap<ErrorCode extends string> = {\n  readonly [K in ErrorCode]: string;\n};\n\nconst ERROR_NAME = 'FirebaseError';\n\nexport interface StringLike {\n  toString(): string;\n}\n\nexport interface ErrorData {\n  [key: string]: unknown;\n}\n\n// Based on code from:\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\nexport class FirebaseError extends Error {\n  readonly name = ERROR_NAME;\n\n  constructor(\n    readonly code: string,\n    message: string,\n    public customData?: Record<string, unknown>\n  ) {\n    super(message);\n\n    // Fix For ES5\n    // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n    Object.setPrototypeOf(this, FirebaseError.prototype);\n\n    // Maintains proper stack trace for where our error was thrown.\n    // Only available on V8.\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ErrorFactory.prototype.create);\n    }\n  }\n}\n\nexport class ErrorFactory<\n  ErrorCode extends string,\n  ErrorParams extends { readonly [K in ErrorCode]?: ErrorData } = {}\n> {\n  constructor(\n    private readonly service: string,\n    private readonly serviceName: string,\n    private readonly errors: ErrorMap<ErrorCode>\n  ) {}\n\n  create<K extends ErrorCode>(\n    code: K,\n    ...data: K extends keyof ErrorParams ? [ErrorParams[K]] : []\n  ): FirebaseError {\n    const customData = (data[0] as ErrorData) || {};\n    const fullCode = `${this.service}/${code}`;\n    const template = this.errors[code];\n\n    const message = template ? replaceTemplate(template, customData) : 'Error';\n    // Service Name: Error message (service/code).\n    const fullMessage = `${this.serviceName}: ${message} (${fullCode}).`;\n\n    const error = new FirebaseError(fullCode, fullMessage, customData);\n\n    return error;\n  }\n}\n\nfunction replaceTemplate(template: string, data: ErrorData): string {\n  return template.replace(PATTERN, (_, key) => {\n    const value = data[key];\n    return value != null ? String(value) : `<${key}?>`;\n  });\n}\n\nconst PATTERN = /\\{\\$([^}]+)}/g;\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DEFAULT_ENTRY_NAME = '[DEFAULT]';\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FirebaseApp,\n  FirebaseOptions,\n  FirebaseAppConfig\n} from '@firebase/app-types';\nimport {\n  _FirebaseNamespace,\n  FirebaseService\n} from '@firebase/app-types/private';\nimport { deepCopy } from '@firebase/util';\nimport {\n  ComponentContainer,\n  Component,\n  ComponentType,\n  Name\n} from '@firebase/component';\nimport { AppError, ERROR_FACTORY } from './errors';\nimport { DEFAULT_ENTRY_NAME } from './constants';\nimport { logger } from './logger';\n\n/**\n * Global context object for a collection of services using\n * a shared authentication state.\n */\nexport class FirebaseAppImpl implements FirebaseApp {\n  private readonly options_: FirebaseOptions;\n  private readonly name_: string;\n  private isDeleted_ = false;\n  private automaticDataCollectionEnabled_: boolean;\n  private container: ComponentContainer;\n\n  constructor(\n    options: FirebaseOptions,\n    config: FirebaseAppConfig,\n    private readonly firebase_: _FirebaseNamespace\n  ) {\n    this.name_ = config.name!;\n    this.automaticDataCollectionEnabled_ =\n      config.automaticDataCollectionEnabled || false;\n    this.options_ = deepCopy<FirebaseOptions>(options);\n    this.container = new ComponentContainer(config.name!);\n\n    // add itself to container\n    this._addComponent(new Component('app', () => this, ComponentType.PUBLIC));\n    // populate ComponentContainer with existing components\n    for (const component of this.firebase_.INTERNAL.components.values()) {\n      this._addComponent(component);\n    }\n  }\n\n  get automaticDataCollectionEnabled(): boolean {\n    this.checkDestroyed_();\n    return this.automaticDataCollectionEnabled_;\n  }\n\n  set automaticDataCollectionEnabled(val) {\n    this.checkDestroyed_();\n    this.automaticDataCollectionEnabled_ = val;\n  }\n\n  get name(): string {\n    this.checkDestroyed_();\n    return this.name_;\n  }\n\n  get options(): FirebaseOptions {\n    this.checkDestroyed_();\n    return this.options_;\n  }\n\n  delete(): Promise<void> {\n    return new Promise(resolve => {\n      this.checkDestroyed_();\n      resolve();\n    })\n      .then(() => {\n        this.firebase_.INTERNAL.removeApp(this.name_);\n\n        return Promise.all(\n          this.container.getProviders().map(provider => provider.delete())\n        );\n      })\n      .then((): void => {\n        this.isDeleted_ = true;\n      });\n  }\n\n  /**\n   * Return a service instance associated with this app (creating it\n   * on demand), identified by the passed instanceIdentifier.\n   *\n   * NOTE: Currently storage and functions are the only ones that are leveraging this\n   * functionality. They invoke it by calling:\n   *\n   * ```javascript\n   * firebase.app().storage('STORAGE BUCKET ID')\n   * ```\n   *\n   * The service name is passed to this already\n   * @internal\n   */\n  _getService(\n    name: string,\n    instanceIdentifier: string = DEFAULT_ENTRY_NAME\n  ): FirebaseService {\n    this.checkDestroyed_();\n\n    // getImmediate will always succeed because _getService is only called for registered components.\n    return (this.container.getProvider(name as Name).getImmediate({\n      identifier: instanceIdentifier\n    }) as unknown) as FirebaseService;\n  }\n  /**\n   * Remove a service instance from the cache, so we will create a new instance for this service\n   * when people try to get this service again.\n   *\n   * NOTE: currently only firestore is using this functionality to support firestore shutdown.\n   *\n   * @param name The service name\n   * @param instanceIdentifier instance identifier in case multiple instances are allowed\n   * @internal\n   */\n  _removeServiceInstance(\n    name: string,\n    instanceIdentifier: string = DEFAULT_ENTRY_NAME\n  ): void {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this.container.getProvider(name as any).clearInstance(instanceIdentifier);\n  }\n\n  /**\n   * @param component the component being added to this app's container\n   */\n  _addComponent(component: Component): void {\n    try {\n      this.container.addComponent(component);\n    } catch (e) {\n      logger.debug(\n        `Component ${component.name} failed to register with FirebaseApp ${this.name}`,\n        e\n      );\n    }\n  }\n\n  _addOrOverwriteComponent(component: Component): void {\n    this.container.addOrOverwriteComponent(component);\n  }\n\n  toJSON(): object {\n    return {\n      name: this.name,\n      automaticDataCollectionEnabled: this.automaticDataCollectionEnabled,\n      options: this.options\n    };\n  }\n\n  /**\n   * This function will throw an Error if the App has already been deleted -\n   * use before performing API actions on the App.\n   */\n  private checkDestroyed_(): void {\n    if (this.isDeleted_) {\n      throw ERROR_FACTORY.create(AppError.APP_DELETED, { appName: this.name_ });\n    }\n  }\n}\n\n// Prevent dead-code elimination of these methods w/o invalid property\n// copying.\n(FirebaseAppImpl.prototype.name && FirebaseAppImpl.prototype.options) ||\n  FirebaseAppImpl.prototype.delete ||\n  console.log('dc');\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FirebaseApp,\n  FirebaseOptions,\n  FirebaseNamespace,\n  FirebaseAppConfig\n} from '@firebase/app-types';\nimport {\n  _FirebaseApp,\n  _FirebaseNamespace,\n  FirebaseService,\n  FirebaseServiceNamespace\n} from '@firebase/app-types/private';\nimport { deepExtend, contains } from '@firebase/util';\nimport { FirebaseAppImpl } from './firebaseApp';\nimport { ERROR_FACTORY, AppError } from './errors';\nimport { FirebaseAppLiteImpl } from './lite/firebaseAppLite';\nimport { DEFAULT_ENTRY_NAME, PLATFORM_LOG_STRING } from './constants';\nimport { version } from '../../firebase/package.json';\nimport { logger } from './logger';\nimport {\n  setUserLogHandler,\n  setLogLevel,\n  LogCallback,\n  LogOptions\n} from '@firebase/logger';\nimport { Component, ComponentType, Name } from '@firebase/component';\n\n/**\n * Because auth can't share code with other components, we attach the utility functions\n * in an internal namespace to share code.\n * This function return a firebase namespace object without\n * any utility functions, so it can be shared between the regular firebaseNamespace and\n * the lite version.\n */\nexport function createFirebaseNamespaceCore(\n  firebaseAppImpl: typeof FirebaseAppImpl | typeof FirebaseAppLiteImpl\n): FirebaseNamespace {\n  const apps: { [name: string]: FirebaseApp } = {};\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const components = new Map<string, Component<any>>();\n\n  // A namespace is a plain JavaScript Object.\n  const namespace: FirebaseNamespace = {\n    // Hack to prevent Babel from modifying the object returned\n    // as the firebase namespace.\n    // @ts-ignore\n    __esModule: true,\n    initializeApp,\n    // @ts-ignore\n    app,\n    registerVersion,\n    setLogLevel,\n    onLog,\n    // @ts-ignore\n    apps: null,\n    SDK_VERSION: version,\n    INTERNAL: {\n      registerComponent,\n      removeApp,\n      components,\n      useAsService\n    }\n  };\n\n  // Inject a circular default export to allow Babel users who were previously\n  // using:\n  //\n  //   import firebase from 'firebase';\n  //   which becomes: var firebase = require('firebase').default;\n  //\n  // instead of\n  //\n  //   import * as firebase from 'firebase';\n  //   which becomes: var firebase = require('firebase');\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (namespace as any)['default'] = namespace;\n\n  // firebase.apps is a read-only getter.\n  Object.defineProperty(namespace, 'apps', {\n    get: getApps\n  });\n\n  /**\n   * Called by App.delete() - but before any services associated with the App\n   * are deleted.\n   */\n  function removeApp(name: string): void {\n    delete apps[name];\n  }\n\n  /**\n   * Get the App object for a given name (or DEFAULT).\n   */\n  function app(name?: string): FirebaseApp {\n    name = name || DEFAULT_ENTRY_NAME;\n    if (!contains(apps, name)) {\n      throw ERROR_FACTORY.create(AppError.NO_APP, { appName: name });\n    }\n    return apps[name];\n  }\n\n  // @ts-ignore\n  app['App'] = firebaseAppImpl;\n  /**\n   * Create a new App instance (name must be unique).\n   */\n  function initializeApp(\n    options: FirebaseOptions,\n    config?: FirebaseAppConfig\n  ): FirebaseApp;\n  function initializeApp(options: FirebaseOptions, name?: string): FirebaseApp;\n  function initializeApp(\n    options: FirebaseOptions,\n    rawConfig = {}\n  ): FirebaseApp {\n    if (typeof rawConfig !== 'object' || rawConfig === null) {\n      const name = rawConfig;\n      rawConfig = { name };\n    }\n\n    const config = rawConfig as FirebaseAppConfig;\n\n    if (config.name === undefined) {\n      config.name = DEFAULT_ENTRY_NAME;\n    }\n\n    const { name } = config;\n\n    if (typeof name !== 'string' || !name) {\n      throw ERROR_FACTORY.create(AppError.BAD_APP_NAME, {\n        appName: String(name)\n      });\n    }\n\n    if (contains(apps, name)) {\n      throw ERROR_FACTORY.create(AppError.DUPLICATE_APP, { appName: name });\n    }\n\n    const app = new firebaseAppImpl(\n      options,\n      config,\n      namespace as _FirebaseNamespace\n    );\n\n    apps[name] = app;\n\n    return app;\n  }\n\n  /*\n   * Return an array of all the non-deleted FirebaseApps.\n   */\n  function getApps(): FirebaseApp[] {\n    // Make a copy so caller cannot mutate the apps list.\n    return Object.keys(apps).map(name => apps[name]);\n  }\n\n  function registerComponent(\n    component: Component\n  ): FirebaseServiceNamespace<FirebaseService> | null {\n    const componentName = component.name;\n    if (components.has(componentName)) {\n      logger.debug(\n        `There were multiple attempts to register component ${componentName}.`\n      );\n\n      return component.type === ComponentType.PUBLIC\n        ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (namespace as any)[componentName]\n        : null;\n    }\n\n    components.set(componentName, component);\n\n    // create service namespace for public components\n    if (component.type === ComponentType.PUBLIC) {\n      // The Service namespace is an accessor function ...\n      const serviceNamespace = (\n        appArg: FirebaseApp = app()\n      ): FirebaseService => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (typeof (appArg as any)[componentName] !== 'function') {\n          // Invalid argument.\n          // This happens in the following case: firebase.storage('gs:/')\n          throw ERROR_FACTORY.create(AppError.INVALID_APP_ARGUMENT, {\n            appName: componentName\n          });\n        }\n\n        // Forward service instance lookup to the FirebaseApp.\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return (appArg as any)[componentName]();\n      };\n\n      // ... and a container for service-level properties.\n      if (component.serviceProps !== undefined) {\n        deepExtend(serviceNamespace, component.serviceProps);\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (namespace as any)[componentName] = serviceNamespace;\n\n      // Patch the FirebaseAppImpl prototype\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (firebaseAppImpl.prototype as any)[componentName] =\n        // TODO: The eslint disable can be removed and the 'ignoreRestArgs'\n        // option added to the no-explicit-any rule when ESlint releases it.\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        function (...args: any) {\n          const serviceFxn = this._getService.bind(this, componentName);\n          return serviceFxn.apply(\n            this,\n            component.multipleInstances ? args : []\n          );\n        };\n    }\n\n    // add the component to existing app instances\n    for (const appName of Object.keys(apps)) {\n      (apps[appName] as _FirebaseApp)._addComponent(component);\n    }\n\n    return component.type === ComponentType.PUBLIC\n      ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (namespace as any)[componentName]\n      : null;\n  }\n\n  function registerVersion(\n    libraryKeyOrName: string,\n    version: string,\n    variant?: string\n  ): void {\n    // TODO: We can use this check to whitelist strings when/if we set up\n    // a good whitelist system.\n    let library = PLATFORM_LOG_STRING[libraryKeyOrName] ?? libraryKeyOrName;\n    if (variant) {\n      library += `-${variant}`;\n    }\n    const libraryMismatch = library.match(/\\s|\\//);\n    const versionMismatch = version.match(/\\s|\\//);\n    if (libraryMismatch || versionMismatch) {\n      const warning = [\n        `Unable to register library \"${library}\" with version \"${version}\":`\n      ];\n      if (libraryMismatch) {\n        warning.push(\n          `library name \"${library}\" contains illegal characters (whitespace or \"/\")`\n        );\n      }\n      if (libraryMismatch && versionMismatch) {\n        warning.push('and');\n      }\n      if (versionMismatch) {\n        warning.push(\n          `version name \"${version}\" contains illegal characters (whitespace or \"/\")`\n        );\n      }\n      logger.warn(warning.join(' '));\n      return;\n    }\n    registerComponent(\n      new Component(\n        `${library}-version` as Name,\n        () => ({ library, version }),\n        ComponentType.VERSION\n      )\n    );\n  }\n\n  function onLog(logCallback: LogCallback | null, options?: LogOptions): void {\n    if (logCallback !== null && typeof logCallback !== 'function') {\n      throw ERROR_FACTORY.create(AppError.INVALID_LOG_ARGUMENT, {\n        appName: name\n      });\n    }\n    setUserLogHandler(logCallback, options);\n  }\n\n  // Map the requested service to a registered service name\n  // (used to map auth to serverAuth service when needed).\n  function useAsService(app: FirebaseApp, name: string): string | null {\n    if (name === 'serverAuth') {\n      return null;\n    }\n\n    const useService = name;\n\n    return useService;\n  }\n\n  return namespace;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseNamespace } from '@firebase/app-types';\nimport { _FirebaseNamespace } from '@firebase/app-types/private';\nimport { createSubscribe, deepExtend, ErrorFactory } from '@firebase/util';\nimport { FirebaseAppImpl } from './firebaseApp';\nimport { createFirebaseNamespaceCore } from './firebaseNamespaceCore';\n\n/**\n * Return a firebase namespace object.\n *\n * In production, this will be called exactly once and the result\n * assigned to the 'firebase' global.  It may be called multiple times\n * in unit tests.\n */\nexport function createFirebaseNamespace(): FirebaseNamespace {\n  const namespace = createFirebaseNamespaceCore(FirebaseAppImpl);\n  (namespace as _FirebaseNamespace).INTERNAL = {\n    ...(namespace as _FirebaseNamespace).INTERNAL,\n    createFirebaseNamespace,\n    extendNamespace,\n    createSubscribe,\n    ErrorFactory,\n    deepExtend\n  };\n\n  /**\n   * Patch the top-level firebase namespace with additional properties.\n   *\n   * firebase.INTERNAL.extendNamespace()\n   */\n  function extendNamespace(props: { [prop: string]: unknown }): void {\n    deepExtend(namespace, props);\n  }\n\n  return namespace;\n}\n\nexport const firebase = createFirebaseNamespace();\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ComponentContainer,\n  ComponentType,\n  Provider,\n  Name\n} from '@firebase/component';\n\nexport class PlatformLoggerService {\n  constructor(private readonly container: ComponentContainer) {}\n  // In initial implementation, this will be called by installations on\n  // auth token refresh, and installations will send this string.\n  getPlatformInfoString(): string {\n    const providers = this.container.getProviders();\n    // Loop through providers and get library/version pairs from any that are\n    // version components.\n    return providers\n      .map(provider => {\n        if (isVersionServiceProvider(provider)) {\n          const service = provider.getImmediate();\n          return `${service.library}/${service.version}`;\n        } else {\n          return null;\n        }\n      })\n      .filter(logString => logString)\n      .join(' ');\n  }\n}\n/**\n *\n * @param provider check if this provider provides a VersionService\n *\n * NOTE: Using Provider<'app-version'> is a hack to indicate that the provider\n * provides VersionService. The provider is not necessarily a 'app-version'\n * provider.\n */\nfunction isVersionServiceProvider(\n  provider: Provider<Name>\n): provider is Provider<'app-version'> {\n  const component = provider.getComponent();\n  return component?.type === ComponentType.VERSION;\n}\n","/**\n * @license\n * Copyright 2018 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from '@firebase/app';\nimport { name, version } from '../package.json';\n\nfirebase.registerVersion(name, version, 'app');\n\nexport default firebase;\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseNamespace } from '@firebase/app-types';\nimport { _FirebaseNamespace } from '@firebase/app-types/private';\nimport { Component, ComponentType } from '@firebase/component';\nimport { PlatformLoggerService } from './platformLoggerService';\nimport { name, version } from '../package.json';\n\nexport function registerCoreComponents(\n  firebase: FirebaseNamespace,\n  variant?: string\n): void {\n  (firebase as _FirebaseNamespace).INTERNAL.registerComponent(\n    new Component(\n      'platform-logger',\n      container => new PlatformLoggerService(container),\n      ComponentType.PRIVATE\n    )\n  );\n  // Register `app` package.\n  firebase.registerVersion(name, version, variant);\n  // Register platform SDK identifier (no version).\n  firebase.registerVersion('fire-js', '');\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst stringToByteArray = function (str: string): number[] {\n  // TODO(user): Use native implementations if/when available\n  const out: number[] = [];\n  let p = 0;\n  for (let i = 0; i < str.length; i++) {\n    let c = str.charCodeAt(i);\n    if (c < 128) {\n      out[p++] = c;\n    } else if (c < 2048) {\n      out[p++] = (c >> 6) | 192;\n      out[p++] = (c & 63) | 128;\n    } else if (\n      (c & 0xfc00) === 0xd800 &&\n      i + 1 < str.length &&\n      (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00\n    ) {\n      // Surrogate Pair\n      c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);\n      out[p++] = (c >> 18) | 240;\n      out[p++] = ((c >> 12) & 63) | 128;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    } else {\n      out[p++] = (c >> 12) | 224;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    }\n  }\n  return out;\n};\n\n/**\n * Turns an array of numbers into the string given by the concatenation of the\n * characters to which the numbers correspond.\n * @param bytes Array of numbers representing characters.\n * @return Stringification of the array.\n */\nconst byteArrayToString = function (bytes: number[]): string {\n  // TODO(user): Use native implementations if/when available\n  const out: string[] = [];\n  let pos = 0,\n    c = 0;\n  while (pos < bytes.length) {\n    const c1 = bytes[pos++];\n    if (c1 < 128) {\n      out[c++] = String.fromCharCode(c1);\n    } else if (c1 > 191 && c1 < 224) {\n      const c2 = bytes[pos++];\n      out[c++] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));\n    } else if (c1 > 239 && c1 < 365) {\n      // Surrogate Pair\n      const c2 = bytes[pos++];\n      const c3 = bytes[pos++];\n      const c4 = bytes[pos++];\n      const u =\n        (((c1 & 7) << 18) | ((c2 & 63) << 12) | ((c3 & 63) << 6) | (c4 & 63)) -\n        0x10000;\n      out[c++] = String.fromCharCode(0xd800 + (u >> 10));\n      out[c++] = String.fromCharCode(0xdc00 + (u & 1023));\n    } else {\n      const c2 = bytes[pos++];\n      const c3 = bytes[pos++];\n      out[c++] = String.fromCharCode(\n        ((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63)\n      );\n    }\n  }\n  return out.join('');\n};\n\ninterface Base64 {\n  byteToCharMap_: { [key: number]: string } | null;\n  charToByteMap_: { [key: string]: number } | null;\n  byteToCharMapWebSafe_: { [key: number]: string } | null;\n  charToByteMapWebSafe_: { [key: string]: number } | null;\n  ENCODED_VALS_BASE: string;\n  readonly ENCODED_VALS: string;\n  readonly ENCODED_VALS_WEBSAFE: string;\n  HAS_NATIVE_SUPPORT: boolean;\n  encodeByteArray(input: number[] | Uint8Array, webSafe?: boolean): string;\n  encodeString(input: string, webSafe?: boolean): string;\n  decodeString(input: string, webSafe: boolean): string;\n  decodeStringToByteArray(input: string, webSafe: boolean): number[];\n  init_(): void;\n}\n\n// We define it as an object literal instead of a class because a class compiled down to es5 can't\n// be treeshaked. https://github.com/rollup/rollup/issues/1691\n// Static lookup maps, lazily populated by init_()\nexport const base64: Base64 = {\n  /**\n   * Maps bytes to characters.\n   */\n  byteToCharMap_: null,\n\n  /**\n   * Maps characters to bytes.\n   */\n  charToByteMap_: null,\n\n  /**\n   * Maps bytes to websafe characters.\n   * @private\n   */\n  byteToCharMapWebSafe_: null,\n\n  /**\n   * Maps websafe characters to bytes.\n   * @private\n   */\n  charToByteMapWebSafe_: null,\n\n  /**\n   * Our default alphabet, shared between\n   * ENCODED_VALS and ENCODED_VALS_WEBSAFE\n   */\n  ENCODED_VALS_BASE:\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\n\n  /**\n   * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\n   */\n  get ENCODED_VALS() {\n    return this.ENCODED_VALS_BASE + '+/=';\n  },\n\n  /**\n   * Our websafe alphabet.\n   */\n  get ENCODED_VALS_WEBSAFE() {\n    return this.ENCODED_VALS_BASE + '-_.';\n  },\n\n  /**\n   * Whether this browser supports the atob and btoa functions. This extension\n   * started at Mozilla but is now implemented by many browsers. We use the\n   * ASSUME_* variables to avoid pulling in the full useragent detection library\n   * but still allowing the standard per-browser compilations.\n   *\n   */\n  HAS_NATIVE_SUPPORT: typeof atob === 'function',\n\n  /**\n   * Base64-encode an array of bytes.\n   *\n   * @param input An array of bytes (numbers with\n   *     value in [0, 255]) to encode.\n   * @param webSafe Boolean indicating we should use the\n   *     alternative alphabet.\n   * @return The base64 encoded string.\n   */\n  encodeByteArray(input: number[] | Uint8Array, webSafe?: boolean): string {\n    if (!Array.isArray(input)) {\n      throw Error('encodeByteArray takes an array as a parameter');\n    }\n\n    this.init_();\n\n    const byteToCharMap = webSafe\n      ? this.byteToCharMapWebSafe_!\n      : this.byteToCharMap_!;\n\n    const output = [];\n\n    for (let i = 0; i < input.length; i += 3) {\n      const byte1 = input[i];\n      const haveByte2 = i + 1 < input.length;\n      const byte2 = haveByte2 ? input[i + 1] : 0;\n      const haveByte3 = i + 2 < input.length;\n      const byte3 = haveByte3 ? input[i + 2] : 0;\n\n      const outByte1 = byte1 >> 2;\n      const outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\n      let outByte3 = ((byte2 & 0x0f) << 2) | (byte3 >> 6);\n      let outByte4 = byte3 & 0x3f;\n\n      if (!haveByte3) {\n        outByte4 = 64;\n\n        if (!haveByte2) {\n          outByte3 = 64;\n        }\n      }\n\n      output.push(\n        byteToCharMap[outByte1],\n        byteToCharMap[outByte2],\n        byteToCharMap[outByte3],\n        byteToCharMap[outByte4]\n      );\n    }\n\n    return output.join('');\n  },\n\n  /**\n   * Base64-encode a string.\n   *\n   * @param input A string to encode.\n   * @param webSafe If true, we should use the\n   *     alternative alphabet.\n   * @return The base64 encoded string.\n   */\n  encodeString(input: string, webSafe?: boolean): string {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return btoa(input);\n    }\n    return this.encodeByteArray(stringToByteArray(input), webSafe);\n  },\n\n  /**\n   * Base64-decode a string.\n   *\n   * @param input to decode.\n   * @param webSafe True if we should use the\n   *     alternative alphabet.\n   * @return string representing the decoded value.\n   */\n  decodeString(input: string, webSafe: boolean): string {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return atob(input);\n    }\n    return byteArrayToString(this.decodeStringToByteArray(input, webSafe));\n  },\n\n  /**\n   * Base64-decode a string.\n   *\n   * In base-64 decoding, groups of four characters are converted into three\n   * bytes.  If the encoder did not apply padding, the input length may not\n   * be a multiple of 4.\n   *\n   * In this case, the last group will have fewer than 4 characters, and\n   * padding will be inferred.  If the group has one or two characters, it decodes\n   * to one byte.  If the group has three characters, it decodes to two bytes.\n   *\n   * @param input Input to decode.\n   * @param webSafe True if we should use the web-safe alphabet.\n   * @return bytes representing the decoded value.\n   */\n  decodeStringToByteArray(input: string, webSafe: boolean): number[] {\n    this.init_();\n\n    const charToByteMap = webSafe\n      ? this.charToByteMapWebSafe_!\n      : this.charToByteMap_!;\n\n    const output: number[] = [];\n\n    for (let i = 0; i < input.length; ) {\n      const byte1 = charToByteMap[input.charAt(i++)];\n\n      const haveByte2 = i < input.length;\n      const byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\n      ++i;\n\n      const haveByte3 = i < input.length;\n      const byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n\n      const haveByte4 = i < input.length;\n      const byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n\n      if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\n        throw Error();\n      }\n\n      const outByte1 = (byte1 << 2) | (byte2 >> 4);\n      output.push(outByte1);\n\n      if (byte3 !== 64) {\n        const outByte2 = ((byte2 << 4) & 0xf0) | (byte3 >> 2);\n        output.push(outByte2);\n\n        if (byte4 !== 64) {\n          const outByte3 = ((byte3 << 6) & 0xc0) | byte4;\n          output.push(outByte3);\n        }\n      }\n    }\n\n    return output;\n  },\n\n  /**\n   * Lazy static initialization function. Called before\n   * accessing any of the static map variables.\n   * @private\n   */\n  init_() {\n    if (!this.byteToCharMap_) {\n      this.byteToCharMap_ = {};\n      this.charToByteMap_ = {};\n      this.byteToCharMapWebSafe_ = {};\n      this.charToByteMapWebSafe_ = {};\n\n      // We want quick mappings back and forth, so we precompute two maps.\n      for (let i = 0; i < this.ENCODED_VALS.length; i++) {\n        this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\n        this.charToByteMap_[this.byteToCharMap_[i]] = i;\n        this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\n        this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\n\n        // Be forgiving when decoding and correctly decode both encodings.\n        if (i >= this.ENCODED_VALS_BASE.length) {\n          this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\n          this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\n        }\n      }\n    }\n  }\n};\n\n/**\n * URL-safe base64 encoding\n */\nexport const base64Encode = function (str: string): string {\n  const utf8Bytes = stringToByteArray(str);\n  return base64.encodeByteArray(utf8Bytes, true);\n};\n\n/**\n * URL-safe base64 decoding\n *\n * NOTE: DO NOT use the global atob() function - it does NOT support the\n * base64Url variant encoding.\n *\n * @param str To be decoded\n * @return Decoded result, if possible\n */\nexport const base64Decode = function (str: string): string | null {\n  try {\n    return base64.decodeString(str, true);\n  } catch (e) {\n    console.error('base64Decode failed: ', e);\n  }\n  return null;\n};\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Do a deep-copy of basic JavaScript Objects or Arrays.\n */\nexport function deepCopy<T>(value: T): T {\n  return deepExtend(undefined, value) as T;\n}\n\n/**\n * Copy properties from source to target (recursively allows extension\n * of Objects and Arrays).  Scalar values in the target are over-written.\n * If target is undefined, an object of the appropriate type will be created\n * (and returned).\n *\n * We recursively copy all child properties of plain Objects in the source- so\n * that namespace- like dictionaries are merged.\n *\n * Note that the target can be a function, in which case the properties in\n * the source Object are copied onto it as static properties of the Function.\n *\n * Note: we don't merge __proto__ to prevent prototype pollution\n */\nexport function deepExtend(target: unknown, source: unknown): unknown {\n  if (!(source instanceof Object)) {\n    return source;\n  }\n\n  switch (source.constructor) {\n    case Date:\n      // Treat Dates like scalars; if the target date object had any child\n      // properties - they will be lost!\n      const dateValue = source as Date;\n      return new Date(dateValue.getTime());\n\n    case Object:\n      if (target === undefined) {\n        target = {};\n      }\n      break;\n    case Array:\n      // Always copy the array source and overwrite the target.\n      target = [];\n      break;\n\n    default:\n      // Not a plain Object - treat it as a scalar.\n      return source;\n  }\n\n  for (const prop in source) {\n    // use isValidKey to guard against prototype pollution. See https://snyk.io/vuln/SNYK-JS-LODASH-450202\n    if (!source.hasOwnProperty(prop) || !isValidKey(prop)) {\n      continue;\n    }\n    (target as Record<string, unknown>)[prop] = deepExtend(\n      (target as Record<string, unknown>)[prop],\n      (source as Record<string, unknown>)[prop]\n    );\n  }\n\n  return target;\n}\n\nfunction isValidKey(key: string): boolean {\n  return key !== '__proto__';\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class Deferred<R> {\n  promise: Promise<R>;\n  reject: (value?: unknown) => void = () => {};\n  resolve: (value?: unknown) => void = () => {};\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve as (value?: unknown) => void;\n      this.reject = reject as (value?: unknown) => void;\n    });\n  }\n\n  /**\n   * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\n   * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\n   * and returns a node-style callback which will resolve or reject the Deferred's promise.\n   */\n  wrapCallback(\n    callback?: (error?: unknown, value?: unknown) => void\n  ): (error: unknown, value?: unknown) => void {\n    return (error, value?) => {\n      if (error) {\n        this.reject(error);\n      } else {\n        this.resolve(value);\n      }\n      if (typeof callback === 'function') {\n        // Attaching noop handler just in case developer wasn't expecting\n        // promises\n        this.promise.catch(() => {});\n\n        // Some of our callbacks don't expect a value and our own tests\n        // assert that the parameter length is 1\n        if (callback.length === 1) {\n          callback(error);\n        } else {\n          callback(error, value);\n        }\n      }\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CONSTANTS } from './constants';\n\n/**\n * Returns navigator.userAgent string or '' if it's not defined.\n * @return user agent string\n */\nexport function getUA(): string {\n  if (\n    typeof navigator !== 'undefined' &&\n    typeof navigator['userAgent'] === 'string'\n  ) {\n    return navigator['userAgent'];\n  } else {\n    return '';\n  }\n}\n\n/**\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\n *\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap\n * in the Ripple emulator) nor Cordova `onDeviceReady`, which would normally\n * wait for a callback.\n */\nexport function isMobileCordova(): boolean {\n  return (\n    typeof window !== 'undefined' &&\n    // @ts-ignore Setting up an broadly applicable index signature for Window\n    // just to deal with this case would probably be a bad idea.\n    !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) &&\n    /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())\n  );\n}\n\n/**\n * Detect Node.js.\n *\n * @return true if Node.js environment is detected.\n */\n// Node detection logic from: https://github.com/iliakan/detect-node/\nexport function isNode(): boolean {\n  try {\n    return (\n      Object.prototype.toString.call(global.process) === '[object process]'\n    );\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Detect Browser Environment\n */\nexport function isBrowser(): boolean {\n  return typeof self === 'object' && self.self === self;\n}\n\n/**\n * Detect browser extensions (Chrome and Firefox at least).\n */\ninterface BrowserRuntime {\n  id?: unknown;\n}\ndeclare const chrome: { runtime?: BrowserRuntime };\ndeclare const browser: { runtime?: BrowserRuntime };\nexport function isBrowserExtension(): boolean {\n  const runtime =\n    typeof chrome === 'object'\n      ? chrome.runtime\n      : typeof browser === 'object'\n      ? browser.runtime\n      : undefined;\n  return typeof runtime === 'object' && runtime.id !== undefined;\n}\n\n/**\n * Detect React Native.\n *\n * @return true if ReactNative environment is detected.\n */\nexport function isReactNative(): boolean {\n  return (\n    typeof navigator === 'object' && navigator['product'] === 'ReactNative'\n  );\n}\n\n/** Detects Electron apps. */\nexport function isElectron(): boolean {\n  return getUA().indexOf('Electron/') >= 0;\n}\n\n/** Detects Internet Explorer. */\nexport function isIE(): boolean {\n  const ua = getUA();\n  return ua.indexOf('MSIE ') >= 0 || ua.indexOf('Trident/') >= 0;\n}\n\n/** Detects Universal Windows Platform apps. */\nexport function isUWP(): boolean {\n  return getUA().indexOf('MSAppHost/') >= 0;\n}\n\n/**\n * Detect whether the current SDK build is the Node version.\n *\n * @return true if it's the Node SDK build.\n */\nexport function isNodeSdk(): boolean {\n  return CONSTANTS.NODE_CLIENT === true || CONSTANTS.NODE_ADMIN === true;\n}\n\n/** Returns true if we are running in Safari. */\nexport function isSafari(): boolean {\n  return (\n    !isNode() &&\n    navigator.userAgent.includes('Safari') &&\n    !navigator.userAgent.includes('Chrome')\n  );\n}\n\n/**\n * This method checks if indexedDB is supported by current browser/service worker context\n * @return true if indexedDB is supported by current browser/service worker context\n */\nexport function isIndexedDBAvailable(): boolean {\n  return 'indexedDB' in self && indexedDB != null;\n}\n\n/**\n * This method validates browser context for indexedDB by opening a dummy indexedDB database and reject\n * if errors occur during the database open operation.\n */\nexport function validateIndexedDBOpenable(): Promise<boolean> {\n  return new Promise((resolve, reject) => {\n    try {\n      let preExist: boolean = true;\n      const DB_CHECK_NAME =\n        'validate-browser-context-for-indexeddb-analytics-module';\n      const request = window.indexedDB.open(DB_CHECK_NAME);\n      request.onsuccess = () => {\n        request.result.close();\n        // delete database only when it doesn't pre-exist\n        if (!preExist) {\n          window.indexedDB.deleteDatabase(DB_CHECK_NAME);\n        }\n        resolve(true);\n      };\n      request.onupgradeneeded = () => {\n        preExist = false;\n      };\n\n      request.onerror = () => {\n        reject(request.error?.message || '');\n      };\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\n/**\n *\n * This method checks whether cookie is enabled within current browser\n * @return true if cookie is enabled within current browser\n */\nexport function areCookiesEnabled(): boolean {\n  if (!navigator || !navigator.cookieEnabled) {\n    return false;\n  }\n  return true;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function contains<T extends object>(obj: T, key: string): boolean {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nexport function safeGet<T extends object, K extends keyof T>(\n  obj: T,\n  key: K\n): T[K] | undefined {\n  if (Object.prototype.hasOwnProperty.call(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\nexport function isEmpty(obj: object): obj is {} {\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function map<K extends string, V, U>(\n  obj: { [key in K]: V },\n  fn: (value: V, key: K, obj: { [key in K]: V }) => U,\n  contextObj?: unknown\n): { [key in K]: U } {\n  const res: Partial<{ [key in K]: U }> = {};\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      res[key] = fn.call(contextObj, obj[key], key, obj);\n    }\n  }\n  return res as { [key in K]: U };\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview SHA-1 cryptographic hash.\n * Variable names follow the notation in FIPS PUB 180-3:\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\n *\n * Usage:\n *   var sha1 = new sha1();\n *   sha1.update(bytes);\n *   var hash = sha1.digest();\n *\n * Performance:\n *   Chrome 23:   ~400 Mbit/s\n *   Firefox 16:  ~250 Mbit/s\n *\n */\n\n/**\n * SHA-1 cryptographic hash constructor.\n *\n * The properties declared here are discussed in the above algorithm document.\n * @constructor\n * @final\n * @struct\n */\nexport class Sha1 {\n  /**\n   * Holds the previous values of accumulated variables a-e in the compress_\n   * function.\n   * @private\n   */\n  private chain_: number[] = [];\n\n  /**\n   * A buffer holding the partially computed hash result.\n   * @private\n   */\n  private buf_: number[] = [];\n\n  /**\n   * An array of 80 bytes, each a part of the message to be hashed.  Referred to\n   * as the message schedule in the docs.\n   * @private\n   */\n  private W_: number[] = [];\n\n  /**\n   * Contains data needed to pad messages less than 64 bytes.\n   * @private\n   */\n  private pad_: number[] = [];\n\n  /**\n   * @private {number}\n   */\n  private inbuf_: number = 0;\n\n  /**\n   * @private {number}\n   */\n  private total_: number = 0;\n\n  blockSize: number;\n\n  constructor() {\n    this.blockSize = 512 / 8;\n\n    this.pad_[0] = 128;\n    for (let i = 1; i < this.blockSize; ++i) {\n      this.pad_[i] = 0;\n    }\n\n    this.reset();\n  }\n\n  reset(): void {\n    this.chain_[0] = 0x67452301;\n    this.chain_[1] = 0xefcdab89;\n    this.chain_[2] = 0x98badcfe;\n    this.chain_[3] = 0x10325476;\n    this.chain_[4] = 0xc3d2e1f0;\n\n    this.inbuf_ = 0;\n    this.total_ = 0;\n  }\n\n  /**\n   * Internal compress helper function.\n   * @param buf Block to compress.\n   * @param offset Offset of the block in the buffer.\n   * @private\n   */\n  compress_(buf: number[] | Uint8Array | string, offset?: number): void {\n    if (!offset) {\n      offset = 0;\n    }\n\n    const W = this.W_;\n\n    // get 16 big endian words\n    if (typeof buf === 'string') {\n      for (let i = 0; i < 16; i++) {\n        // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\n        // have a bug that turns the post-increment ++ operator into pre-increment\n        // during JIT compilation.  We have code that depends heavily on SHA-1 for\n        // correctness and which is affected by this bug, so I've removed all uses\n        // of post-increment ++ in which the result value is used.  We can revert\n        // this change once the Safari bug\n        // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\n        // most clients have been updated.\n        W[i] =\n          (buf.charCodeAt(offset) << 24) |\n          (buf.charCodeAt(offset + 1) << 16) |\n          (buf.charCodeAt(offset + 2) << 8) |\n          buf.charCodeAt(offset + 3);\n        offset += 4;\n      }\n    } else {\n      for (let i = 0; i < 16; i++) {\n        W[i] =\n          (buf[offset] << 24) |\n          (buf[offset + 1] << 16) |\n          (buf[offset + 2] << 8) |\n          buf[offset + 3];\n        offset += 4;\n      }\n    }\n\n    // expand to 80 words\n    for (let i = 16; i < 80; i++) {\n      const t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\n      W[i] = ((t << 1) | (t >>> 31)) & 0xffffffff;\n    }\n\n    let a = this.chain_[0];\n    let b = this.chain_[1];\n    let c = this.chain_[2];\n    let d = this.chain_[3];\n    let e = this.chain_[4];\n    let f, k;\n\n    // TODO(user): Try to unroll this loop to speed up the computation.\n    for (let i = 0; i < 80; i++) {\n      if (i < 40) {\n        if (i < 20) {\n          f = d ^ (b & (c ^ d));\n          k = 0x5a827999;\n        } else {\n          f = b ^ c ^ d;\n          k = 0x6ed9eba1;\n        }\n      } else {\n        if (i < 60) {\n          f = (b & c) | (d & (b | c));\n          k = 0x8f1bbcdc;\n        } else {\n          f = b ^ c ^ d;\n          k = 0xca62c1d6;\n        }\n      }\n\n      const t = (((a << 5) | (a >>> 27)) + f + e + k + W[i]) & 0xffffffff;\n      e = d;\n      d = c;\n      c = ((b << 30) | (b >>> 2)) & 0xffffffff;\n      b = a;\n      a = t;\n    }\n\n    this.chain_[0] = (this.chain_[0] + a) & 0xffffffff;\n    this.chain_[1] = (this.chain_[1] + b) & 0xffffffff;\n    this.chain_[2] = (this.chain_[2] + c) & 0xffffffff;\n    this.chain_[3] = (this.chain_[3] + d) & 0xffffffff;\n    this.chain_[4] = (this.chain_[4] + e) & 0xffffffff;\n  }\n\n  update(bytes?: number[] | Uint8Array | string, length?: number): void {\n    // TODO(johnlenz): tighten the function signature and remove this check\n    if (bytes == null) {\n      return;\n    }\n\n    if (length === undefined) {\n      length = bytes.length;\n    }\n\n    const lengthMinusBlock = length - this.blockSize;\n    let n = 0;\n    // Using local instead of member variables gives ~5% speedup on Firefox 16.\n    const buf = this.buf_;\n    let inbuf = this.inbuf_;\n\n    // The outer while loop should execute at most twice.\n    while (n < length) {\n      // When we have no data in the block to top up, we can directly process the\n      // input buffer (assuming it contains sufficient data). This gives ~25%\n      // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\n      // the data is provided in large chunks (or in multiples of 64 bytes).\n      if (inbuf === 0) {\n        while (n <= lengthMinusBlock) {\n          this.compress_(bytes, n);\n          n += this.blockSize;\n        }\n      }\n\n      if (typeof bytes === 'string') {\n        while (n < length) {\n          buf[inbuf] = bytes.charCodeAt(n);\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      } else {\n        while (n < length) {\n          buf[inbuf] = bytes[n];\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      }\n    }\n\n    this.inbuf_ = inbuf;\n    this.total_ += length;\n  }\n\n  /** @override */\n  digest(): number[] {\n    const digest: number[] = [];\n    let totalBits = this.total_ * 8;\n\n    // Add pad 0x80 0x00*.\n    if (this.inbuf_ < 56) {\n      this.update(this.pad_, 56 - this.inbuf_);\n    } else {\n      this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\n    }\n\n    // Add # bits.\n    for (let i = this.blockSize - 1; i >= 56; i--) {\n      this.buf_[i] = totalBits & 255;\n      totalBits /= 256; // Don't use bit-shifting here!\n    }\n\n    this.compress_(this.buf_);\n\n    let n = 0;\n    for (let i = 0; i < 5; i++) {\n      for (let j = 24; j >= 0; j -= 8) {\n        digest[n] = (this.chain_[i] >> j) & 255;\n        ++n;\n      }\n    }\n    return digest;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport type NextFn<T> = (value: T) => void;\nexport type ErrorFn = (error: Error) => void;\nexport type CompleteFn = () => void;\n\nexport interface Observer<T> {\n  // Called once for each value in a stream of values.\n  next: NextFn<T>;\n\n  // A stream terminates by a single call to EITHER error() or complete().\n  error: ErrorFn;\n\n  // No events will be sent to next() once complete() is called.\n  complete: CompleteFn;\n}\n\nexport type PartialObserver<T> = Partial<Observer<T>>;\n\n// TODO: Support also Unsubscribe.unsubscribe?\nexport type Unsubscribe = () => void;\n\n/**\n * The Subscribe interface has two forms - passing the inline function\n * callbacks, or a object interface with callback properties.\n */\nexport interface Subscribe<T> {\n  (next?: NextFn<T>, error?: ErrorFn, complete?: CompleteFn): Unsubscribe;\n  (observer: PartialObserver<T>): Unsubscribe;\n}\n\nexport interface Observable<T> {\n  // Subscribe method\n  subscribe: Subscribe<T>;\n}\n\nexport type Executor<T> = (observer: Observer<T>) => void;\n\n/**\n * Helper to make a Subscribe function (just like Promise helps make a\n * Thenable).\n *\n * @param executor Function which can make calls to a single Observer\n *     as a proxy.\n * @param onNoObservers Callback when count of Observers goes to zero.\n */\nexport function createSubscribe<T>(\n  executor: Executor<T>,\n  onNoObservers?: Executor<T>\n): Subscribe<T> {\n  const proxy = new ObserverProxy<T>(executor, onNoObservers);\n  return proxy.subscribe.bind(proxy);\n}\n\n/**\n * Implement fan-out for any number of Observers attached via a subscribe\n * function.\n */\nclass ObserverProxy<T> implements Observer<T> {\n  private observers: Array<Observer<T>> | undefined = [];\n  private unsubscribes: Unsubscribe[] = [];\n  private onNoObservers: Executor<T> | undefined;\n  private observerCount = 0;\n  // Micro-task scheduling by calling task.then().\n  private task = Promise.resolve();\n  private finalized = false;\n  private finalError?: Error;\n\n  /**\n   * @param executor Function which can make calls to a single Observer\n   *     as a proxy.\n   * @param onNoObservers Callback when count of Observers goes to zero.\n   */\n  constructor(executor: Executor<T>, onNoObservers?: Executor<T>) {\n    this.onNoObservers = onNoObservers;\n    // Call the executor asynchronously so subscribers that are called\n    // synchronously after the creation of the subscribe function\n    // can still receive the very first value generated in the executor.\n    this.task\n      .then(() => {\n        executor(this);\n      })\n      .catch(e => {\n        this.error(e);\n      });\n  }\n\n  next(value: T): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.next(value);\n    });\n  }\n\n  error(error: Error): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.error(error);\n    });\n    this.close(error);\n  }\n\n  complete(): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.complete();\n    });\n    this.close();\n  }\n\n  /**\n   * Subscribe function that can be used to add an Observer to the fan-out list.\n   *\n   * - We require that no event is sent to a subscriber sychronously to their\n   *   call to subscribe().\n   */\n  subscribe(\n    nextOrObserver?: NextFn<T> | PartialObserver<T>,\n    error?: ErrorFn,\n    complete?: CompleteFn\n  ): Unsubscribe {\n    let observer: Observer<T>;\n\n    if (\n      nextOrObserver === undefined &&\n      error === undefined &&\n      complete === undefined\n    ) {\n      throw new Error('Missing Observer.');\n    }\n\n    // Assemble an Observer object when passed as callback functions.\n    if (\n      implementsAnyMethods(nextOrObserver as { [key: string]: unknown }, [\n        'next',\n        'error',\n        'complete'\n      ])\n    ) {\n      observer = nextOrObserver as Observer<T>;\n    } else {\n      observer = {\n        next: nextOrObserver as NextFn<T>,\n        error,\n        complete\n      } as Observer<T>;\n    }\n\n    if (observer.next === undefined) {\n      observer.next = noop as NextFn<T>;\n    }\n    if (observer.error === undefined) {\n      observer.error = noop as ErrorFn;\n    }\n    if (observer.complete === undefined) {\n      observer.complete = noop as CompleteFn;\n    }\n\n    const unsub = this.unsubscribeOne.bind(this, this.observers!.length);\n\n    // Attempt to subscribe to a terminated Observable - we\n    // just respond to the Observer with the final error or complete\n    // event.\n    if (this.finalized) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      this.task.then(() => {\n        try {\n          if (this.finalError) {\n            observer.error(this.finalError);\n          } else {\n            observer.complete();\n          }\n        } catch (e) {\n          // nothing\n        }\n        return;\n      });\n    }\n\n    this.observers!.push(observer as Observer<T>);\n\n    return unsub;\n  }\n\n  // Unsubscribe is synchronous - we guarantee that no events are sent to\n  // any unsubscribed Observer.\n  private unsubscribeOne(i: number): void {\n    if (this.observers === undefined || this.observers[i] === undefined) {\n      return;\n    }\n\n    delete this.observers[i];\n\n    this.observerCount -= 1;\n    if (this.observerCount === 0 && this.onNoObservers !== undefined) {\n      this.onNoObservers(this);\n    }\n  }\n\n  private forEachObserver(fn: (observer: Observer<T>) => void): void {\n    if (this.finalized) {\n      // Already closed by previous event....just eat the additional values.\n      return;\n    }\n\n    // Since sendOne calls asynchronously - there is no chance that\n    // this.observers will become undefined.\n    for (let i = 0; i < this.observers!.length; i++) {\n      this.sendOne(i, fn);\n    }\n  }\n\n  // Call the Observer via one of it's callback function. We are careful to\n  // confirm that the observe has not been unsubscribed since this asynchronous\n  // function had been queued.\n  private sendOne(i: number, fn: (observer: Observer<T>) => void): void {\n    // Execute the callback asynchronously\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.task.then(() => {\n      if (this.observers !== undefined && this.observers[i] !== undefined) {\n        try {\n          fn(this.observers[i]);\n        } catch (e) {\n          // Ignore exceptions raised in Observers or missing methods of an\n          // Observer.\n          // Log error to console. b/31404806\n          if (typeof console !== 'undefined' && console.error) {\n            console.error(e);\n          }\n        }\n      }\n    });\n  }\n\n  private close(err?: Error): void {\n    if (this.finalized) {\n      return;\n    }\n    this.finalized = true;\n    if (err !== undefined) {\n      this.finalError = err;\n    }\n    // Proxy is no longer needed - garbage collect references\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.task.then(() => {\n      this.observers = undefined;\n      this.onNoObservers = undefined;\n    });\n  }\n}\n\n/** Turn synchronous function into one called asynchronously. */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function async(fn: Function, onError?: ErrorFn): Function {\n  return (...args: unknown[]) => {\n    Promise.resolve(true)\n      .then(() => {\n        fn(...args);\n      })\n      .catch((error: Error) => {\n        if (onError) {\n          onError(error);\n        }\n      });\n  };\n}\n\n/**\n * Return true if the object passed in implements any of the named methods.\n */\nfunction implementsAnyMethods(\n  obj: { [key: string]: unknown },\n  methods: string[]\n): boolean {\n  if (typeof obj !== 'object' || obj === null) {\n    return false;\n  }\n\n  for (const method of methods) {\n    if (method in obj && typeof obj[method] === 'function') {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction noop(): void {\n  // do nothing\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { FirebaseError } from '@firebase/util';\n/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { CONFIG_STORAGE_BUCKET_KEY } from './constants';\n\nexport class FirebaseStorageError extends FirebaseError {\n  customData: { serverResponse: string | null } = { serverResponse: null };\n\n  constructor(code: Code, message: string) {\n    super(\n      prependCode(code),\n      `Firebase Storage: ${message} (${prependCode(code)})`\n    );\n    // Without this, `instanceof FirebaseStorageError`, in tests for example,\n    // returns false.\n    Object.setPrototypeOf(this, FirebaseStorageError.prototype);\n  }\n\n  codeEquals(code: Code): boolean {\n    return prependCode(code) === this.code;\n  }\n\n  get message(): string {\n    if (this.customData.serverResponse) {\n      return `${this.message}\\n${this.customData.serverResponse}`;\n    } else {\n      return this.message;\n    }\n  }\n\n  get serverResponse(): null | string {\n    return this.customData.serverResponse;\n  }\n\n  set serverResponse(serverResponse: string | null) {\n    this.customData.serverResponse = serverResponse;\n  }\n}\n\nexport const errors = {};\n\nexport type Code = string;\nexport const Code = {\n  // Shared between all platforms\n  UNKNOWN: 'unknown',\n  OBJECT_NOT_FOUND: 'object-not-found',\n  BUCKET_NOT_FOUND: 'bucket-not-found',\n  PROJECT_NOT_FOUND: 'project-not-found',\n  QUOTA_EXCEEDED: 'quota-exceeded',\n  UNAUTHENTICATED: 'unauthenticated',\n  UNAUTHORIZED: 'unauthorized',\n  RETRY_LIMIT_EXCEEDED: 'retry-limit-exceeded',\n  INVALID_CHECKSUM: 'invalid-checksum',\n  CANCELED: 'canceled',\n  // JS specific\n  INVALID_EVENT_NAME: 'invalid-event-name',\n  INVALID_URL: 'invalid-url',\n  INVALID_DEFAULT_BUCKET: 'invalid-default-bucket',\n  NO_DEFAULT_BUCKET: 'no-default-bucket',\n  CANNOT_SLICE_BLOB: 'cannot-slice-blob',\n  SERVER_FILE_WRONG_SIZE: 'server-file-wrong-size',\n  NO_DOWNLOAD_URL: 'no-download-url',\n  INVALID_ARGUMENT: 'invalid-argument',\n  INVALID_ARGUMENT_COUNT: 'invalid-argument-count',\n  APP_DELETED: 'app-deleted',\n  INVALID_ROOT_OPERATION: 'invalid-root-operation',\n  INVALID_FORMAT: 'invalid-format',\n  INTERNAL_ERROR: 'internal-error',\n  UNSUPPORTED_ENVIRONMENT: 'unsupported-environment'\n};\n\nexport function prependCode(code: Code): string {\n  return 'storage/' + code;\n}\n\nexport function unknown(): FirebaseStorageError {\n  const message =\n    'An unknown error occurred, please check the error payload for ' +\n    'server response.';\n  return new FirebaseStorageError(Code.UNKNOWN, message);\n}\n\nexport function objectNotFound(path: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.OBJECT_NOT_FOUND,\n    \"Object '\" + path + \"' does not exist.\"\n  );\n}\n\nexport function bucketNotFound(bucket: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.BUCKET_NOT_FOUND,\n    \"Bucket '\" + bucket + \"' does not exist.\"\n  );\n}\n\nexport function projectNotFound(project: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.PROJECT_NOT_FOUND,\n    \"Project '\" + project + \"' does not exist.\"\n  );\n}\n\nexport function quotaExceeded(bucket: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.QUOTA_EXCEEDED,\n    \"Quota for bucket '\" +\n      bucket +\n      \"' exceeded, please view quota on \" +\n      'https://firebase.google.com/pricing/.'\n  );\n}\n\nexport function unauthenticated(): FirebaseStorageError {\n  const message =\n    'User is not authenticated, please authenticate using Firebase ' +\n    'Authentication and try again.';\n  return new FirebaseStorageError(Code.UNAUTHENTICATED, message);\n}\n\nexport function unauthorized(path: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.UNAUTHORIZED,\n    \"User does not have permission to access '\" + path + \"'.\"\n  );\n}\n\nexport function retryLimitExceeded(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.RETRY_LIMIT_EXCEEDED,\n    'Max retry time for operation exceeded, please try again.'\n  );\n}\n\nexport function invalidChecksum(\n  path: string,\n  checksum: string,\n  calculated: string\n): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_CHECKSUM,\n    \"Uploaded/downloaded object '\" +\n      path +\n      \"' has checksum '\" +\n      checksum +\n      \"' which does not match '\" +\n      calculated +\n      \"'. Please retry the upload/download.\"\n  );\n}\n\nexport function canceled(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.CANCELED,\n    'User canceled the upload/download.'\n  );\n}\n\nexport function invalidEventName(name: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_EVENT_NAME,\n    \"Invalid event name '\" + name + \"'.\"\n  );\n}\n\nexport function invalidUrl(url: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_URL,\n    \"Invalid URL '\" + url + \"'.\"\n  );\n}\n\nexport function invalidDefaultBucket(bucket: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_DEFAULT_BUCKET,\n    \"Invalid default bucket '\" + bucket + \"'.\"\n  );\n}\n\nexport function noDefaultBucket(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.NO_DEFAULT_BUCKET,\n    'No default bucket ' +\n      \"found. Did you set the '\" +\n      CONFIG_STORAGE_BUCKET_KEY +\n      \"' property when initializing the app?\"\n  );\n}\n\nexport function cannotSliceBlob(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.CANNOT_SLICE_BLOB,\n    'Cannot slice blob for upload. Please retry the upload.'\n  );\n}\n\nexport function serverFileWrongSize(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.SERVER_FILE_WRONG_SIZE,\n    'Server recorded incorrect upload file size, please retry the upload.'\n  );\n}\n\nexport function noDownloadURL(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.NO_DOWNLOAD_URL,\n    'The given file does not have any download URLs.'\n  );\n}\n\nexport function invalidArgument(message: string): FirebaseStorageError {\n  return new FirebaseStorageError(Code.INVALID_ARGUMENT, message);\n}\n\nexport function invalidArgumentCount(\n  argMin: number,\n  argMax: number,\n  fnName: string,\n  real: number\n): FirebaseStorageError {\n  let countPart;\n  let plural;\n  if (argMin === argMax) {\n    countPart = argMin;\n    plural = argMin === 1 ? 'argument' : 'arguments';\n  } else {\n    countPart = 'between ' + argMin + ' and ' + argMax;\n    plural = 'arguments';\n  }\n  return new FirebaseStorageError(\n    Code.INVALID_ARGUMENT_COUNT,\n    'Invalid argument count in `' +\n      fnName +\n      '`: Expected ' +\n      countPart +\n      ' ' +\n      plural +\n      ', received ' +\n      real +\n      '.'\n  );\n}\n\nexport function appDeleted(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.APP_DELETED,\n    'The Firebase app was deleted.'\n  );\n}\n\n/**\n * @param name - The name of the operation that was invalid.\n */\nexport function invalidRootOperation(name: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_ROOT_OPERATION,\n    \"The operation '\" +\n      name +\n      \"' cannot be performed on a root reference, create a non-root \" +\n      \"reference using child, such as .child('file.png').\"\n  );\n}\n\n/**\n * @param format - The format that was not valid.\n * @param message - A message describing the format violation.\n */\nexport function invalidFormat(\n  format: string,\n  message: string\n): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_FORMAT,\n    \"String does not match format '\" + format + \"': \" + message\n  );\n}\n\n/**\n * @param message - A message describing the internal error.\n */\nexport function internalError(message: string): FirebaseStorageError {\n  throw new FirebaseStorageError(\n    Code.INTERNAL_ERROR,\n    'Internal error: ' + message\n  );\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { unknown, invalidFormat } from './error';\n\n/**\n * An enumeration of the possible string formats for upload.\n */\nexport type StringFormat = string;\nexport const StringFormat = {\n  RAW: 'raw',\n  BASE64: 'base64',\n  BASE64URL: 'base64url',\n  DATA_URL: 'data_url'\n};\n\nexport class StringData {\n  contentType: string | null;\n\n  constructor(public data: Uint8Array, contentType?: string | null) {\n    this.contentType = contentType || null;\n  }\n}\n\nexport function dataFromString(\n  format: StringFormat,\n  stringData: string\n): StringData {\n  switch (format) {\n    case StringFormat.RAW:\n      return new StringData(utf8Bytes_(stringData));\n    case StringFormat.BASE64:\n    case StringFormat.BASE64URL:\n      return new StringData(base64Bytes_(format, stringData));\n    case StringFormat.DATA_URL:\n      return new StringData(\n        dataURLBytes_(stringData),\n        dataURLContentType_(stringData)\n      );\n    default:\n    // do nothing\n  }\n\n  // assert(false);\n  throw unknown();\n}\n\nexport function utf8Bytes_(value: string): Uint8Array {\n  const b: number[] = [];\n  for (let i = 0; i < value.length; i++) {\n    let c = value.charCodeAt(i);\n    if (c <= 127) {\n      b.push(c);\n    } else {\n      if (c <= 2047) {\n        b.push(192 | (c >> 6), 128 | (c & 63));\n      } else {\n        if ((c & 64512) === 55296) {\n          // The start of a surrogate pair.\n          const valid =\n            i < value.length - 1 && (value.charCodeAt(i + 1) & 64512) === 56320;\n          if (!valid) {\n            // The second surrogate wasn't there.\n            b.push(239, 191, 189);\n          } else {\n            const hi = c;\n            const lo = value.charCodeAt(++i);\n            c = 65536 | ((hi & 1023) << 10) | (lo & 1023);\n            b.push(\n              240 | (c >> 18),\n              128 | ((c >> 12) & 63),\n              128 | ((c >> 6) & 63),\n              128 | (c & 63)\n            );\n          }\n        } else {\n          if ((c & 64512) === 56320) {\n            // Invalid low surrogate.\n            b.push(239, 191, 189);\n          } else {\n            b.push(224 | (c >> 12), 128 | ((c >> 6) & 63), 128 | (c & 63));\n          }\n        }\n      }\n    }\n  }\n  return new Uint8Array(b);\n}\n\nexport function percentEncodedBytes_(value: string): Uint8Array {\n  let decoded;\n  try {\n    decoded = decodeURIComponent(value);\n  } catch (e) {\n    throw invalidFormat(StringFormat.DATA_URL, 'Malformed data URL.');\n  }\n  return utf8Bytes_(decoded);\n}\n\nexport function base64Bytes_(format: StringFormat, value: string): Uint8Array {\n  switch (format) {\n    case StringFormat.BASE64: {\n      const hasMinus = value.indexOf('-') !== -1;\n      const hasUnder = value.indexOf('_') !== -1;\n      if (hasMinus || hasUnder) {\n        const invalidChar = hasMinus ? '-' : '_';\n        throw invalidFormat(\n          format,\n          \"Invalid character '\" +\n            invalidChar +\n            \"' found: is it base64url encoded?\"\n        );\n      }\n      break;\n    }\n    case StringFormat.BASE64URL: {\n      const hasPlus = value.indexOf('+') !== -1;\n      const hasSlash = value.indexOf('/') !== -1;\n      if (hasPlus || hasSlash) {\n        const invalidChar = hasPlus ? '+' : '/';\n        throw invalidFormat(\n          format,\n          \"Invalid character '\" + invalidChar + \"' found: is it base64 encoded?\"\n        );\n      }\n      value = value.replace(/-/g, '+').replace(/_/g, '/');\n      break;\n    }\n    default:\n    // do nothing\n  }\n  let bytes;\n  try {\n    bytes = atob(value);\n  } catch (e) {\n    throw invalidFormat(format, 'Invalid character found');\n  }\n  const array = new Uint8Array(bytes.length);\n  for (let i = 0; i < bytes.length; i++) {\n    array[i] = bytes.charCodeAt(i);\n  }\n  return array;\n}\n\nclass DataURLParts {\n  base64: boolean = false;\n  contentType: string | null = null;\n  rest: string;\n\n  constructor(dataURL: string) {\n    const matches = dataURL.match(/^data:([^,]+)?,/);\n    if (matches === null) {\n      throw invalidFormat(\n        StringFormat.DATA_URL,\n        \"Must be formatted 'data:[<mediatype>][;base64],<data>\"\n      );\n    }\n    const middle = matches[1] || null;\n    if (middle != null) {\n      this.base64 = endsWith(middle, ';base64');\n      this.contentType = this.base64\n        ? middle.substring(0, middle.length - ';base64'.length)\n        : middle;\n    }\n    this.rest = dataURL.substring(dataURL.indexOf(',') + 1);\n  }\n}\n\nexport function dataURLBytes_(dataUrl: string): Uint8Array {\n  const parts = new DataURLParts(dataUrl);\n  if (parts.base64) {\n    return base64Bytes_(StringFormat.BASE64, parts.rest);\n  } else {\n    return percentEncodedBytes_(parts.rest);\n  }\n}\n\nexport function dataURLContentType_(dataUrl: string): string | null {\n  const parts = new DataURLParts(dataUrl);\n  return parts.contentType;\n}\n\nfunction endsWith(s: string, end: string): boolean {\n  const longEnough = s.length >= end.length;\n  if (!longEnough) {\n    return false;\n  }\n\n  return s.substring(s.length - end.length) === end;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Enumerations used for upload tasks.\n */\n\n/**\n * Enum for task events.\n */\nexport type TaskEvent = string;\nexport const TaskEvent = {\n  /** Triggered whenever the task changes or progress is updated. */\n  STATE_CHANGED: 'state_changed'\n};\n\n/**\n * Internal enum for task state.\n */\nexport type InternalTaskState = string;\nexport const InternalTaskState = {\n  RUNNING: 'running',\n  PAUSING: 'pausing',\n  PAUSED: 'paused',\n  SUCCESS: 'success',\n  CANCELING: 'canceling',\n  CANCELED: 'canceled',\n  ERROR: 'error'\n};\n\n/**\n * External (API-surfaced) enum for task state.\n */\nexport type TaskState = string;\nexport const TaskState = {\n  /** The task is currently transferring data. */\n  RUNNING: 'running',\n  /** The task was paused by the user. */\n  PAUSED: 'paused',\n  /** The task completed successfully. */\n  SUCCESS: 'success',\n  /** The task was canceled. */\n  CANCELED: 'canceled',\n  /** The task failed with an error. */\n  ERROR: 'error'\n};\n\nexport function taskStateFromInternalTaskState(\n  state: InternalTaskState\n): TaskState {\n  switch (state) {\n    case InternalTaskState.RUNNING:\n    case InternalTaskState.PAUSING:\n    case InternalTaskState.CANCELING:\n      return TaskState.RUNNING;\n    case InternalTaskState.PAUSED:\n      return TaskState.PAUSED;\n    case InternalTaskState.SUCCESS:\n      return TaskState.SUCCESS;\n    case InternalTaskState.CANCELED:\n      return TaskState.CANCELED;\n    case InternalTaskState.ERROR:\n      return TaskState.ERROR;\n    default:\n      // TODO(andysoto): assert(false);\n      return TaskState.ERROR;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview A lightweight wrapper around XMLHttpRequest with a\n * goog.net.XhrIo-like interface.\n */\n\n/**\n * XHR headers\n */\nexport interface Headers {\n  [name: string]: string | number;\n}\n\nexport interface XhrIo {\n  send(\n    url: string,\n    method: string,\n    body?: ArrayBufferView | Blob | string | null,\n    headers?: Headers\n  ): Promise<XhrIo>;\n\n  getErrorCode(): ErrorCode;\n\n  getStatus(): number;\n\n  getResponseText(): string;\n\n  /**\n   * Abort the request.\n   */\n  abort(): void;\n\n  getResponseHeader(header: string): string | null;\n\n  addUploadProgressListener(listener: (p1: ProgressEvent) => void): void;\n\n  removeUploadProgressListener(listener: (p1: ProgressEvent) => void): void;\n}\n\nexport enum ErrorCode {\n  NO_ERROR = 0,\n  NETWORK_ERROR = 1,\n  ABORT = 2\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Headers, XhrIo, ErrorCode } from './xhrio';\nimport { internalError } from './error';\n\n/**\n * We use this instead of goog.net.XhrIo because goog.net.XhrIo is hyuuuuge and\n * doesn't work in React Native on Android.\n */\nexport class NetworkXhrIo implements XhrIo {\n  private xhr_: XMLHttpRequest;\n  private errorCode_: ErrorCode;\n  private sendPromise_: Promise<XhrIo>;\n  private sent_: boolean = false;\n\n  constructor() {\n    this.xhr_ = new XMLHttpRequest();\n    this.errorCode_ = ErrorCode.NO_ERROR;\n    this.sendPromise_ = new Promise(resolve => {\n      this.xhr_.addEventListener('abort', () => {\n        this.errorCode_ = ErrorCode.ABORT;\n        resolve(this);\n      });\n      this.xhr_.addEventListener('error', () => {\n        this.errorCode_ = ErrorCode.NETWORK_ERROR;\n        resolve(this);\n      });\n      this.xhr_.addEventListener('load', () => {\n        resolve(this);\n      });\n    });\n  }\n\n  /**\n   * @override\n   */\n  send(\n    url: string,\n    method: string,\n    body?: ArrayBufferView | Blob | string,\n    headers?: Headers\n  ): Promise<XhrIo> {\n    if (this.sent_) {\n      throw internalError('cannot .send() more than once');\n    }\n    this.sent_ = true;\n    this.xhr_.open(method, url, true);\n    if (headers !== undefined) {\n      for (const key in headers) {\n        if (headers.hasOwnProperty(key)) {\n          this.xhr_.setRequestHeader(key, headers[key].toString());\n        }\n      }\n    }\n    if (body !== undefined) {\n      this.xhr_.send(body);\n    } else {\n      this.xhr_.send();\n    }\n    return this.sendPromise_;\n  }\n\n  /**\n   * @override\n   */\n  getErrorCode(): ErrorCode {\n    if (!this.sent_) {\n      throw internalError('cannot .getErrorCode() before sending');\n    }\n    return this.errorCode_;\n  }\n\n  /**\n   * @override\n   */\n  getStatus(): number {\n    if (!this.sent_) {\n      throw internalError('cannot .getStatus() before sending');\n    }\n    try {\n      return this.xhr_.status;\n    } catch (e) {\n      return -1;\n    }\n  }\n\n  /**\n   * @override\n   */\n  getResponseText(): string {\n    if (!this.sent_) {\n      throw internalError('cannot .getResponseText() before sending');\n    }\n    return this.xhr_.responseText;\n  }\n\n  /**\n   * Aborts the request.\n   * @override\n   */\n  abort(): void {\n    this.xhr_.abort();\n  }\n\n  /**\n   * @override\n   */\n  getResponseHeader(header: string): string | null {\n    return this.xhr_.getResponseHeader(header);\n  }\n\n  /**\n   * @override\n   */\n  addUploadProgressListener(listener: (p1: ProgressEvent) => void): void {\n    if (this.xhr_.upload != null) {\n      this.xhr_.upload.addEventListener('progress', listener);\n    }\n  }\n\n  /**\n   * @override\n   */\n  removeUploadProgressListener(listener: (p1: ProgressEvent) => void): void {\n    if (this.xhr_.upload != null) {\n      this.xhr_.upload.removeEventListener('progress', listener);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Replacement for goog.net.XhrIoPool that works with fbs.XhrIo.\n */\nimport { XhrIo } from './xhrio';\nimport { NetworkXhrIo } from './xhrio_network';\n\n/**\n * Factory-like class for creating XhrIo instances.\n */\nexport class XhrIoPool {\n  createXhrIo(): XhrIo {\n    return new NetworkXhrIo();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Code, FirebaseStorageError } from './error';\n\nexport function isJustDef<T>(p: T | null | undefined): p is T | null {\n  return p !== void 0;\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isFunction(p: unknown): p is Function {\n  return typeof p === 'function';\n}\n\nexport function isNonArrayObject(p: unknown): boolean {\n  return typeof p === 'object' && !Array.isArray(p);\n}\n\nexport function isString(p: unknown): p is string {\n  return typeof p === 'string' || p instanceof String;\n}\n\nexport function isNativeBlob(p: unknown): p is Blob {\n  return isNativeBlobDefined() && p instanceof Blob;\n}\n\nexport function isNativeBlobDefined(): boolean {\n  return typeof Blob !== 'undefined';\n}\n\nexport function validateNumber(\n  argument: string,\n  minValue: number,\n  maxValue: number,\n  value: number\n): void {\n  if (value < minValue) {\n    throw new FirebaseStorageError(\n      Code.INVALID_ARGUMENT,\n      `Invalid value for '${argument}'. Expected ${minValue} or greater.`\n    );\n  }\n  if (value > maxValue) {\n    throw new FirebaseStorageError(\n      Code.INVALID_ARGUMENT,\n      `Invalid value for '${argument}'. Expected ${maxValue} or less.`\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Some methods copied from goog.fs.\n * We don't include goog.fs because it pulls in a bunch of Deferred code that\n * bloats the size of the released binary.\n */\nimport * as type from './type';\nimport { Code, FirebaseStorageError } from './error';\n\nfunction getBlobBuilder(): typeof IBlobBuilder | undefined {\n  if (typeof BlobBuilder !== 'undefined') {\n    return BlobBuilder;\n  } else if (typeof WebKitBlobBuilder !== 'undefined') {\n    return WebKitBlobBuilder;\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Concatenates one or more values together and converts them to a Blob.\n *\n * @param args The values that will make up the resulting blob.\n * @return The blob.\n */\nexport function getBlob(...args: Array<string | Blob | ArrayBuffer>): Blob {\n  const BlobBuilder = getBlobBuilder();\n  if (BlobBuilder !== undefined) {\n    const bb = new BlobBuilder();\n    for (let i = 0; i < args.length; i++) {\n      bb.append(args[i]);\n    }\n    return bb.getBlob();\n  } else {\n    if (type.isNativeBlobDefined()) {\n      return new Blob(args);\n    } else {\n      throw new FirebaseStorageError(\n        Code.UNSUPPORTED_ENVIRONMENT,\n        \"This browser doesn't seem to support creating Blobs\"\n      );\n    }\n  }\n}\n\n/**\n * Slices the blob. The returned blob contains data from the start byte\n * (inclusive) till the end byte (exclusive). Negative indices cannot be used.\n *\n * @param blob The blob to be sliced.\n * @param start Index of the starting byte.\n * @param end Index of the ending byte.\n * @return The blob slice or null if not supported.\n */\nexport function sliceBlob(blob: Blob, start: number, end: number): Blob | null {\n  if (blob.webkitSlice) {\n    return blob.webkitSlice(start, end);\n  } else if (blob.mozSlice) {\n    return blob.mozSlice(start, end);\n  } else if (blob.slice) {\n    return blob.slice(start, end);\n  }\n  return null;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Provides a Blob-like wrapper for various binary types (including the\n * native Blob type). This makes it possible to upload types like ArrayBuffers,\n * making uploads possible in environments without the native Blob type.\n */\nimport * as fs from './fs';\nimport { StringFormat, dataFromString } from './string';\nimport * as type from './type';\n\n/**\n * @param opt_elideCopy - If true, doesn't copy mutable input data\n *     (e.g. Uint8Arrays). Pass true only if you know the objects will not be\n *     modified after this blob's construction.\n */\nexport class FbsBlob {\n  private data_!: Blob | Uint8Array;\n  private size_: number;\n  private type_: string;\n\n  constructor(data: Blob | Uint8Array | ArrayBuffer, elideCopy?: boolean) {\n    let size: number = 0;\n    let blobType: string = '';\n    if (type.isNativeBlob(data)) {\n      this.data_ = data as Blob;\n      size = (data as Blob).size;\n      blobType = (data as Blob).type;\n    } else if (data instanceof ArrayBuffer) {\n      if (elideCopy) {\n        this.data_ = new Uint8Array(data);\n      } else {\n        this.data_ = new Uint8Array(data.byteLength);\n        this.data_.set(new Uint8Array(data));\n      }\n      size = this.data_.length;\n    } else if (data instanceof Uint8Array) {\n      if (elideCopy) {\n        this.data_ = data as Uint8Array;\n      } else {\n        this.data_ = new Uint8Array(data.length);\n        this.data_.set(data as Uint8Array);\n      }\n      size = data.length;\n    }\n    this.size_ = size;\n    this.type_ = blobType;\n  }\n\n  size(): number {\n    return this.size_;\n  }\n\n  type(): string {\n    return this.type_;\n  }\n\n  slice(startByte: number, endByte: number): FbsBlob | null {\n    if (type.isNativeBlob(this.data_)) {\n      const realBlob = this.data_ as Blob;\n      const sliced = fs.sliceBlob(realBlob, startByte, endByte);\n      if (sliced === null) {\n        return null;\n      }\n      return new FbsBlob(sliced);\n    } else {\n      const slice = new Uint8Array(\n        (this.data_ as Uint8Array).buffer,\n        startByte,\n        endByte - startByte\n      );\n      return new FbsBlob(slice, true);\n    }\n  }\n\n  static getBlob(...args: Array<string | FbsBlob>): FbsBlob | null {\n    if (type.isNativeBlobDefined()) {\n      const blobby: Array<Blob | Uint8Array | string> = args.map(\n        (val: string | FbsBlob): Blob | Uint8Array | string => {\n          if (val instanceof FbsBlob) {\n            return val.data_;\n          } else {\n            return val;\n          }\n        }\n      );\n      return new FbsBlob(fs.getBlob.apply(null, blobby));\n    } else {\n      const uint8Arrays: Uint8Array[] = args.map(\n        (val: string | FbsBlob): Uint8Array => {\n          if (type.isString(val)) {\n            return dataFromString(StringFormat.RAW, val as string).data;\n          } else {\n            // Blobs don't exist, so this has to be a Uint8Array.\n            return (val as FbsBlob).data_ as Uint8Array;\n          }\n        }\n      );\n      let finalLength = 0;\n      uint8Arrays.forEach((array: Uint8Array): void => {\n        finalLength += array.byteLength;\n      });\n      const merged = new Uint8Array(finalLength);\n      let index = 0;\n      uint8Arrays.forEach((array: Uint8Array) => {\n        for (let i = 0; i < array.length; i++) {\n          merged[index++] = array[i];\n        }\n      });\n      return new FbsBlob(merged, true);\n    }\n  }\n\n  uploadData(): Blob | Uint8Array {\n    return this.data_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Functionality related to the parsing/composition of bucket/\n * object location.\n */\n\nimport { invalidDefaultBucket, invalidUrl } from './error';\nimport { DEFAULT_HOST } from './constants';\n\nexport class Location {\n  private path_: string;\n\n  constructor(public readonly bucket: string, path: string) {\n    this.path_ = path;\n  }\n\n  get path(): string {\n    return this.path_;\n  }\n\n  get isRoot(): boolean {\n    return this.path.length === 0;\n  }\n\n  fullServerUrl(): string {\n    const encode = encodeURIComponent;\n    return '/b/' + encode(this.bucket) + '/o/' + encode(this.path);\n  }\n\n  bucketOnlyServerUrl(): string {\n    const encode = encodeURIComponent;\n    return '/b/' + encode(this.bucket) + '/o';\n  }\n\n  static makeFromBucketSpec(bucketString: string): Location {\n    let bucketLocation;\n    try {\n      bucketLocation = Location.makeFromUrl(bucketString);\n    } catch (e) {\n      // Not valid URL, use as-is. This lets you put bare bucket names in\n      // config.\n      return new Location(bucketString, '');\n    }\n    if (bucketLocation.path === '') {\n      return bucketLocation;\n    } else {\n      throw invalidDefaultBucket(bucketString);\n    }\n  }\n\n  static makeFromUrl(url: string): Location {\n    let location: Location | null = null;\n    const bucketDomain = '([A-Za-z0-9.\\\\-_]+)';\n\n    function gsModify(loc: Location): void {\n      if (loc.path.charAt(loc.path.length - 1) === '/') {\n        loc.path_ = loc.path_.slice(0, -1);\n      }\n    }\n    const gsPath = '(/(.*))?$';\n    const gsRegex = new RegExp('^gs://' + bucketDomain + gsPath, 'i');\n    const gsIndices = { bucket: 1, path: 3 };\n\n    function httpModify(loc: Location): void {\n      loc.path_ = decodeURIComponent(loc.path);\n    }\n    const version = 'v[A-Za-z0-9_]+';\n    const firebaseStorageHost = DEFAULT_HOST.replace(/[.]/g, '\\\\.');\n    const firebaseStoragePath = '(/([^?#]*).*)?$';\n    const firebaseStorageRegExp = new RegExp(\n      `^https?://${firebaseStorageHost}/${version}/b/${bucketDomain}/o${firebaseStoragePath}`,\n      'i'\n    );\n    const firebaseStorageIndices = { bucket: 1, path: 3 };\n\n    const cloudStorageHost =\n      '(?:storage.googleapis.com|storage.cloud.google.com)';\n    const cloudStoragePath = '([^?#]*)';\n    const cloudStorageRegExp = new RegExp(\n      `^https?://${cloudStorageHost}/${bucketDomain}/${cloudStoragePath}`,\n      'i'\n    );\n    const cloudStorageIndices = { bucket: 1, path: 2 };\n\n    const groups = [\n      { regex: gsRegex, indices: gsIndices, postModify: gsModify },\n      {\n        regex: firebaseStorageRegExp,\n        indices: firebaseStorageIndices,\n        postModify: httpModify\n      },\n      {\n        regex: cloudStorageRegExp,\n        indices: cloudStorageIndices,\n        postModify: httpModify\n      }\n    ];\n    for (let i = 0; i < groups.length; i++) {\n      const group = groups[i];\n      const captures = group.regex.exec(url);\n      if (captures) {\n        const bucketValue = captures[group.indices.bucket];\n        let pathValue = captures[group.indices.path];\n        if (!pathValue) {\n          pathValue = '';\n        }\n        location = new Location(bucketValue, pathValue);\n        group.postModify(location);\n        break;\n      }\n    }\n    if (location == null) {\n      throw invalidUrl(url);\n    }\n    return location;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Constants used in the Firebase Storage library.\n */\n\n/**\n * Domain name for firebase storage.\n */\nexport const DEFAULT_HOST = 'firebasestorage.googleapis.com';\n\n/**\n * The key in Firebase config json for the storage bucket.\n */\nexport const CONFIG_STORAGE_BUCKET_KEY = 'storageBucket';\n\n/**\n * 2 minutes\n *\n * The timeout for all operations except upload.\n */\nexport const DEFAULT_MAX_OPERATION_RETRY_TIME = 2 * 60 * 1000;\n\n/**\n * 10 minutes\n *\n * The timeout for upload.\n */\nexport const DEFAULT_MAX_UPLOAD_RETRY_TIME = 10 * 60 * 1000;\n\n/**\n * This is the value of Number.MIN_SAFE_INTEGER, which is not well supported\n * enough for us to use it directly.\n */\nexport const MIN_SAFE_INTEGER = -9007199254740991;\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as type from './type';\n\n/**\n * Returns the Object resulting from parsing the given JSON, or null if the\n * given string does not represent a JSON object.\n */\nexport function jsonObjectOrNull(\n  s: string\n): { [name: string]: unknown } | null {\n  let obj;\n  try {\n    obj = JSON.parse(s);\n  } catch (e) {\n    return null;\n  }\n  if (type.isNonArrayObject(obj)) {\n    return obj;\n  } else {\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Contains helper methods for manipulating paths.\n */\n\n/**\n * @return Null if the path is already at the root.\n */\nexport function parent(path: string): string | null {\n  if (path.length === 0) {\n    return null;\n  }\n  const index = path.lastIndexOf('/');\n  if (index === -1) {\n    return '';\n  }\n  const newPath = path.slice(0, index);\n  return newPath;\n}\n\nexport function child(path: string, childPath: string): string {\n  const canonicalChildPath = childPath\n    .split('/')\n    .filter(component => component.length > 0)\n    .join('/');\n  if (path.length === 0) {\n    return canonicalChildPath;\n  } else {\n    return path + '/' + canonicalChildPath;\n  }\n}\n\n/**\n * Returns the last component of a path.\n * '/foo/bar' -> 'bar'\n * '/foo/bar/baz/' -> 'baz/'\n * '/a' -> 'a'\n */\nexport function lastComponent(path: string): string {\n  const index = path.lastIndexOf('/', path.length - 2);\n  if (index === -1) {\n    return path;\n  } else {\n    return path.slice(index + 1);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Functions to create and manipulate URLs for the server API.\n */\nimport { DEFAULT_HOST } from './constants';\nimport { UrlParams } from './requestinfo';\n\nexport function makeUrl(urlPart: string): string {\n  return `https://${DEFAULT_HOST}/v0${urlPart}`;\n}\n\nexport function makeQueryString(params: UrlParams): string {\n  const encode = encodeURIComponent;\n  let queryPart = '?';\n  for (const key in params) {\n    if (params.hasOwnProperty(key)) {\n      const nextPart = encode(key) + '=' + encode(params[key]);\n      queryPart = queryPart + nextPart + '&';\n    }\n  }\n\n  // Chop off the extra '&' or '?' on the end\n  queryPart = queryPart.slice(0, -1);\n  return queryPart;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Documentation for the metadata format\n */\nimport { Metadata } from '../metadata';\n\nimport * as json from './json';\nimport { Location } from './location';\nimport * as path from './path';\nimport * as type from './type';\nimport * as UrlUtils from './url';\nimport { Reference } from '../reference';\nimport { StorageService } from '../service';\n\nexport function noXform_<T>(metadata: Metadata, value: T): T {\n  return value;\n}\n\nclass Mapping<T> {\n  local: string;\n  writable: boolean;\n  xform: (p1: Metadata, p2?: T) => T | undefined;\n\n  constructor(\n    public server: string,\n    local?: string | null,\n    writable?: boolean,\n    xform?: ((p1: Metadata, p2?: T) => T | undefined) | null\n  ) {\n    this.local = local || server;\n    this.writable = !!writable;\n    this.xform = xform || noXform_;\n  }\n}\ntype Mappings = Array<Mapping<string> | Mapping<number>>;\n\nexport { Mappings };\n\nlet mappings_: Mappings | null = null;\n\nexport function xformPath(fullPath: string | undefined): string | undefined {\n  if (!type.isString(fullPath) || fullPath.length < 2) {\n    return fullPath;\n  } else {\n    return path.lastComponent(fullPath);\n  }\n}\n\nexport function getMappings(): Mappings {\n  if (mappings_) {\n    return mappings_;\n  }\n  const mappings: Mappings = [];\n  mappings.push(new Mapping<string>('bucket'));\n  mappings.push(new Mapping<string>('generation'));\n  mappings.push(new Mapping<string>('metageneration'));\n  mappings.push(new Mapping<string>('name', 'fullPath', true));\n\n  function mappingsXformPath(\n    _metadata: Metadata,\n    fullPath: string | undefined\n  ): string | undefined {\n    return xformPath(fullPath);\n  }\n  const nameMapping = new Mapping<string>('name');\n  nameMapping.xform = mappingsXformPath;\n  mappings.push(nameMapping);\n\n  /**\n   * Coerces the second param to a number, if it is defined.\n   */\n  function xformSize(\n    _metadata: Metadata,\n    size?: number | string\n  ): number | undefined {\n    if (size !== undefined) {\n      return Number(size);\n    } else {\n      return size;\n    }\n  }\n  const sizeMapping = new Mapping<number>('size');\n  sizeMapping.xform = xformSize;\n  mappings.push(sizeMapping);\n  mappings.push(new Mapping<number>('timeCreated'));\n  mappings.push(new Mapping<string>('updated'));\n  mappings.push(new Mapping<string>('md5Hash', null, true));\n  mappings.push(new Mapping<string>('cacheControl', null, true));\n  mappings.push(new Mapping<string>('contentDisposition', null, true));\n  mappings.push(new Mapping<string>('contentEncoding', null, true));\n  mappings.push(new Mapping<string>('contentLanguage', null, true));\n  mappings.push(new Mapping<string>('contentType', null, true));\n  mappings.push(new Mapping<string>('metadata', 'customMetadata', true));\n  mappings_ = mappings;\n  return mappings_;\n}\n\nexport function addRef(metadata: Metadata, service: StorageService): void {\n  function generateRef(): Reference {\n    const bucket: string = metadata['bucket'] as string;\n    const path: string = metadata['fullPath'] as string;\n    const loc = new Location(bucket, path);\n    return service.makeStorageReference(loc);\n  }\n  Object.defineProperty(metadata, 'ref', { get: generateRef });\n}\n\nexport function fromResource(\n  service: StorageService,\n  resource: { [name: string]: unknown },\n  mappings: Mappings\n): Metadata {\n  const metadata: Metadata = {} as Metadata;\n  metadata['type'] = 'file';\n  const len = mappings.length;\n  for (let i = 0; i < len; i++) {\n    const mapping = mappings[i];\n    metadata[mapping.local] = (mapping as Mapping<unknown>).xform(\n      metadata,\n      resource[mapping.server]\n    );\n  }\n  addRef(metadata, service);\n  return metadata;\n}\n\nexport function fromResourceString(\n  service: StorageService,\n  resourceString: string,\n  mappings: Mappings\n): Metadata | null {\n  const obj = json.jsonObjectOrNull(resourceString);\n  if (obj === null) {\n    return null;\n  }\n  const resource = obj as Metadata;\n  return fromResource(service, resource, mappings);\n}\n\nexport function downloadUrlFromResourceString(\n  metadata: Metadata,\n  resourceString: string\n): string | null {\n  const obj = json.jsonObjectOrNull(resourceString);\n  if (obj === null) {\n    return null;\n  }\n  if (!type.isString(obj['downloadTokens'])) {\n    // This can happen if objects are uploaded through GCS and retrieved\n    // through list, so we don't want to throw an Error.\n    return null;\n  }\n  const tokens: string = obj['downloadTokens'] as string;\n  if (tokens.length === 0) {\n    return null;\n  }\n  const encode = encodeURIComponent;\n  const tokensList = tokens.split(',');\n  const urls = tokensList.map((token: string): string => {\n    const bucket: string = metadata['bucket'] as string;\n    const path: string = metadata['fullPath'] as string;\n    const urlPart = '/b/' + encode(bucket) + '/o/' + encode(path);\n    const base = UrlUtils.makeUrl(urlPart);\n    const queryString = UrlUtils.makeQueryString({\n      alt: 'media',\n      token\n    });\n    return base + queryString;\n  });\n  return urls[0];\n}\n\nexport function toResourceString(\n  metadata: Metadata,\n  mappings: Mappings\n): string {\n  const resource: {\n    [prop: string]: unknown;\n  } = {};\n  const len = mappings.length;\n  for (let i = 0; i < len; i++) {\n    const mapping = mappings[i];\n    if (mapping.writable) {\n      resource[mapping.server] = metadata[mapping.local];\n    }\n  }\n  return JSON.stringify(resource);\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Documentation for the listOptions and listResult format\n */\nimport { Location } from './location';\nimport * as json from './json';\nimport { ListResult } from '../list';\nimport { StorageService } from '../service';\n\n/**\n * Represents the simplified object metadata returned by List API.\n * Other fields are filtered because list in Firebase Rules does not grant\n * the permission to read the metadata.\n */\ninterface ListMetadataResponse {\n  name: string;\n  bucket: string;\n}\n\n/**\n * Represents the JSON response of List API.\n */\ninterface ListResultResponse {\n  prefixes: string[];\n  items: ListMetadataResponse[];\n  nextPageToken?: string;\n}\n\nconst PREFIXES_KEY = 'prefixes';\nconst ITEMS_KEY = 'items';\n\nfunction fromBackendResponse(\n  service: StorageService,\n  bucket: string,\n  resource: ListResultResponse\n): ListResult {\n  const listResult: ListResult = {\n    prefixes: [],\n    items: [],\n    nextPageToken: resource['nextPageToken']\n  };\n  if (resource[PREFIXES_KEY]) {\n    for (const path of resource[PREFIXES_KEY]) {\n      const pathWithoutTrailingSlash = path.replace(/\\/$/, '');\n      const reference = service.makeStorageReference(\n        new Location(bucket, pathWithoutTrailingSlash)\n      );\n      listResult.prefixes.push(reference);\n    }\n  }\n\n  if (resource[ITEMS_KEY]) {\n    for (const item of resource[ITEMS_KEY]) {\n      const reference = service.makeStorageReference(\n        new Location(bucket, item['name'])\n      );\n      listResult.items.push(reference);\n    }\n  }\n  return listResult;\n}\n\nexport function fromResponseString(\n  service: StorageService,\n  bucket: string,\n  resourceString: string\n): ListResult | null {\n  const obj = json.jsonObjectOrNull(resourceString);\n  if (obj === null) {\n    return null;\n  }\n  const resource = (obj as unknown) as ListResultResponse;\n  return fromBackendResponse(service, bucket, resource);\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { FirebaseStorageError } from './error';\nimport { Headers, XhrIo } from './xhrio';\n\nexport interface UrlParams {\n  [name: string]: string | number;\n}\n\nexport class RequestInfo<T> {\n  urlParams: UrlParams = {};\n  headers: Headers = {};\n  body: Blob | string | Uint8Array | null = null;\n\n  errorHandler:\n    | ((p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError)\n    | null = null;\n\n  /**\n   * Called with the current number of bytes uploaded and total size (-1 if not\n   * computable) of the request body (i.e. used to report upload progress).\n   */\n  progressCallback: ((p1: number, p2: number) => void) | null = null;\n  successCodes: number[] = [200];\n  additionalRetryCodes: number[] = [];\n\n  constructor(\n    public url: string,\n    public method: string,\n    /**\n     * Returns the value with which to resolve the request's promise. Only called\n     * if the request is successful. Throw from this function to reject the\n     * returned Request's promise with the thrown error.\n     * Note: The XhrIo passed to this function may be reused after this callback\n     * returns. Do not keep a reference to it in any way.\n     */\n    public handler: (p1: XhrIo, p2: string) => T,\n    public timeout: number\n  ) {}\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Defines methods for interacting with the network.\n */\n\nimport { Metadata } from '../metadata';\nimport { ListResult } from '../list';\nimport { FbsBlob } from './blob';\nimport {\n  FirebaseStorageError,\n  cannotSliceBlob,\n  unauthenticated,\n  quotaExceeded,\n  unauthorized,\n  objectNotFound,\n  serverFileWrongSize,\n  unknown\n} from './error';\nimport { Location } from './location';\nimport * as MetadataUtils from './metadata';\nimport * as ListResultUtils from './list';\nimport { RequestInfo, UrlParams } from './requestinfo';\nimport * as type from './type';\nimport * as UrlUtils from './url';\nimport { XhrIo } from './xhrio';\nimport { StorageService } from '../service';\n\n/**\n * Throws the UNKNOWN FirebaseStorageError if cndn is false.\n */\nexport function handlerCheck(cndn: boolean): void {\n  if (!cndn) {\n    throw unknown();\n  }\n}\n\nexport function metadataHandler(\n  service: StorageService,\n  mappings: MetadataUtils.Mappings\n): (p1: XhrIo, p2: string) => Metadata {\n  function handler(xhr: XhrIo, text: string): Metadata {\n    const metadata = MetadataUtils.fromResourceString(service, text, mappings);\n    handlerCheck(metadata !== null);\n    return metadata as Metadata;\n  }\n  return handler;\n}\n\nexport function listHandler(\n  service: StorageService,\n  bucket: string\n): (p1: XhrIo, p2: string) => ListResult {\n  function handler(xhr: XhrIo, text: string): ListResult {\n    const listResult = ListResultUtils.fromResponseString(\n      service,\n      bucket,\n      text\n    );\n    handlerCheck(listResult !== null);\n    return listResult as ListResult;\n  }\n  return handler;\n}\n\nexport function downloadUrlHandler(\n  service: StorageService,\n  mappings: MetadataUtils.Mappings\n): (p1: XhrIo, p2: string) => string | null {\n  function handler(xhr: XhrIo, text: string): string | null {\n    const metadata = MetadataUtils.fromResourceString(service, text, mappings);\n    handlerCheck(metadata !== null);\n    return MetadataUtils.downloadUrlFromResourceString(\n      metadata as Metadata,\n      text\n    );\n  }\n  return handler;\n}\n\nexport function sharedErrorHandler(\n  location: Location\n): (p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError {\n  function errorHandler(\n    xhr: XhrIo,\n    err: FirebaseStorageError\n  ): FirebaseStorageError {\n    let newErr;\n    if (xhr.getStatus() === 401) {\n      newErr = unauthenticated();\n    } else {\n      if (xhr.getStatus() === 402) {\n        newErr = quotaExceeded(location.bucket);\n      } else {\n        if (xhr.getStatus() === 403) {\n          newErr = unauthorized(location.path);\n        } else {\n          newErr = err;\n        }\n      }\n    }\n    newErr.serverResponse = err.serverResponse;\n    return newErr;\n  }\n  return errorHandler;\n}\n\nexport function objectErrorHandler(\n  location: Location\n): (p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError {\n  const shared = sharedErrorHandler(location);\n\n  function errorHandler(\n    xhr: XhrIo,\n    err: FirebaseStorageError\n  ): FirebaseStorageError {\n    let newErr = shared(xhr, err);\n    if (xhr.getStatus() === 404) {\n      newErr = objectNotFound(location.path);\n    }\n    newErr.serverResponse = err.serverResponse;\n    return newErr;\n  }\n  return errorHandler;\n}\n\nexport function getMetadata(\n  service: StorageService,\n  location: Location,\n  mappings: MetadataUtils.Mappings\n): RequestInfo<Metadata> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'GET';\n  const timeout = service.maxOperationRetryTime;\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    metadataHandler(service, mappings),\n    timeout\n  );\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function list(\n  service: StorageService,\n  location: Location,\n  delimiter?: string,\n  pageToken?: string | null,\n  maxResults?: number | null\n): RequestInfo<ListResult> {\n  const urlParams: UrlParams = {};\n  if (location.isRoot) {\n    urlParams['prefix'] = '';\n  } else {\n    urlParams['prefix'] = location.path + '/';\n  }\n  if (delimiter && delimiter.length > 0) {\n    urlParams['delimiter'] = delimiter;\n  }\n  if (pageToken) {\n    urlParams['pageToken'] = pageToken;\n  }\n  if (maxResults) {\n    urlParams['maxResults'] = maxResults;\n  }\n  const urlPart = location.bucketOnlyServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'GET';\n  const timeout = service.maxOperationRetryTime;\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    listHandler(service, location.bucket),\n    timeout\n  );\n  requestInfo.urlParams = urlParams;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\nexport function getDownloadUrl(\n  service: StorageService,\n  location: Location,\n  mappings: MetadataUtils.Mappings\n): RequestInfo<string | null> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'GET';\n  const timeout = service.maxOperationRetryTime;\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    downloadUrlHandler(service, mappings),\n    timeout\n  );\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function updateMetadata(\n  service: StorageService,\n  location: Location,\n  metadata: Metadata,\n  mappings: MetadataUtils.Mappings\n): RequestInfo<Metadata> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'PATCH';\n  const body = MetadataUtils.toResourceString(metadata, mappings);\n  const headers = { 'Content-Type': 'application/json; charset=utf-8' };\n  const timeout = service.maxOperationRetryTime;\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    metadataHandler(service, mappings),\n    timeout\n  );\n  requestInfo.headers = headers;\n  requestInfo.body = body;\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function deleteObject(\n  service: StorageService,\n  location: Location\n): RequestInfo<void> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'DELETE';\n  const timeout = service.maxOperationRetryTime;\n\n  function handler(_xhr: XhrIo, _text: string): void {}\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.successCodes = [200, 204];\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function determineContentType_(\n  metadata: Metadata | null,\n  blob: FbsBlob | null\n): string {\n  return (\n    (metadata && metadata['contentType']) ||\n    (blob && blob.type()) ||\n    'application/octet-stream'\n  );\n}\n\nexport function metadataForUpload_(\n  location: Location,\n  blob: FbsBlob,\n  metadata?: Metadata | null\n): Metadata {\n  const metadataClone = Object.assign({}, metadata);\n  metadataClone['fullPath'] = location.path;\n  metadataClone['size'] = blob.size();\n  if (!metadataClone['contentType']) {\n    metadataClone['contentType'] = determineContentType_(null, blob);\n  }\n  return metadataClone;\n}\n\nexport function multipartUpload(\n  service: StorageService,\n  location: Location,\n  mappings: MetadataUtils.Mappings,\n  blob: FbsBlob,\n  metadata?: Metadata | null\n): RequestInfo<Metadata> {\n  const urlPart = location.bucketOnlyServerUrl();\n  const headers: { [prop: string]: string } = {\n    'X-Goog-Upload-Protocol': 'multipart'\n  };\n\n  function genBoundary(): string {\n    let str = '';\n    for (let i = 0; i < 2; i++) {\n      str = str + Math.random().toString().slice(2);\n    }\n    return str;\n  }\n  const boundary = genBoundary();\n  headers['Content-Type'] = 'multipart/related; boundary=' + boundary;\n  const metadata_ = metadataForUpload_(location, blob, metadata);\n  const metadataString = MetadataUtils.toResourceString(metadata_, mappings);\n  const preBlobPart =\n    '--' +\n    boundary +\n    '\\r\\n' +\n    'Content-Type: application/json; charset=utf-8\\r\\n\\r\\n' +\n    metadataString +\n    '\\r\\n--' +\n    boundary +\n    '\\r\\n' +\n    'Content-Type: ' +\n    metadata_['contentType'] +\n    '\\r\\n\\r\\n';\n  const postBlobPart = '\\r\\n--' + boundary + '--';\n  const body = FbsBlob.getBlob(preBlobPart, blob, postBlobPart);\n  if (body === null) {\n    throw cannotSliceBlob();\n  }\n  const urlParams: UrlParams = { name: metadata_['fullPath']! };\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'POST';\n  const timeout = service.maxUploadRetryTime;\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    metadataHandler(service, mappings),\n    timeout\n  );\n  requestInfo.urlParams = urlParams;\n  requestInfo.headers = headers;\n  requestInfo.body = body.uploadData();\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\n/**\n * @param current The number of bytes that have been uploaded so far.\n * @param total The total number of bytes in the upload.\n * @param opt_finalized True if the server has finished the upload.\n * @param opt_metadata The upload metadata, should\n *     only be passed if opt_finalized is true.\n */\nexport class ResumableUploadStatus {\n  finalized: boolean;\n  metadata: Metadata | null;\n\n  constructor(\n    public current: number,\n    public total: number,\n    finalized?: boolean,\n    metadata?: Metadata | null\n  ) {\n    this.finalized = !!finalized;\n    this.metadata = metadata || null;\n  }\n}\n\nexport function checkResumeHeader_(xhr: XhrIo, allowed?: string[]): string {\n  let status: string | null = null;\n  try {\n    status = xhr.getResponseHeader('X-Goog-Upload-Status');\n  } catch (e) {\n    handlerCheck(false);\n  }\n  const allowedStatus = allowed || ['active'];\n  handlerCheck(!!status && allowedStatus.indexOf(status) !== -1);\n  return status as string;\n}\n\nexport function createResumableUpload(\n  service: StorageService,\n  location: Location,\n  mappings: MetadataUtils.Mappings,\n  blob: FbsBlob,\n  metadata?: Metadata | null\n): RequestInfo<string> {\n  const urlPart = location.bucketOnlyServerUrl();\n  const metadataForUpload = metadataForUpload_(location, blob, metadata);\n  const urlParams: UrlParams = { name: metadataForUpload['fullPath']! };\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'POST';\n  const headers = {\n    'X-Goog-Upload-Protocol': 'resumable',\n    'X-Goog-Upload-Command': 'start',\n    'X-Goog-Upload-Header-Content-Length': blob.size(),\n    'X-Goog-Upload-Header-Content-Type': metadataForUpload['contentType']!,\n    'Content-Type': 'application/json; charset=utf-8'\n  };\n  const body = MetadataUtils.toResourceString(metadataForUpload, mappings);\n  const timeout = service.maxUploadRetryTime;\n\n  function handler(xhr: XhrIo): string {\n    checkResumeHeader_(xhr);\n    let url;\n    try {\n      url = xhr.getResponseHeader('X-Goog-Upload-URL');\n    } catch (e) {\n      handlerCheck(false);\n    }\n    handlerCheck(type.isString(url));\n    return url as string;\n  }\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.urlParams = urlParams;\n  requestInfo.headers = headers;\n  requestInfo.body = body;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\n/**\n * @param url From a call to fbs.requests.createResumableUpload.\n */\nexport function getResumableUploadStatus(\n  service: StorageService,\n  location: Location,\n  url: string,\n  blob: FbsBlob\n): RequestInfo<ResumableUploadStatus> {\n  const headers = { 'X-Goog-Upload-Command': 'query' };\n\n  function handler(xhr: XhrIo): ResumableUploadStatus {\n    const status = checkResumeHeader_(xhr, ['active', 'final']);\n    let sizeString: string | null = null;\n    try {\n      sizeString = xhr.getResponseHeader('X-Goog-Upload-Size-Received');\n    } catch (e) {\n      handlerCheck(false);\n    }\n\n    if (!sizeString) {\n      // null or empty string\n      handlerCheck(false);\n    }\n\n    const size = Number(sizeString);\n    handlerCheck(!isNaN(size));\n    return new ResumableUploadStatus(size, blob.size(), status === 'final');\n  }\n  const method = 'POST';\n  const timeout = service.maxUploadRetryTime;\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.headers = headers;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\n/**\n * Any uploads via the resumable upload API must transfer a number of bytes\n * that is a multiple of this number.\n */\nexport const resumableUploadChunkSize: number = 256 * 1024;\n\n/**\n * @param url From a call to fbs.requests.createResumableUpload.\n * @param chunkSize Number of bytes to upload.\n * @param status The previous status.\n *     If not passed or null, we start from the beginning.\n * @throws fbs.Error If the upload is already complete, the passed in status\n *     has a final size inconsistent with the blob, or the blob cannot be sliced\n *     for upload.\n */\nexport function continueResumableUpload(\n  location: Location,\n  service: StorageService,\n  url: string,\n  blob: FbsBlob,\n  chunkSize: number,\n  mappings: MetadataUtils.Mappings,\n  status?: ResumableUploadStatus | null,\n  progressCallback?: ((p1: number, p2: number) => void) | null\n): RequestInfo<ResumableUploadStatus> {\n  // TODO(andysoto): standardize on internal asserts\n  // assert(!(opt_status && opt_status.finalized));\n  const status_ = new ResumableUploadStatus(0, 0);\n  if (status) {\n    status_.current = status.current;\n    status_.total = status.total;\n  } else {\n    status_.current = 0;\n    status_.total = blob.size();\n  }\n  if (blob.size() !== status_.total) {\n    throw serverFileWrongSize();\n  }\n  const bytesLeft = status_.total - status_.current;\n  let bytesToUpload = bytesLeft;\n  if (chunkSize > 0) {\n    bytesToUpload = Math.min(bytesToUpload, chunkSize);\n  }\n  const startByte = status_.current;\n  const endByte = startByte + bytesToUpload;\n  const uploadCommand =\n    bytesToUpload === bytesLeft ? 'upload, finalize' : 'upload';\n  const headers = {\n    'X-Goog-Upload-Command': uploadCommand,\n    'X-Goog-Upload-Offset': status_.current\n  };\n  const body = blob.slice(startByte, endByte);\n  if (body === null) {\n    throw cannotSliceBlob();\n  }\n\n  function handler(xhr: XhrIo, text: string): ResumableUploadStatus {\n    // TODO(andysoto): Verify the MD5 of each uploaded range:\n    // the 'x-range-md5' header comes back with status code 308 responses.\n    // We'll only be able to bail out though, because you can't re-upload a\n    // range that you previously uploaded.\n    const uploadStatus = checkResumeHeader_(xhr, ['active', 'final']);\n    const newCurrent = status_.current + bytesToUpload;\n    const size = blob.size();\n    let metadata;\n    if (uploadStatus === 'final') {\n      metadata = metadataHandler(service, mappings)(xhr, text);\n    } else {\n      metadata = null;\n    }\n    return new ResumableUploadStatus(\n      newCurrent,\n      size,\n      uploadStatus === 'final',\n      metadata\n    );\n  }\n  const method = 'POST';\n  const timeout = service.maxUploadRetryTime;\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.headers = headers;\n  requestInfo.body = body.uploadData();\n  requestInfo.progressCallback = progressCallback || null;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as type from './type';\nimport { FirebaseStorageError } from './error';\n\nexport type NextFn<T> = (value: T) => void;\nexport type ErrorFn = (error: FirebaseStorageError) => void;\nexport type CompleteFn = () => void;\nexport type Unsubscribe = () => void;\n\nexport interface StorageObserver<T> {\n  next?: NextFn<T>;\n  error?: ErrorFn;\n  complete?: CompleteFn;\n}\n\nexport type Subscribe<T> = (\n  next?: NextFn<T> | StorageObserver<T>,\n  error?: ErrorFn,\n  complete?: CompleteFn\n) => Unsubscribe;\n\nexport class Observer<T> implements StorageObserver<T> {\n  next?: NextFn<T>;\n  error?: ErrorFn;\n  complete?: CompleteFn;\n\n  constructor(\n    nextOrObserver?: NextFn<T> | StorageObserver<T>,\n    error?: ErrorFn,\n    complete?: CompleteFn\n  ) {\n    const asFunctions =\n      type.isFunction(nextOrObserver) || error != null || complete != null;\n    if (asFunctions) {\n      this.next = nextOrObserver as NextFn<T>;\n      this.error = error;\n      this.complete = complete;\n    } else {\n      const observer = nextOrObserver as {\n        next?: NextFn<T>;\n        error?: ErrorFn;\n        complete?: CompleteFn;\n      };\n      this.next = observer.next;\n      this.error = observer.error;\n      this.complete = observer.complete;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { TaskState } from './implementation/taskenums';\nimport { Metadata } from './metadata';\nimport { Reference } from './reference';\nimport { UploadTask } from './task';\n\nexport class UploadTaskSnapshot {\n  constructor(\n    readonly bytesTransferred: number,\n    readonly totalBytes: number,\n    readonly state: TaskState,\n    readonly metadata: Metadata,\n    readonly task: UploadTask,\n    readonly ref: Reference\n  ) {}\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a function that invokes f with its arguments asynchronously as a\n * microtask, i.e. as soon as possible after the current script returns back\n * into browser code.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function async(f: Function): Function {\n  return (...argsToForward: unknown[]) => {\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    Promise.resolve().then(() => f(...argsToForward));\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Defines types for interacting with blob transfer tasks.\n */\n\nimport { FbsBlob } from './implementation/blob';\nimport { canceled, Code, FirebaseStorageError } from './implementation/error';\nimport {\n  InternalTaskState,\n  TaskEvent,\n  TaskState,\n  taskStateFromInternalTaskState\n} from './implementation/taskenums';\nimport { Metadata } from './metadata';\nimport {\n  CompleteFn,\n  ErrorFn,\n  Observer,\n  StorageObserver,\n  Subscribe,\n  Unsubscribe\n} from './implementation/observer';\nimport { Request } from './implementation/request';\nimport { UploadTaskSnapshot } from './tasksnapshot';\nimport { async as fbsAsync } from './implementation/async';\nimport * as fbsMetadata from './implementation/metadata';\nimport * as fbsRequests from './implementation/requests';\nimport { Reference } from './reference';\nimport { getMappings } from './implementation/metadata';\n\n/**\n * Represents a blob being uploaded. Can be used to pause/resume/cancel the\n * upload and manage callbacks for various events.\n */\nexport class UploadTask {\n  private _ref: Reference;\n  /**\n   * @internal\n   */\n  _blob: FbsBlob;\n  /**\n   * @internal\n   */\n  _metadata: Metadata | null;\n  private _mappings: fbsMetadata.Mappings;\n  /**\n   * @internal\n   */\n  _transferred: number = 0;\n  private _needToFetchStatus: boolean = false;\n  private _needToFetchMetadata: boolean = false;\n  private _observers: Array<StorageObserver<UploadTaskSnapshot>> = [];\n  private _resumable: boolean;\n  /**\n   * @internal\n   */\n  _state: InternalTaskState;\n  private _error?: FirebaseStorageError = undefined;\n  private _uploadUrl?: string = undefined;\n  private _request?: Request<unknown> = undefined;\n  private _chunkMultiplier: number = 1;\n  private _errorHandler: (p1: FirebaseStorageError) => void;\n  private _metadataErrorHandler: (p1: FirebaseStorageError) => void;\n  private _resolve?: (p1: UploadTaskSnapshot) => void = undefined;\n  private _reject?: (p1: FirebaseStorageError) => void = undefined;\n  private _promise: Promise<UploadTaskSnapshot>;\n\n  /**\n   * @param ref - The firebaseStorage.Reference object this task came\n   *     from, untyped to avoid cyclic dependencies.\n   * @param blob - The blob to upload.\n   */\n  constructor(ref: Reference, blob: FbsBlob, metadata: Metadata | null = null) {\n    this._ref = ref;\n    this._blob = blob;\n    this._metadata = metadata;\n    this._mappings = getMappings();\n    this._resumable = this._shouldDoResumable(this._blob);\n    this._state = InternalTaskState.RUNNING;\n    this._errorHandler = error => {\n      this._request = undefined;\n      this._chunkMultiplier = 1;\n      if (error.codeEquals(Code.CANCELED)) {\n        this._needToFetchStatus = true;\n        this.completeTransitions_();\n      } else {\n        this._error = error;\n        this._transition(InternalTaskState.ERROR);\n      }\n    };\n    this._metadataErrorHandler = error => {\n      this._request = undefined;\n      if (error.codeEquals(Code.CANCELED)) {\n        this.completeTransitions_();\n      } else {\n        this._error = error;\n        this._transition(InternalTaskState.ERROR);\n      }\n    };\n    this._promise = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n      this._start();\n    });\n\n    // Prevent uncaught rejections on the internal promise from bubbling out\n    // to the top level with a dummy handler.\n    this._promise.then(null, () => {});\n  }\n\n  private _makeProgressCallback(): (p1: number, p2: number) => void {\n    const sizeBefore = this._transferred;\n    return loaded => this._updateProgress(sizeBefore + loaded);\n  }\n\n  private _shouldDoResumable(blob: FbsBlob): boolean {\n    return blob.size() > 256 * 1024;\n  }\n\n  private _start(): void {\n    if (this._state !== InternalTaskState.RUNNING) {\n      // This can happen if someone pauses us in a resume callback, for example.\n      return;\n    }\n    if (this._request !== undefined) {\n      return;\n    }\n    if (this._resumable) {\n      if (this._uploadUrl === undefined) {\n        this._createResumable();\n      } else {\n        if (this._needToFetchStatus) {\n          this._fetchStatus();\n        } else {\n          if (this._needToFetchMetadata) {\n            // Happens if we miss the metadata on upload completion.\n            this._fetchMetadata();\n          } else {\n            this._continueUpload();\n          }\n        }\n      }\n    } else {\n      this._oneShotUpload();\n    }\n  }\n\n  private _resolveToken(callback: (p1: string | null) => void): void {\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this._ref.storage.getAuthToken().then(authToken => {\n      switch (this._state) {\n        case InternalTaskState.RUNNING:\n          callback(authToken);\n          break;\n        case InternalTaskState.CANCELING:\n          this._transition(InternalTaskState.CANCELED);\n          break;\n        case InternalTaskState.PAUSING:\n          this._transition(InternalTaskState.PAUSED);\n          break;\n        default:\n      }\n    });\n  }\n\n  // TODO(andysoto): assert false\n\n  private _createResumable(): void {\n    this._resolveToken(authToken => {\n      const requestInfo = fbsRequests.createResumableUpload(\n        this._ref.storage,\n        this._ref._location,\n        this._mappings,\n        this._blob,\n        this._metadata\n      );\n      const createRequest = this._ref.storage.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this._request = createRequest;\n      createRequest.getPromise().then((url: string) => {\n        this._request = undefined;\n        this._uploadUrl = url;\n        this._needToFetchStatus = false;\n        this.completeTransitions_();\n      }, this._errorHandler);\n    });\n  }\n\n  private _fetchStatus(): void {\n    // TODO(andysoto): assert(this.uploadUrl_ !== null);\n    const url = this._uploadUrl as string;\n    this._resolveToken(authToken => {\n      const requestInfo = fbsRequests.getResumableUploadStatus(\n        this._ref.storage,\n        this._ref._location,\n        url,\n        this._blob\n      );\n      const statusRequest = this._ref.storage.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this._request = statusRequest;\n      statusRequest.getPromise().then(status => {\n        status = status as fbsRequests.ResumableUploadStatus;\n        this._request = undefined;\n        this._updateProgress(status.current);\n        this._needToFetchStatus = false;\n        if (status.finalized) {\n          this._needToFetchMetadata = true;\n        }\n        this.completeTransitions_();\n      }, this._errorHandler);\n    });\n  }\n\n  private _continueUpload(): void {\n    const chunkSize =\n      fbsRequests.resumableUploadChunkSize * this._chunkMultiplier;\n    const status = new fbsRequests.ResumableUploadStatus(\n      this._transferred,\n      this._blob.size()\n    );\n\n    // TODO(andysoto): assert(this.uploadUrl_ !== null);\n    const url = this._uploadUrl as string;\n    this._resolveToken(authToken => {\n      let requestInfo;\n      try {\n        requestInfo = fbsRequests.continueResumableUpload(\n          this._ref._location,\n          this._ref.storage,\n          url,\n          this._blob,\n          chunkSize,\n          this._mappings,\n          status,\n          this._makeProgressCallback()\n        );\n      } catch (e) {\n        this._error = e;\n        this._transition(InternalTaskState.ERROR);\n        return;\n      }\n      const uploadRequest = this._ref.storage.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this._request = uploadRequest;\n      uploadRequest\n        .getPromise()\n        .then((newStatus: fbsRequests.ResumableUploadStatus) => {\n          this._increaseMultiplier();\n          this._request = undefined;\n          this._updateProgress(newStatus.current);\n          if (newStatus.finalized) {\n            this._metadata = newStatus.metadata;\n            this._transition(InternalTaskState.SUCCESS);\n          } else {\n            this.completeTransitions_();\n          }\n        }, this._errorHandler);\n    });\n  }\n\n  private _increaseMultiplier(): void {\n    const currentSize =\n      fbsRequests.resumableUploadChunkSize * this._chunkMultiplier;\n\n    // Max chunk size is 32M.\n    if (currentSize < 32 * 1024 * 1024) {\n      this._chunkMultiplier *= 2;\n    }\n  }\n\n  private _fetchMetadata(): void {\n    this._resolveToken(authToken => {\n      const requestInfo = fbsRequests.getMetadata(\n        this._ref.storage,\n        this._ref._location,\n        this._mappings\n      );\n      const metadataRequest = this._ref.storage.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this._request = metadataRequest;\n      metadataRequest.getPromise().then(metadata => {\n        this._request = undefined;\n        this._metadata = metadata;\n        this._transition(InternalTaskState.SUCCESS);\n      }, this._metadataErrorHandler);\n    });\n  }\n\n  private _oneShotUpload(): void {\n    this._resolveToken(authToken => {\n      const requestInfo = fbsRequests.multipartUpload(\n        this._ref.storage,\n        this._ref._location,\n        this._mappings,\n        this._blob,\n        this._metadata\n      );\n      const multipartRequest = this._ref.storage.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this._request = multipartRequest;\n      multipartRequest.getPromise().then(metadata => {\n        this._request = undefined;\n        this._metadata = metadata;\n        this._updateProgress(this._blob.size());\n        this._transition(InternalTaskState.SUCCESS);\n      }, this._errorHandler);\n    });\n  }\n\n  private _updateProgress(transferred: number): void {\n    const old = this._transferred;\n    this._transferred = transferred;\n\n    // A progress update can make the \"transferred\" value smaller (e.g. a\n    // partial upload not completed by server, after which the \"transferred\"\n    // value may reset to the value at the beginning of the request).\n    if (this._transferred !== old) {\n      this._notifyObservers();\n    }\n  }\n\n  private _transition(state: InternalTaskState): void {\n    if (this._state === state) {\n      return;\n    }\n    switch (state) {\n      case InternalTaskState.CANCELING:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING ||\n        //        this.state_ === InternalTaskState.PAUSING);\n        this._state = state;\n        if (this._request !== undefined) {\n          this._request.cancel();\n        }\n        break;\n      case InternalTaskState.PAUSING:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING);\n        this._state = state;\n        if (this._request !== undefined) {\n          this._request.cancel();\n        }\n        break;\n      case InternalTaskState.RUNNING:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.PAUSED ||\n        //        this.state_ === InternalTaskState.PAUSING);\n        const wasPaused = this._state === InternalTaskState.PAUSED;\n        this._state = state;\n        if (wasPaused) {\n          this._notifyObservers();\n          this._start();\n        }\n        break;\n      case InternalTaskState.PAUSED:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.PAUSING);\n        this._state = state;\n        this._notifyObservers();\n        break;\n      case InternalTaskState.CANCELED:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.PAUSED ||\n        //        this.state_ === InternalTaskState.CANCELING);\n        this._error = canceled();\n        this._state = state;\n        this._notifyObservers();\n        break;\n      case InternalTaskState.ERROR:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING ||\n        //        this.state_ === InternalTaskState.PAUSING ||\n        //        this.state_ === InternalTaskState.CANCELING);\n        this._state = state;\n        this._notifyObservers();\n        break;\n      case InternalTaskState.SUCCESS:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING ||\n        //        this.state_ === InternalTaskState.PAUSING ||\n        //        this.state_ === InternalTaskState.CANCELING);\n        this._state = state;\n        this._notifyObservers();\n        break;\n      default: // Ignore\n    }\n  }\n\n  private completeTransitions_(): void {\n    switch (this._state) {\n      case InternalTaskState.PAUSING:\n        this._transition(InternalTaskState.PAUSED);\n        break;\n      case InternalTaskState.CANCELING:\n        this._transition(InternalTaskState.CANCELED);\n        break;\n      case InternalTaskState.RUNNING:\n        this._start();\n        break;\n      default:\n        // TODO(andysoto): assert(false);\n        break;\n    }\n  }\n\n  get snapshot(): UploadTaskSnapshot {\n    const externalState = taskStateFromInternalTaskState(this._state);\n    return new UploadTaskSnapshot(\n      this._transferred,\n      this._blob.size(),\n      externalState,\n      this._metadata!,\n      this,\n      this._ref\n    );\n  }\n\n  /**\n   * Adds a callback for an event.\n   * @param type - The type of event to listen for.\n   */\n  on(\n    type: TaskEvent,\n    nextOrObserver?:\n      | StorageObserver<UploadTaskSnapshot>\n      | ((a: UploadTaskSnapshot) => unknown),\n    error?: ErrorFn,\n    completed?: CompleteFn\n  ): Unsubscribe | Subscribe<UploadTaskSnapshot> {\n    const observer = new Observer(nextOrObserver, error, completed);\n    this._addObserver(observer);\n    return () => {\n      this._removeObserver(observer);\n    };\n  }\n\n  /**\n   * This object behaves like a Promise, and resolves with its snapshot data\n   * when the upload completes.\n   * @param onFulfilled - The fulfillment callback. Promise chaining works as normal.\n   * @param onRejected - The rejection callback.\n   */\n  then<U>(\n    onFulfilled?: ((value: UploadTaskSnapshot) => U | Promise<U>) | null,\n    onRejected?: ((error: FirebaseStorageError) => U | Promise<U>) | null\n  ): Promise<U> {\n    // These casts are needed so that TypeScript can infer the types of the\n    // resulting Promise.\n    return this._promise.then<U>(\n      onFulfilled as (value: UploadTaskSnapshot) => U | Promise<U>,\n      onRejected as ((error: unknown) => Promise<never>) | null\n    );\n  }\n\n  /**\n   * Equivalent to calling `then(null, onRejected)`.\n   */\n  catch<T>(\n    onRejected: (p1: FirebaseStorageError) => T | Promise<T>\n  ): Promise<T> {\n    return this.then(null, onRejected);\n  }\n\n  /**\n   * Adds the given observer.\n   */\n  private _addObserver(observer: Observer<UploadTaskSnapshot>): void {\n    this._observers.push(observer);\n    this._notifyObserver(observer);\n  }\n\n  /**\n   * Removes the given observer.\n   */\n  private _removeObserver(observer: Observer<UploadTaskSnapshot>): void {\n    const i = this._observers.indexOf(observer);\n    if (i !== -1) {\n      this._observers.splice(i, 1);\n    }\n  }\n\n  private _notifyObservers(): void {\n    this._finishPromise();\n    const observers = this._observers.slice();\n    observers.forEach(observer => {\n      this._notifyObserver(observer);\n    });\n  }\n\n  private _finishPromise(): void {\n    if (this._resolve !== undefined) {\n      let triggered = true;\n      switch (taskStateFromInternalTaskState(this._state)) {\n        case TaskState.SUCCESS:\n          fbsAsync(this._resolve.bind(null, this.snapshot))();\n          break;\n        case TaskState.CANCELED:\n        case TaskState.ERROR:\n          const toCall = this._reject as (p1: FirebaseStorageError) => void;\n          fbsAsync(toCall.bind(null, this._error as FirebaseStorageError))();\n          break;\n        default:\n          triggered = false;\n          break;\n      }\n      if (triggered) {\n        this._resolve = undefined;\n        this._reject = undefined;\n      }\n    }\n  }\n\n  private _notifyObserver(observer: Observer<UploadTaskSnapshot>): void {\n    const externalState = taskStateFromInternalTaskState(this._state);\n    switch (externalState) {\n      case TaskState.RUNNING:\n      case TaskState.PAUSED:\n        if (observer.next) {\n          fbsAsync(observer.next.bind(observer, this.snapshot))();\n        }\n        break;\n      case TaskState.SUCCESS:\n        if (observer.complete) {\n          fbsAsync(observer.complete.bind(observer))();\n        }\n        break;\n      case TaskState.CANCELED:\n      case TaskState.ERROR:\n        if (observer.error) {\n          fbsAsync(\n            observer.error.bind(observer, this._error as FirebaseStorageError)\n          )();\n        }\n        break;\n      default:\n        // TODO(andysoto): assert(false);\n        if (observer.error) {\n          fbsAsync(\n            observer.error.bind(observer, this._error as FirebaseStorageError)\n          )();\n        }\n    }\n  }\n\n  /**\n   * Resumes a paused task. Has no effect on a currently running or failed task.\n   * @returns True if the operation took effect, false if ignored.\n   */\n  resume(): boolean {\n    const valid =\n      this._state === InternalTaskState.PAUSED ||\n      this._state === InternalTaskState.PAUSING;\n    if (valid) {\n      this._transition(InternalTaskState.RUNNING);\n    }\n    return valid;\n  }\n\n  /**\n   * Pauses a currently running task. Has no effect on a paused or failed task.\n   * @returns True if the operation took effect, false if ignored.\n   */\n  pause(): boolean {\n    const valid = this._state === InternalTaskState.RUNNING;\n    if (valid) {\n      this._transition(InternalTaskState.PAUSING);\n    }\n    return valid;\n  }\n\n  /**\n   * Cancels a currently running or paused task. Has no effect on a complete or\n   * failed task.\n   * @returns True if the operation took effect, false if ignored.\n   */\n  cancel(): boolean {\n    const valid =\n      this._state === InternalTaskState.RUNNING ||\n      this._state === InternalTaskState.PAUSING;\n    if (valid) {\n      this._transition(InternalTaskState.CANCELING);\n    }\n    return valid;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Defines the Firebase Storage Reference class.\n */\n\nimport { FbsBlob } from './implementation/blob';\nimport { Location } from './implementation/location';\nimport { getMappings } from './implementation/metadata';\nimport { child, parent, lastComponent } from './implementation/path';\nimport {\n  list as requestsList,\n  getMetadata as requestsGetMetadata,\n  updateMetadata as requestsUpdateMetadata,\n  getDownloadUrl as requestsGetDownloadUrl,\n  deleteObject as requestsDeleteObject\n} from './implementation/requests';\nimport { StringFormat, dataFromString } from './implementation/string';\nimport { Metadata } from './metadata';\nimport { StorageService } from './service';\nimport { ListOptions, ListResult } from './list';\nimport { UploadTask } from './task';\nimport { invalidRootOperation, noDownloadURL } from './implementation/error';\nimport { validateNumber } from './implementation/type';\n\n/**\n * Provides methods to interact with a bucket in the Firebase Storage service.\n * @param location - An fbs.location, or the URL at\n *     which to base this object, in one of the following forms:\n *         gs://<bucket>/<object-path>\n *         http[s]://firebasestorage.googleapis.com/\n *                     <api-version>/b/<bucket>/o/<object-path>\n *     Any query or fragment strings will be ignored in the http[s]\n *     format. If no value is passed, the storage object will use a URL based on\n *     the project ID of the base firebase.App instance.\n */\nexport class Reference {\n  /**\n   * @internal\n   */\n  _location: Location;\n\n  constructor(private _service: StorageService, location: string | Location) {\n    if (location instanceof Location) {\n      this._location = location;\n    } else {\n      this._location = Location.makeFromUrl(location);\n    }\n  }\n\n  /**\n   * @returns The URL for the bucket and path this object references,\n   *     in the form gs://<bucket>/<object-path>\n   * @override\n   */\n  toString(): string {\n    return 'gs://' + this._location.bucket + '/' + this._location.path;\n  }\n\n  protected newRef(service: StorageService, location: Location): Reference {\n    return new Reference(service, location);\n  }\n\n  /**\n   * @returns An reference to the root of this\n   *     object's bucket.\n   */\n  get root(): Reference {\n    const location = new Location(this._location.bucket, '');\n    return this.newRef(this._service, location);\n  }\n\n  get bucket(): string {\n    return this._location.bucket;\n  }\n\n  get fullPath(): string {\n    return this._location.path;\n  }\n\n  get name(): string {\n    return lastComponent(this._location.path);\n  }\n\n  get storage(): StorageService {\n    return this._service;\n  }\n\n  get parent(): Reference | null {\n    const newPath = parent(this._location.path);\n    if (newPath === null) {\n      return null;\n    }\n    const location = new Location(this._location.bucket, newPath);\n    return new Reference(this._service, location);\n  }\n\n  _throwIfRoot(name: string): void {\n    if (this._location.path === '') {\n      throw invalidRootOperation(name);\n    }\n  }\n}\n\n/**\n * Uploads a blob to this object's location.\n * @public\n * @param ref - Storage Reference where data should be uploaded.\n * @param data - The data to upload.\n * @param metadata - Metadata for the newly uploaded string.\n * @returns An UploadTask that lets you control and\n *     observe the upload.\n */\nexport function uploadBytesResumable(\n  ref: Reference,\n  data: Blob | Uint8Array | ArrayBuffer,\n  metadata: Metadata | null = null\n): UploadTask {\n  ref._throwIfRoot('uploadBytesResumable');\n  return new UploadTask(ref, new FbsBlob(data), metadata);\n}\n\n/**\n * Uploads a string to this object's location.\n * @public\n * @param ref - Storage Reference where string should be uploaded.\n * @param value - The string to upload.\n * @param format - The format of the string to upload.\n * @param metadata - Metadata for the newly uploaded object.\n * @returns An UploadTask that lets you control and\n *     observe the upload.\n */\nexport function uploadString(\n  ref: Reference,\n  value: string,\n  format: StringFormat = StringFormat.RAW,\n  metadata?: Metadata\n): UploadTask {\n  ref._throwIfRoot('putString');\n  const data = dataFromString(format, value);\n  const metadataClone = { ...metadata } as Metadata;\n  if (metadataClone['contentType'] == null && data.contentType != null) {\n    metadataClone['contentType'] = data.contentType!;\n  }\n  return new UploadTask(ref, new FbsBlob(data.data, true), metadataClone);\n}\n\n/**\n * List all items (files) and prefixes (folders) under this storage reference.\n *\n * This is a helper method for calling list() repeatedly until there are\n * no more results. The default pagination size is 1000.\n *\n * Note: The results may not be consistent if objects are changed while this\n * operation is running.\n *\n * Warning: listAll may potentially consume too many resources if there are\n * too many results.\n * @public\n * @param ref - Storage Reference to get list from.\n *\n * @returns A Promise that resolves with all the items and prefixes under\n *      the current storage reference. `prefixes` contains references to\n *      sub-directories and `items` contains references to objects in this\n *      folder. `nextPageToken` is never returned.\n */\nexport function listAll(ref: Reference): Promise<ListResult> {\n  const accumulator: ListResult = {\n    prefixes: [],\n    items: []\n  };\n  return listAllHelper(ref, accumulator).then(() => accumulator);\n}\n\n/**\n * Separated from listAll because async functions can't use \"arguments\".\n * @internal\n * @param ref\n * @param accumulator\n * @param pageToken\n */\nasync function listAllHelper(\n  ref: Reference,\n  accumulator: ListResult,\n  pageToken?: string\n): Promise<void> {\n  const opt: ListOptions = {\n    // maxResults is 1000 by default.\n    pageToken\n  };\n  const nextPage = await list(ref, opt);\n  accumulator.prefixes.push(...nextPage.prefixes);\n  accumulator.items.push(...nextPage.items);\n  if (nextPage.nextPageToken != null) {\n    await listAllHelper(ref, accumulator, nextPage.nextPageToken);\n  }\n}\n\n/**\n * List items (files) and prefixes (folders) under this storage reference.\n *\n * List API is only available for Firebase Rules Version 2.\n *\n * GCS is a key-blob store. Firebase Storage imposes the semantic of '/'\n * delimited folder structure.\n * Refer to GCS's List API if you want to learn more.\n *\n * To adhere to Firebase Rules's Semantics, Firebase Storage does not\n * support objects whose paths end with \"/\" or contain two consecutive\n * \"/\"s. Firebase Storage List API will filter these unsupported objects.\n * list() may fail if there are too many unsupported objects in the bucket.\n * @public\n *\n * @param ref - Storage Reference to get list from.\n * @param options - See ListOptions for details.\n * @returns A Promise that resolves with the items and prefixes.\n *      `prefixes` contains references to sub-folders and `items`\n *      contains references to objects in this folder. `nextPageToken`\n *      can be used to get the rest of the results.\n */\nexport async function list(\n  ref: Reference,\n  options?: ListOptions | null\n): Promise<ListResult> {\n  if (options != null) {\n    if (typeof options.maxResults === 'number') {\n      validateNumber(\n        'options.maxResults',\n        /* minValue= */ 1,\n        /* maxValue= */ 1000,\n        options.maxResults\n      );\n    }\n  }\n  const authToken = await ref.storage.getAuthToken();\n  const op = options || {};\n  const requestInfo = requestsList(\n    ref.storage,\n    ref._location,\n    /*delimiter= */ '/',\n    op.pageToken,\n    op.maxResults\n  );\n  return ref.storage.makeRequest(requestInfo, authToken).getPromise();\n}\n\n/**\n * A promise that resolves with the metadata for this object. If this\n * object doesn't exist or metadata cannot be retreived, the promise is\n * rejected.\n * @public\n * @param ref - Storage Reference to get metadata from.\n */\nexport async function getMetadata(ref: Reference): Promise<Metadata> {\n  ref._throwIfRoot('getMetadata');\n  const authToken = await ref.storage.getAuthToken();\n  const requestInfo = requestsGetMetadata(\n    ref.storage,\n    ref._location,\n    getMappings()\n  );\n  return ref.storage.makeRequest(requestInfo, authToken).getPromise();\n}\n\n/**\n * Updates the metadata for this object.\n * @public\n * @param ref - Storage Reference to update metadata for.\n * @param metadata - The new metadata for the object.\n *     Only values that have been explicitly set will be changed. Explicitly\n *     setting a value to null will remove the metadata.\n * @returns A promise that resolves\n *     with the new metadata for this object.\n *     See `firebaseStorage.Reference.prototype.getMetadata`\n */\nexport async function updateMetadata(\n  ref: Reference,\n  metadata: Metadata\n): Promise<Metadata> {\n  ref._throwIfRoot('updateMetadata');\n  const authToken = await ref.storage.getAuthToken();\n  const requestInfo = requestsUpdateMetadata(\n    ref.storage,\n    ref._location,\n    metadata,\n    getMappings()\n  );\n  return ref.storage.makeRequest(requestInfo, authToken).getPromise();\n}\n\n/**\n * Returns the download URL for the given Reference.\n * @public\n * @returns A promise that resolves with the download\n *     URL for this object.\n */\nexport async function getDownloadURL(ref: Reference): Promise<string> {\n  ref._throwIfRoot('getDownloadURL');\n  const authToken = await ref.storage.getAuthToken();\n  const requestInfo = requestsGetDownloadUrl(\n    ref.storage,\n    ref._location,\n    getMappings()\n  );\n  return ref.storage\n    .makeRequest(requestInfo, authToken)\n    .getPromise()\n    .then(url => {\n      if (url === null) {\n        throw noDownloadURL();\n      }\n      return url;\n    });\n}\n\n/**\n * Deletes the object at this location.\n * @public\n * @param ref - Storage Reference for object to delete.\n * @returns A promise that resolves if the deletion succeeds.\n */\nexport async function deleteObject(ref: Reference): Promise<void> {\n  ref._throwIfRoot('deleteObject');\n  const authToken = await ref.storage.getAuthToken();\n  const requestInfo = requestsDeleteObject(ref.storage, ref._location);\n  return ref.storage.makeRequest(requestInfo, authToken).getPromise();\n}\n\n/**\n * Returns reference for object obtained by appending `childPath` to `ref`.\n * @internal\n *\n * @param ref - Storage Reference to get child of.\n * @param childPath - Child path from provided ref.\n * @returns A reference to the object obtained by\n * appending childPath, removing any duplicate, beginning, or trailing\n * slashes.\n */\nexport function getChild(ref: Reference, childPath: string): Reference {\n  const newPath = child(ref._location.path, childPath);\n  const location = new Location(ref._location.bucket, newPath);\n  return new Reference(ref.storage, location);\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as types from '@firebase/storage-types';\nimport { ReferenceCompat } from './reference';\nimport { UploadTaskCompat } from './task';\nimport { UploadTaskSnapshot } from '../src/tasksnapshot';\nimport { Metadata } from '../src/metadata';\n\nexport class UploadTaskSnapshotCompat implements types.UploadTaskSnapshot {\n  constructor(\n    readonly _delegate: UploadTaskSnapshot,\n    readonly task: UploadTaskCompat,\n    readonly ref: ReferenceCompat\n  ) {}\n\n  get bytesTransferred(): number {\n    return this._delegate.bytesTransferred;\n  }\n  get metadata(): Metadata {\n    return this._delegate.metadata;\n  }\n  get state(): string {\n    return this._delegate.state;\n  }\n  get totalBytes(): number {\n    return this._delegate.totalBytes;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { UploadTask } from '../src/task';\nimport { UploadTaskSnapshotCompat } from './tasksnapshot';\nimport { TaskEvent } from '../src/implementation/taskenums';\nimport * as types from '@firebase/storage-types';\nimport {\n  StorageObserver,\n  ErrorFn,\n  CompleteFn,\n  Subscribe,\n  Unsubscribe\n} from '../src/implementation/observer';\nimport { UploadTaskSnapshot } from '../src/tasksnapshot';\nimport { ReferenceCompat } from './reference';\nimport { FirebaseStorageError } from '../src/implementation/error';\n\nexport class UploadTaskCompat implements types.UploadTask {\n  private readonly _snapshot: UploadTaskSnapshotCompat;\n  constructor(\n    private readonly _delegate: UploadTask,\n    private readonly _ref: ReferenceCompat\n  ) {\n    this._snapshot = new UploadTaskSnapshotCompat(\n      this._delegate.snapshot,\n      this,\n      this._ref\n    );\n  }\n\n  get snapshot(): UploadTaskSnapshotCompat {\n    return this._snapshot;\n  }\n\n  cancel = this._delegate.cancel.bind(this._delegate);\n  catch = this._delegate.catch.bind(this._delegate);\n  pause = this._delegate.pause.bind(this._delegate);\n  resume = this._delegate.resume.bind(this._delegate);\n\n  then(\n    onFulfilled?: ((a: UploadTaskSnapshotCompat) => unknown) | null,\n    onRejected?: ((a: FirebaseStorageError) => unknown) | null\n  ): Promise<unknown> {\n    return this._delegate.then(snapshot => {\n      if (onFulfilled) {\n        return onFulfilled(\n          new UploadTaskSnapshotCompat(snapshot, this, this._ref)\n        );\n      }\n    }, onRejected);\n  }\n\n  on(\n    type: TaskEvent,\n    nextOrObserver?:\n      | types.StorageObserver<UploadTaskSnapshotCompat>\n      | null\n      | ((a: UploadTaskSnapshotCompat) => unknown),\n    error?: ErrorFn | null,\n    completed?: CompleteFn | null\n  ): Unsubscribe | Subscribe<UploadTaskSnapshotCompat> {\n    let wrappedNextOrObserver:\n      | StorageObserver<UploadTaskSnapshot>\n      | undefined\n      | ((a: UploadTaskSnapshot) => unknown) = undefined;\n    if (!!nextOrObserver) {\n      if (typeof nextOrObserver === 'function') {\n        wrappedNextOrObserver = (taskSnapshot: UploadTaskSnapshot) =>\n          nextOrObserver(\n            new UploadTaskSnapshotCompat(taskSnapshot, this, this._ref)\n          );\n      } else {\n        wrappedNextOrObserver = {\n          next: !!nextOrObserver.next\n            ? (taskSnapshot: UploadTaskSnapshot) =>\n                nextOrObserver.next!(\n                  new UploadTaskSnapshotCompat(taskSnapshot, this, this._ref)\n                )\n            : undefined,\n          complete: nextOrObserver.complete || undefined,\n          error: nextOrObserver.error || undefined\n        };\n      }\n    }\n    return this._delegate.on(\n      type,\n      wrappedNextOrObserver,\n      error || undefined,\n      completed || undefined\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as types from '@firebase/storage-types';\nimport { ListResult } from '../src/list';\nimport { ReferenceCompat } from './reference';\nimport { StorageServiceCompat } from './service';\n\nexport class ListResultCompat implements types.ListResult {\n  constructor(\n    private readonly _delegate: ListResult,\n    private readonly _service: StorageServiceCompat\n  ) {}\n\n  get prefixes(): ReferenceCompat[] {\n    return this._delegate.prefixes.map(\n      ref => new ReferenceCompat(ref, this._service)\n    );\n  }\n  get items(): ReferenceCompat[] {\n    return this._delegate.items.map(\n      ref => new ReferenceCompat(ref, this._service)\n    );\n  }\n  get nextPageToken(): string | null {\n    return this._delegate.nextPageToken || null;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Reference,\n  getChild,\n  uploadBytesResumable,\n  uploadString,\n  list,\n  listAll,\n  getDownloadURL,\n  getMetadata,\n  updateMetadata,\n  deleteObject\n} from '../src/reference';\nimport * as types from '@firebase/storage-types';\nimport { Metadata } from '../src/metadata';\nimport { StringFormat } from '../src/implementation/string';\nimport { ListOptions } from '../src/list';\nimport { UploadTaskCompat } from './task';\nimport { ListResultCompat } from './list';\nimport { StorageServiceCompat } from './service';\nimport { invalidRootOperation } from '../src/implementation/error';\n\nexport class ReferenceCompat implements types.Reference {\n  constructor(\n    private readonly _delegate: Reference,\n    public storage: StorageServiceCompat\n  ) {}\n\n  get name(): string {\n    return this._delegate.name;\n  }\n\n  get bucket(): string {\n    return this._delegate.bucket;\n  }\n\n  get fullPath(): string {\n    return this._delegate.fullPath;\n  }\n\n  toString(): string {\n    return this._delegate.toString();\n  }\n\n  /**\n   * @returns A reference to the object obtained by\n   * appending childPath, removing any duplicate, beginning, or trailing\n   * slashes.\n   */\n  child(childPath: string): types.Reference {\n    const reference = getChild(this._delegate, childPath);\n    return new ReferenceCompat(reference, this.storage);\n  }\n\n  get root(): types.Reference {\n    return new ReferenceCompat(this._delegate.root, this.storage);\n  }\n\n  /**\n   * @returns A reference to the parent of the\n   * current object, or null if the current object is the root.\n   */\n  get parent(): types.Reference | null {\n    const reference = this._delegate.parent;\n    if (reference == null) {\n      return null;\n    }\n    return new ReferenceCompat(reference, this.storage);\n  }\n\n  /**\n   * Uploads a blob to this object's location.\n   * @param data - The blob to upload.\n   * @returns An UploadTask that lets you control and\n   * observe the upload.\n   */\n  put(\n    data: Blob | Uint8Array | ArrayBuffer,\n    metadata?: Metadata\n  ): types.UploadTask {\n    this._throwIfRoot('put');\n    return new UploadTaskCompat(\n      uploadBytesResumable(this._delegate, data, metadata),\n      this\n    );\n  }\n\n  /**\n   * Uploads a string to this object's location.\n   * @param value - The string to upload.\n   * @param format - The format of the string to upload.\n   * @returns An UploadTask that lets you control and\n   * observe the upload.\n   */\n  putString(\n    value: string,\n    format: StringFormat = StringFormat.RAW,\n    metadata?: Metadata\n  ): types.UploadTask {\n    this._throwIfRoot('putString');\n    return new UploadTaskCompat(\n      uploadString(this._delegate, value, format, metadata),\n      this\n    );\n  }\n\n  /**\n   * List all items (files) and prefixes (folders) under this storage reference.\n   *\n   * This is a helper method for calling list() repeatedly until there are\n   * no more results. The default pagination size is 1000.\n   *\n   * Note: The results may not be consistent if objects are changed while this\n   * operation is running.\n   *\n   * Warning: listAll may potentially consume too many resources if there are\n   * too many results.\n   *\n   * @returns A Promise that resolves with all the items and prefixes under\n   *  the current storage reference. `prefixes` contains references to\n   *  sub-directories and `items` contains references to objects in this\n   *  folder. `nextPageToken` is never returned.\n   */\n  listAll(): Promise<types.ListResult> {\n    return listAll(this._delegate).then(\n      r => new ListResultCompat(r, this.storage)\n    );\n  }\n\n  /**\n   * List items (files) and prefixes (folders) under this storage reference.\n   *\n   * List API is only available for Firebase Rules Version 2.\n   *\n   * GCS is a key-blob store. Firebase Storage imposes the semantic of '/'\n   * delimited folder structure. Refer to GCS's List API if you want to learn more.\n   *\n   * To adhere to Firebase Rules's Semantics, Firebase Storage does not\n   * support objects whose paths end with \"/\" or contain two consecutive\n   * \"/\"s. Firebase Storage List API will filter these unsupported objects.\n   * list() may fail if there are too many unsupported objects in the bucket.\n   *\n   * @param options - See ListOptions for details.\n   * @returns A Promise that resolves with the items and prefixes.\n   * `prefixes` contains references to sub-folders and `items`\n   * contains references to objects in this folder. `nextPageToken`\n   * can be used to get the rest of the results.\n   */\n  list(options?: ListOptions | null): Promise<types.ListResult> {\n    return list(this._delegate, options).then(\n      r => new ListResultCompat(r, this.storage)\n    );\n  }\n\n  /**\n   * A promise that resolves with the metadata for this object. If this\n   * object doesn't exist or metadata cannot be retreived, the promise is\n   * rejected.\n   */\n  getMetadata(): Promise<Metadata> {\n    return getMetadata(this._delegate);\n  }\n\n  /**\n   * Updates the metadata for this object.\n   * @param metadata - The new metadata for the object.\n   * Only values that have been explicitly set will be changed. Explicitly\n   * setting a value to null will remove the metadata.\n   * @returns A promise that resolves\n   * with the new metadata for this object.\n   * @see firebaseStorage.Reference.prototype.getMetadata\n   */\n  updateMetadata(metadata: Metadata): Promise<Metadata> {\n    return updateMetadata(this._delegate, metadata);\n  }\n\n  /**\n   * @returns A promise that resolves with the download\n   * URL for this object.\n   */\n  getDownloadURL(): Promise<string> {\n    return getDownloadURL(this._delegate);\n  }\n\n  /**\n   * Deletes the object at this location.\n   * @returns A promise that resolves if the deletion succeeds.\n   */\n  delete(): Promise<void> {\n    this._throwIfRoot('delete');\n    return deleteObject(this._delegate);\n  }\n\n  private _throwIfRoot(name: string): void {\n    if (this._delegate._location.path === '') {\n      throw invalidRootOperation(name);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { FirebaseStorageError } from './error';\nimport { Request } from './request';\n\n/**\n * A request whose promise always fails.\n */\nexport class FailRequest<T> implements Request<T> {\n  promise_: Promise<T>;\n\n  constructor(error: FirebaseStorageError) {\n    this.promise_ = Promise.reject<T>(error);\n  }\n\n  /** @inheritDoc */\n  getPromise(): Promise<T> {\n    return this.promise_;\n  }\n\n  /** @inheritDoc */\n  cancel(_appDelete = false): void {}\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Defines methods used to actually send HTTP requests from\n * abstract representations.\n */\n\nimport firebase from '@firebase/app';\nimport * as backoff from './backoff';\nimport {\n  FirebaseStorageError,\n  unknown,\n  appDeleted,\n  canceled,\n  retryLimitExceeded\n} from './error';\nimport { RequestInfo } from './requestinfo';\nimport * as type from './type';\nimport * as UrlUtils from './url';\nimport { Headers, XhrIo, ErrorCode } from './xhrio';\nimport { XhrIoPool } from './xhriopool';\n\nexport interface Request<T> {\n  getPromise(): Promise<T>;\n\n  /**\n   * Cancels the request. IMPORTANT: the promise may still be resolved with an\n   * appropriate value (if the request is finished before you call this method,\n   * but the promise has not yet been resolved), so don't just assume it will be\n   * rejected if you call this function.\n   * @param appDelete - True if the cancelation came from the app being deleted.\n   */\n  cancel(appDelete?: boolean): void;\n}\n\nclass NetworkRequest<T> implements Request<T> {\n  private url_: string;\n  private method_: string;\n  private headers_: Headers;\n  private body_: string | Blob | Uint8Array | null;\n  private successCodes_: number[];\n  private additionalRetryCodes_: number[];\n  private pendingXhr_: XhrIo | null = null;\n  private backoffId_: backoff.id | null = null;\n  private resolve_!: (value?: T | PromiseLike<T> | undefined) => void;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private reject_!: (reason?: any) => void;\n  private canceled_: boolean = false;\n  private appDelete_: boolean = false;\n  private callback_: (p1: XhrIo, p2: string) => T;\n  private errorCallback_:\n    | ((p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError)\n    | null;\n  private progressCallback_: ((p1: number, p2: number) => void) | null;\n  private timeout_: number;\n  private pool_: XhrIoPool;\n  promise_: Promise<T>;\n\n  constructor(\n    url: string,\n    method: string,\n    headers: Headers,\n    body: string | Blob | Uint8Array | null,\n    successCodes: number[],\n    additionalRetryCodes: number[],\n    callback: (p1: XhrIo, p2: string) => T,\n    errorCallback:\n      | ((p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError)\n      | null,\n    timeout: number,\n    progressCallback: ((p1: number, p2: number) => void) | null,\n    pool: XhrIoPool\n  ) {\n    this.url_ = url;\n    this.method_ = method;\n    this.headers_ = headers;\n    this.body_ = body;\n    this.successCodes_ = successCodes.slice();\n    this.additionalRetryCodes_ = additionalRetryCodes.slice();\n    this.callback_ = callback;\n    this.errorCallback_ = errorCallback;\n    this.progressCallback_ = progressCallback;\n    this.timeout_ = timeout;\n    this.pool_ = pool;\n    this.promise_ = new Promise((resolve, reject) => {\n      this.resolve_ = resolve;\n      this.reject_ = reject;\n      this.start_();\n    });\n  }\n\n  /**\n   * Actually starts the retry loop.\n   */\n  private start_(): void {\n    const self = this;\n\n    function doTheRequest(\n      backoffCallback: (p1: boolean, ...p2: unknown[]) => void,\n      canceled: boolean\n    ): void {\n      if (canceled) {\n        backoffCallback(false, new RequestEndStatus(false, null, true));\n        return;\n      }\n      const xhr = self.pool_.createXhrIo();\n      self.pendingXhr_ = xhr;\n\n      function progressListener(progressEvent: ProgressEvent): void {\n        const loaded = progressEvent.loaded;\n        const total = progressEvent.lengthComputable ? progressEvent.total : -1;\n        if (self.progressCallback_ !== null) {\n          self.progressCallback_(loaded, total);\n        }\n      }\n      if (self.progressCallback_ !== null) {\n        xhr.addUploadProgressListener(progressListener);\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      xhr\n        .send(self.url_, self.method_, self.body_, self.headers_)\n        .then((xhr: XhrIo) => {\n          if (self.progressCallback_ !== null) {\n            xhr.removeUploadProgressListener(progressListener);\n          }\n          self.pendingXhr_ = null;\n          xhr = xhr as XhrIo;\n          const hitServer = xhr.getErrorCode() === ErrorCode.NO_ERROR;\n          const status = xhr.getStatus();\n          if (!hitServer || self.isRetryStatusCode_(status)) {\n            const wasCanceled = xhr.getErrorCode() === ErrorCode.ABORT;\n            backoffCallback(\n              false,\n              new RequestEndStatus(false, null, wasCanceled)\n            );\n            return;\n          }\n          const successCode = self.successCodes_.indexOf(status) !== -1;\n          backoffCallback(true, new RequestEndStatus(successCode, xhr));\n        });\n    }\n\n    /**\n     * @param requestWentThrough - True if the request eventually went\n     *     through, false if it hit the retry limit or was canceled.\n     */\n    function backoffDone(\n      requestWentThrough: boolean,\n      status: RequestEndStatus\n    ): void {\n      const resolve = self.resolve_;\n      const reject = self.reject_;\n      const xhr = status.xhr as XhrIo;\n      if (status.wasSuccessCode) {\n        try {\n          const result = self.callback_(xhr, xhr.getResponseText());\n          if (type.isJustDef(result)) {\n            resolve(result);\n          } else {\n            resolve();\n          }\n        } catch (e) {\n          reject(e);\n        }\n      } else {\n        if (xhr !== null) {\n          const err = unknown();\n          err.serverResponse = xhr.getResponseText();\n          if (self.errorCallback_) {\n            reject(self.errorCallback_(xhr, err));\n          } else {\n            reject(err);\n          }\n        } else {\n          if (status.canceled) {\n            const err = self.appDelete_ ? appDeleted() : canceled();\n            reject(err);\n          } else {\n            const err = retryLimitExceeded();\n            reject(err);\n          }\n        }\n      }\n    }\n    if (this.canceled_) {\n      backoffDone(false, new RequestEndStatus(false, null, true));\n    } else {\n      this.backoffId_ = backoff.start(doTheRequest, backoffDone, this.timeout_);\n    }\n  }\n\n  /** @inheritDoc */\n  getPromise(): Promise<T> {\n    return this.promise_;\n  }\n\n  /** @inheritDoc */\n  cancel(appDelete?: boolean): void {\n    this.canceled_ = true;\n    this.appDelete_ = appDelete || false;\n    if (this.backoffId_ !== null) {\n      backoff.stop(this.backoffId_);\n    }\n    if (this.pendingXhr_ !== null) {\n      this.pendingXhr_.abort();\n    }\n  }\n\n  private isRetryStatusCode_(status: number): boolean {\n    // The codes for which to retry came from this page:\n    // https://cloud.google.com/storage/docs/exponential-backoff\n    const isFiveHundredCode = status >= 500 && status < 600;\n    const extraRetryCodes = [\n      // Request Timeout: web server didn't receive full request in time.\n      408,\n      // Too Many Requests: you're getting rate-limited, basically.\n      429\n    ];\n    const isExtraRetryCode = extraRetryCodes.indexOf(status) !== -1;\n    const isRequestSpecificRetryCode =\n      this.additionalRetryCodes_.indexOf(status) !== -1;\n    return isFiveHundredCode || isExtraRetryCode || isRequestSpecificRetryCode;\n  }\n}\n\n/**\n * A collection of information about the result of a network request.\n * @param opt_canceled - Defaults to false.\n */\nexport class RequestEndStatus {\n  /**\n   * True if the request was canceled.\n   */\n  canceled: boolean;\n\n  constructor(\n    public wasSuccessCode: boolean,\n    public xhr: XhrIo | null,\n    canceled?: boolean\n  ) {\n    this.canceled = !!canceled;\n  }\n}\n\nexport function addAuthHeader_(\n  headers: Headers,\n  authToken: string | null\n): void {\n  if (authToken !== null && authToken.length > 0) {\n    headers['Authorization'] = 'Firebase ' + authToken;\n  }\n}\n\nexport function addVersionHeader_(headers: Headers): void {\n  const version =\n    typeof firebase !== 'undefined' ? firebase.SDK_VERSION : 'AppManager';\n  headers['X-Firebase-Storage-Version'] = 'webjs/' + version;\n}\n\nexport function addGmpidHeader_(headers: Headers, appId: string | null): void {\n  if (appId) {\n    headers['X-Firebase-GMPID'] = appId;\n  }\n}\n\nexport function makeRequest<T>(\n  requestInfo: RequestInfo<T>,\n  appId: string | null,\n  authToken: string | null,\n  pool: XhrIoPool\n): Request<T> {\n  const queryPart = UrlUtils.makeQueryString(requestInfo.urlParams);\n  const url = requestInfo.url + queryPart;\n  const headers = Object.assign({}, requestInfo.headers);\n  addGmpidHeader_(headers, appId);\n  addAuthHeader_(headers, authToken);\n  addVersionHeader_(headers);\n  return new NetworkRequest<T>(\n    url,\n    requestInfo.method,\n    headers,\n    requestInfo.body,\n    requestInfo.successCodes,\n    requestInfo.additionalRetryCodes,\n    requestInfo.handler,\n    requestInfo.errorHandler,\n    requestInfo.timeout,\n    requestInfo.progressCallback,\n    pool\n  );\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides a method for running a function with exponential\n * backoff.\n */\ntype id = (p1: boolean) => void;\n\nexport { id };\n\n/**\n * @param f May be invoked\n *     before the function returns.\n * @param callback Get all the arguments passed to the function\n *     passed to f, including the initial boolean.\n */\nexport function start(\n  f: (p1: (success: boolean) => void, canceled: boolean) => void,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  callback: (...args: any[]) => unknown,\n  timeout: number\n): id {\n  // TODO(andysoto): make this code cleaner (probably refactor into an actual\n  // type instead of a bunch of functions with state shared in the closure)\n  let waitSeconds = 1;\n  // Would type this as \"number\" but that doesn't work for Node so ¯\\_(ツ)_/¯\n  // TODO: find a way to exclude Node type definition for storage because storage only works in browser\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  let timeoutId: any = null;\n  let hitTimeout = false;\n  let cancelState = 0;\n\n  function canceled(): boolean {\n    return cancelState === 2;\n  }\n  let triggeredCallback = false;\n\n  function triggerCallback(...args: any[]): void {\n    if (!triggeredCallback) {\n      triggeredCallback = true;\n      callback.apply(null, args);\n    }\n  }\n\n  function callWithDelay(millis: number): void {\n    timeoutId = setTimeout(() => {\n      timeoutId = null;\n      f(handler, canceled());\n    }, millis);\n  }\n\n  function handler(success: boolean, ...args: any[]): void {\n    if (triggeredCallback) {\n      return;\n    }\n    if (success) {\n      triggerCallback.call(null, success, ...args);\n      return;\n    }\n    const mustStop = canceled() || hitTimeout;\n    if (mustStop) {\n      triggerCallback.call(null, success, ...args);\n      return;\n    }\n    if (waitSeconds < 64) {\n      /* TODO(andysoto): don't back off so quickly if we know we're offline. */\n      waitSeconds *= 2;\n    }\n    let waitMillis;\n    if (cancelState === 1) {\n      cancelState = 2;\n      waitMillis = 0;\n    } else {\n      waitMillis = (waitSeconds + Math.random()) * 1000;\n    }\n    callWithDelay(waitMillis);\n  }\n  let stopped = false;\n\n  function stop(wasTimeout: boolean): void {\n    if (stopped) {\n      return;\n    }\n    stopped = true;\n    if (triggeredCallback) {\n      return;\n    }\n    if (timeoutId !== null) {\n      if (!wasTimeout) {\n        cancelState = 2;\n      }\n      clearTimeout(timeoutId);\n      callWithDelay(0);\n    } else {\n      if (!wasTimeout) {\n        cancelState = 1;\n      }\n    }\n  }\n  callWithDelay(0);\n  setTimeout(() => {\n    hitTimeout = true;\n    stop(true);\n  }, timeout);\n  return stop;\n}\n\n/**\n * Stops the retry loop from repeating.\n * If the function is currently \"in between\" retries, it is invoked immediately\n * with the second parameter as \"true\". Otherwise, it will be invoked once more\n * after the current invocation finishes iff the current invocation would have\n * triggered another retry.\n */\nexport function stop(id: id): void {\n  id(false);\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Location } from './implementation/location';\nimport { FailRequest } from './implementation/failrequest';\nimport { Request, makeRequest } from './implementation/request';\nimport { RequestInfo } from './implementation/requestinfo';\nimport { XhrIoPool } from './implementation/xhriopool';\nimport { Reference, getChild } from './reference';\nimport { Provider } from '@firebase/component';\nimport { FirebaseAuthInternalName } from '@firebase/auth-interop-types';\nimport {\n  FirebaseApp,\n  FirebaseOptions,\n  _FirebaseService\n} from '@firebase/app-types-exp';\nimport * as constants from '../src/implementation/constants';\nimport {\n  invalidArgument,\n  appDeleted,\n  noDefaultBucket\n} from './implementation/error';\nimport { validateNumber } from './implementation/type';\n\nexport function isUrl(path?: string): boolean {\n  return /^[A-Za-z]+:\\/\\//.test(path as string);\n}\n\n/**\n * Returns a firebaseStorage.Reference for the given url.\n */\nfunction refFromURL(service: StorageService, url: string): Reference {\n  return new Reference(service, url);\n}\n\n/**\n * Returns a firebaseStorage.Reference for the given path in the default\n * bucket.\n */\nfunction refFromPath(\n  ref: StorageService | Reference,\n  path?: string\n): Reference {\n  if (ref instanceof StorageService) {\n    const service = ref;\n    if (service._bucket == null) {\n      throw noDefaultBucket();\n    }\n    const reference = new Reference(service, service._bucket!);\n    if (path != null) {\n      return refFromPath(reference, path);\n    } else {\n      return reference;\n    }\n  } else {\n    // ref is a Reference\n    if (path !== undefined) {\n      if (path.includes('..')) {\n        throw invalidArgument('`path` param cannot contain \"..\"');\n      }\n      return getChild(ref, path);\n    } else {\n      return ref;\n    }\n  }\n}\n\n/**\n * Returns a storage Reference for the given url.\n * @param storage - `Storage` instance.\n * @param url - URL. If empty, returns root reference.\n * @public\n */\nexport function ref(storage: StorageService, url?: string): Reference;\n/**\n * Returns a storage Reference for the given path in the\n * default bucket.\n * @param storageOrRef - `Storage` service or storage `Reference`.\n * @param pathOrUrlStorage - path. If empty, returns root reference (if Storage\n * instance provided) or returns same reference (if Reference provided).\n * @public\n */\nexport function ref(\n  storageOrRef: StorageService | Reference,\n  path?: string\n): Reference;\nexport function ref(\n  serviceOrRef: StorageService | Reference,\n  pathOrUrl?: string\n): Reference | null {\n  if (pathOrUrl && isUrl(pathOrUrl)) {\n    if (serviceOrRef instanceof StorageService) {\n      return refFromURL(serviceOrRef, pathOrUrl);\n    } else {\n      throw invalidArgument(\n        'To use ref(service, url), the first argument must be a Storage instance.'\n      );\n    }\n  } else {\n    return refFromPath(serviceOrRef, pathOrUrl);\n  }\n}\n\nfunction extractBucket(config?: FirebaseOptions): Location | null {\n  const bucketString = config?.[constants.CONFIG_STORAGE_BUCKET_KEY];\n  if (bucketString == null) {\n    return null;\n  }\n  return Location.makeFromBucketSpec(bucketString);\n}\n\n/**\n * A service that provides Firebase Storage Reference instances.\n * @param opt_url - gs:// url to a custom Storage Bucket\n */\nexport class StorageService implements _FirebaseService {\n  /**\n   * @internal\n   */\n  readonly _bucket: Location | null = null;\n  protected readonly _appId: string | null = null;\n  private readonly _requests: Set<Request<unknown>>;\n  private _deleted: boolean = false;\n  private _maxOperationRetryTime: number;\n  private _maxUploadRetryTime: number;\n\n  constructor(\n    readonly app: FirebaseApp,\n    /**\n     * @internal\n     */\n    readonly _authProvider: Provider<FirebaseAuthInternalName>,\n    /**\n     * @internal\n     */\n    readonly _pool: XhrIoPool,\n    /**\n     * @internal\n     */\n    readonly _url?: string\n  ) {\n    this._maxOperationRetryTime = constants.DEFAULT_MAX_OPERATION_RETRY_TIME;\n    this._maxUploadRetryTime = constants.DEFAULT_MAX_UPLOAD_RETRY_TIME;\n    this._requests = new Set();\n    if (_url != null) {\n      this._bucket = Location.makeFromBucketSpec(_url);\n    } else {\n      this._bucket = extractBucket(this.app.options);\n    }\n  }\n\n  get maxUploadRetryTime(): number {\n    return this._maxUploadRetryTime;\n  }\n\n  set maxUploadRetryTime(time: number) {\n    validateNumber(\n      'time',\n      /* minValue=*/ 0,\n      /* maxValue= */ Number.POSITIVE_INFINITY,\n      time\n    );\n    this._maxUploadRetryTime = time;\n  }\n\n  get maxOperationRetryTime(): number {\n    return this._maxOperationRetryTime;\n  }\n\n  set maxOperationRetryTime(time: number) {\n    validateNumber(\n      'time',\n      /* minValue=*/ 0,\n      /* maxValue= */ Number.POSITIVE_INFINITY,\n      time\n    );\n    this._maxOperationRetryTime = time;\n  }\n\n  async getAuthToken(): Promise<string | null> {\n    const auth = this._authProvider.getImmediate({ optional: true });\n    if (auth) {\n      const tokenData = await auth.getToken();\n      if (tokenData !== null) {\n        return tokenData.accessToken;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Stop running requests and prevent more from being created.\n   * @internal\n   */\n  _delete(): Promise<void> {\n    this._deleted = true;\n    this._requests.forEach(request => request.cancel());\n    this._requests.clear();\n    return Promise.resolve();\n  }\n\n  /**\n   * Returns a new firebaseStorage.Reference object referencing this StorageService\n   * at the given Location.\n   */\n  makeStorageReference(loc: Location): Reference {\n    return new Reference(this, loc);\n  }\n\n  /**\n   * @internal\n   * @param requestInfo - HTTP RequestInfo object\n   * @param authToken - Firebase auth token\n   */\n  makeRequest<T>(\n    requestInfo: RequestInfo<T>,\n    authToken: string | null\n  ): Request<T> {\n    if (!this._deleted) {\n      const request = makeRequest(\n        requestInfo,\n        this._appId,\n        authToken,\n        this._pool\n      );\n      this._requests.add(request);\n      // Request removes itself from set when complete.\n      request.getPromise().then(\n        () => this._requests.delete(request),\n        () => this._requests.delete(request)\n      );\n      return request;\n    } else {\n      return new FailRequest(appDeleted());\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as types from '@firebase/storage-types';\nimport { StorageService, isUrl, ref } from '../src/service';\nimport { Location } from '../src/implementation/location';\nimport { ReferenceCompat } from './reference';\nimport { invalidArgument } from '../src/implementation/error';\nimport { FirebaseApp } from '@firebase/app-types';\n\n/**\n * A service that provides firebaseStorage.Reference instances.\n * @param opt_url gs:// url to a custom Storage Bucket\n */\nexport class StorageServiceCompat implements types.FirebaseStorage {\n  constructor(public app: FirebaseApp, readonly _delegate: StorageService) {}\n\n  INTERNAL = {\n    /**\n     * Called when the associated app is deleted.\n     */\n    delete: () => {\n      return this._delegate._delete();\n    }\n  };\n\n  get maxOperationRetryTime(): number {\n    return this._delegate.maxOperationRetryTime;\n  }\n\n  get maxUploadRetryTime(): number {\n    return this._delegate.maxUploadRetryTime;\n  }\n\n  /**\n   * Returns a firebaseStorage.Reference for the given path in the default\n   * bucket.\n   */\n  ref(path?: string): types.Reference {\n    if (isUrl(path)) {\n      throw invalidArgument(\n        'ref() expected a child path but got a URL, use refFromURL instead.'\n      );\n    }\n    return new ReferenceCompat(ref(this._delegate, path), this);\n  }\n\n  /**\n   * Returns a firebaseStorage.Reference object for the given absolute URL,\n   * which must be a gs:// or http[s]:// URL.\n   */\n  refFromURL(url: string): types.Reference {\n    if (!isUrl(url)) {\n      throw invalidArgument(\n        'refFromURL() expected a full URL but got a child path, use ref() instead.'\n      );\n    }\n    try {\n      Location.makeFromUrl(url);\n    } catch (e) {\n      throw invalidArgument(\n        'refFromUrl() expected a valid full URL but got an invalid one.'\n      );\n    }\n    return new ReferenceCompat(ref(this._delegate, url), this);\n  }\n\n  setMaxUploadRetryTime(time: number): void {\n    this._delegate.maxUploadRetryTime = time;\n  }\n\n  setMaxOperationRetryTime(time: number): void {\n    this._delegate.maxOperationRetryTime = time;\n  }\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from '@firebase/app';\nimport { _FirebaseNamespace } from '@firebase/app-types/private';\nimport { StringFormat } from '../src/implementation/string';\nimport { TaskEvent, TaskState } from '../src/implementation/taskenums';\n\nimport { XhrIoPool } from '../src/implementation/xhriopool';\nimport { ReferenceCompat } from './reference';\nimport { StorageServiceCompat } from './service';\nimport { StorageService } from '../src/service';\nimport * as types from '@firebase/storage-types';\nimport {\n  Component,\n  ComponentType,\n  ComponentContainer\n} from '@firebase/component';\n\nimport { name, version } from '../package.json';\n\n/**\n * Type constant for Firebase Storage.\n */\nconst STORAGE_TYPE = 'storage';\n\nfunction factory(\n  container: ComponentContainer,\n  url?: string\n): types.FirebaseStorage {\n  // Dependencies\n  // TODO: This should eventually be 'app-compat'\n  const app = container.getProvider('app').getImmediate();\n  const authProvider = container.getProvider('auth-internal');\n\n  // TODO: get StorageService instance from component framework instead\n  // of creating a new one.\n  const storageServiceCompat: StorageServiceCompat = new StorageServiceCompat(\n    app,\n    new StorageService(app, authProvider, new XhrIoPool(), url)\n  );\n  return storageServiceCompat;\n}\n\nexport function registerStorage(instance: _FirebaseNamespace): void {\n  const namespaceExports = {\n    // no-inline\n    TaskState,\n    TaskEvent,\n    StringFormat,\n    Storage: StorageService,\n    Reference: ReferenceCompat\n  };\n  instance.INTERNAL.registerComponent(\n    new Component(STORAGE_TYPE, factory, ComponentType.PUBLIC)\n      .setServiceProps(namespaceExports)\n      .setMultipleInstances(true)\n  );\n\n  instance.registerVersion(name, version);\n}\n\nregisterStorage(firebase as _FirebaseNamespace);\n\n/**\n * Define extension behavior for `registerStorage`\n */\ndeclare module '@firebase/app-types' {\n  interface FirebaseNamespace {\n    storage?: {\n      (app?: FirebaseApp): types.FirebaseStorage;\n      Storage: typeof types.FirebaseStorage;\n\n      StringFormat: {\n        BASE64: types.StringFormat;\n        BASE64URL: types.StringFormat;\n        DATA_URL: types.StringFormat;\n        RAW: types.StringFormat;\n      };\n      TaskEvent: {\n        STATE_CHANGED: types.TaskEvent;\n      };\n      TaskState: {\n        CANCELED: types.TaskState;\n        ERROR: types.TaskState;\n        PAUSED: types.TaskState;\n        RUNNING: types.TaskState;\n        SUCCESS: types.TaskState;\n      };\n    };\n  }\n  interface FirebaseApp {\n    storage?(storageBucket?: string): types.FirebaseStorage;\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  InstantiationMode,\n  InstanceFactory,\n  ComponentType,\n  Dictionary,\n  Name\n} from './types';\n\n/**\n * Component for service name T, e.g. `auth`, `auth-internal`\n */\nexport class Component<T extends Name = Name> {\n  multipleInstances = false;\n  /**\n   * Properties to be added to the service namespace\n   */\n  serviceProps: Dictionary = {};\n\n  instantiationMode = InstantiationMode.LAZY;\n\n  /**\n   *\n   * @param name The public service name, e.g. app, auth, firestore, database\n   * @param instanceFactory Service factory responsible for creating the public interface\n   * @param type whether the service provided by the component is public or private\n   */\n  constructor(\n    readonly name: T,\n    readonly instanceFactory: InstanceFactory<T>,\n    readonly type: ComponentType\n  ) {}\n\n  setInstantiationMode(mode: InstantiationMode): this {\n    this.instantiationMode = mode;\n    return this;\n  }\n\n  setMultipleInstances(multipleInstances: boolean): this {\n    this.multipleInstances = multipleInstances;\n    return this;\n  }\n\n  setServiceProps(props: Dictionary): this {\n    this.serviceProps = props;\n    return this;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Deferred } from '@firebase/util';\nimport { ComponentContainer } from './component_container';\nimport { DEFAULT_ENTRY_NAME } from './constants';\nimport { InstantiationMode, Name, NameServiceMapping } from './types';\nimport { Component } from './component';\n\n/**\n * Provider for instance for service name T, e.g. 'auth', 'auth-internal'\n * NameServiceMapping[T] is an alias for the type of the instance\n */\nexport class Provider<T extends Name> {\n  private component: Component<T> | null = null;\n  private readonly instances: Map<string, NameServiceMapping[T]> = new Map();\n  private readonly instancesDeferred: Map<\n    string,\n    Deferred<NameServiceMapping[T]>\n  > = new Map();\n\n  constructor(\n    private readonly name: T,\n    private readonly container: ComponentContainer\n  ) {}\n\n  /**\n   * @param identifier A provider can provide mulitple instances of a service\n   * if this.component.multipleInstances is true.\n   */\n  get(identifier: string = DEFAULT_ENTRY_NAME): Promise<NameServiceMapping[T]> {\n    // if multipleInstances is not supported, use the default name\n    const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\n\n    if (!this.instancesDeferred.has(normalizedIdentifier)) {\n      const deferred = new Deferred<NameServiceMapping[T]>();\n      this.instancesDeferred.set(normalizedIdentifier, deferred);\n      // If the service instance is available, resolve the promise with it immediately\n      try {\n        const instance = this.getOrInitializeService(normalizedIdentifier);\n        if (instance) {\n          deferred.resolve(instance);\n        }\n      } catch (e) {\n        // when the instance factory throws an exception during get(), it should not cause\n        // a fatal error. We just return the unresolved promise in this case.\n      }\n    }\n\n    return this.instancesDeferred.get(normalizedIdentifier)!.promise;\n  }\n\n  /**\n   *\n   * @param options.identifier A provider can provide mulitple instances of a service\n   * if this.component.multipleInstances is true.\n   * @param options.optional If optional is false or not provided, the method throws an error when\n   * the service is not immediately available.\n   * If optional is true, the method returns null if the service is not immediately available.\n   */\n  getImmediate(options: {\n    identifier?: string;\n    optional: true;\n  }): NameServiceMapping[T] | null;\n  getImmediate(options?: {\n    identifier?: string;\n    optional?: false;\n  }): NameServiceMapping[T];\n  getImmediate(options?: {\n    identifier?: string;\n    optional?: boolean;\n  }): NameServiceMapping[T] | null {\n    const { identifier, optional } = {\n      identifier: DEFAULT_ENTRY_NAME,\n      optional: false,\n      ...options\n    };\n    // if multipleInstances is not supported, use the default name\n    const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\n    try {\n      const instance = this.getOrInitializeService(normalizedIdentifier);\n\n      if (!instance) {\n        if (optional) {\n          return null;\n        }\n        throw Error(`Service ${this.name} is not available`);\n      }\n      return instance;\n    } catch (e) {\n      if (optional) {\n        return null;\n      } else {\n        throw e;\n      }\n    }\n  }\n\n  getComponent(): Component<T> | null {\n    return this.component;\n  }\n\n  setComponent(component: Component<T>): void {\n    if (component.name !== this.name) {\n      throw Error(\n        `Mismatching Component ${component.name} for Provider ${this.name}.`\n      );\n    }\n\n    if (this.component) {\n      throw Error(`Component for ${this.name} has already been provided`);\n    }\n\n    this.component = component;\n    // if the service is eager, initialize the default instance\n    if (isComponentEager(component)) {\n      try {\n        this.getOrInitializeService(DEFAULT_ENTRY_NAME);\n      } catch (e) {\n        // when the instance factory for an eager Component throws an exception during the eager\n        // initialization, it should not cause a fatal error.\n        // TODO: Investigate if we need to make it configurable, because some component may want to cause\n        // a fatal error in this case?\n      }\n    }\n\n    // Create service instances for the pending promises and resolve them\n    // NOTE: if this.multipleInstances is false, only the default instance will be created\n    // and all promises with resolve with it regardless of the identifier.\n    for (const [\n      instanceIdentifier,\n      instanceDeferred\n    ] of this.instancesDeferred.entries()) {\n      const normalizedIdentifier = this.normalizeInstanceIdentifier(\n        instanceIdentifier\n      );\n\n      try {\n        // `getOrInitializeService()` should always return a valid instance since a component is guaranteed. use ! to make typescript happy.\n        const instance = this.getOrInitializeService(normalizedIdentifier)!;\n        instanceDeferred.resolve(instance);\n      } catch (e) {\n        // when the instance factory throws an exception, it should not cause\n        // a fatal error. We just leave the promise unresolved.\n      }\n    }\n  }\n\n  clearInstance(identifier: string = DEFAULT_ENTRY_NAME): void {\n    this.instancesDeferred.delete(identifier);\n    this.instances.delete(identifier);\n  }\n\n  // app.delete() will call this method on every provider to delete the services\n  // TODO: should we mark the provider as deleted?\n  async delete(): Promise<void> {\n    const services = Array.from(this.instances.values());\n\n    await Promise.all([\n      ...services\n        .filter(service => 'INTERNAL' in service) // legacy services\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        .map(service => (service as any).INTERNAL!.delete()),\n      ...services\n        .filter(service => '_delete' in service) // modularized services\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        .map(service => (service as any)._delete())\n    ]);\n  }\n\n  isComponentSet(): boolean {\n    return this.component != null;\n  }\n\n  private getOrInitializeService(\n    identifier: string\n  ): NameServiceMapping[T] | null {\n    let instance = this.instances.get(identifier);\n    if (!instance && this.component) {\n      instance = this.component.instanceFactory(\n        this.container,\n        normalizeIdentifierForFactory(identifier)\n      ) as NameServiceMapping[T];\n      this.instances.set(identifier, instance);\n    }\n\n    return instance || null;\n  }\n\n  private normalizeInstanceIdentifier(identifier: string): string {\n    if (this.component) {\n      return this.component.multipleInstances ? identifier : DEFAULT_ENTRY_NAME;\n    } else {\n      return identifier; // assume multiple instances are supported before the component is provided.\n    }\n  }\n}\n\n// undefined should be passed to the service factory for the default instance\nfunction normalizeIdentifierForFactory(identifier: string): string | undefined {\n  return identifier === DEFAULT_ENTRY_NAME ? undefined : identifier;\n}\n\nfunction isComponentEager(component: Component<Name>): boolean {\n  return component.instantiationMode === InstantiationMode.EAGER;\n}\n","/**\n * @license\n * Copyright 2019 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Provider } from './provider';\nimport { Component } from './component';\nimport { Name } from './types';\n\n/**\n * ComponentContainer that provides Providers for service name T, e.g. `auth`, `auth-internal`\n */\nexport class ComponentContainer {\n  private readonly providers = new Map<string, Provider<Name>>();\n\n  constructor(private readonly name: string) {}\n\n  /**\n   *\n   * @param component Component being added\n   * @param overwrite When a component with the same name has already been registered,\n   * if overwrite is true: overwrite the existing component with the new component and create a new\n   * provider with the new component. It can be useful in tests where you want to use different mocks\n   * for different tests.\n   * if overwrite is false: throw an exception\n   */\n  addComponent<T extends Name>(component: Component<T>): void {\n    const provider = this.getProvider(component.name);\n    if (provider.isComponentSet()) {\n      throw new Error(\n        `Component ${component.name} has already been registered with ${this.name}`\n      );\n    }\n\n    provider.setComponent(component);\n  }\n\n  addOrOverwriteComponent<T extends Name>(component: Component<T>): void {\n    const provider = this.getProvider(component.name);\n    if (provider.isComponentSet()) {\n      // delete the existing provider from the container, so we can register the new component\n      this.providers.delete(component.name);\n    }\n\n    this.addComponent(component);\n  }\n\n  /**\n   * getProvider provides a type safe interface where it can only be called with a field name\n   * present in NameServiceMapping interface.\n   *\n   * Firebase SDKs providing services should extend NameServiceMapping interface to register\n   * themselves.\n   */\n  getProvider<T extends Name>(name: T): Provider<T> {\n    if (this.providers.has(name)) {\n      return this.providers.get(name) as Provider<T>;\n    }\n\n    // create a Provider for a service that hasn't registered with Firebase\n    const provider = new Provider<T>(name, this);\n    this.providers.set(name, provider);\n\n    return provider as Provider<T>;\n  }\n\n  getProviders(): Array<Provider<Name>> {\n    return Array.from(this.providers.values());\n  }\n}\n","import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\n// A grid component using the following libs as inspiration.\n//\n// For the implementation:\n// - https://getbootstrap.com/docs/4.3/layout/grid/\n// - https://github.com/kristoferjoseph/flexboxgrid/blob/master/src/css/flexboxgrid.css\n// - https://github.com/roylee0704/react-flexbox-grid\n// - https://material.angularjs.org/latest/layout/introduction\n//\n// Follow this flexbox Guide to better understand the underlying model:\n// - https://css-tricks.com/snippets/css/a-guide-to-flexbox/\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport requirePropFactory from '../utils/requirePropFactory';\nvar SPACINGS = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\nvar GRID_SIZES = ['auto', true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n\nfunction generateGrid(globalStyles, theme, breakpoint) {\n  var styles = {};\n  GRID_SIZES.forEach(function (size) {\n    var key = \"grid-\".concat(breakpoint, \"-\").concat(size);\n\n    if (size === true) {\n      // For the auto layouting\n      styles[key] = {\n        flexBasis: 0,\n        flexGrow: 1,\n        maxWidth: '100%'\n      };\n      return;\n    }\n\n    if (size === 'auto') {\n      styles[key] = {\n        flexBasis: 'auto',\n        flexGrow: 0,\n        maxWidth: 'none'\n      };\n      return;\n    } // Keep 7 significant numbers.\n\n\n    var width = \"\".concat(Math.round(size / 12 * 10e7) / 10e5, \"%\"); // Close to the bootstrap implementation:\n    // https://github.com/twbs/bootstrap/blob/8fccaa2439e97ec72a4b7dc42ccc1f649790adb0/scss/mixins/_grid.scss#L41\n\n    styles[key] = {\n      flexBasis: width,\n      flexGrow: 0,\n      maxWidth: width\n    };\n  }); // No need for a media query for the first size.\n\n  if (breakpoint === 'xs') {\n    _extends(globalStyles, styles);\n  } else {\n    globalStyles[theme.breakpoints.up(breakpoint)] = styles;\n  }\n}\n\nfunction getOffset(val) {\n  var div = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  var parse = parseFloat(val);\n  return \"\".concat(parse / div).concat(String(val).replace(String(parse), '') || 'px');\n}\n\nfunction generateGutter(theme, breakpoint) {\n  var styles = {};\n  SPACINGS.forEach(function (spacing) {\n    var themeSpacing = theme.spacing(spacing);\n\n    if (themeSpacing === 0) {\n      return;\n    }\n\n    styles[\"spacing-\".concat(breakpoint, \"-\").concat(spacing)] = {\n      margin: \"-\".concat(getOffset(themeSpacing, 2)),\n      width: \"calc(100% + \".concat(getOffset(themeSpacing), \")\"),\n      '& > $item': {\n        padding: getOffset(themeSpacing, 2)\n      }\n    };\n  });\n  return styles;\n} // Default CSS values\n// flex: '0 1 auto',\n// flexDirection: 'row',\n// alignItems: 'flex-start',\n// flexWrap: 'nowrap',\n// justifyContent: 'flex-start',\n\n\nexport var styles = function styles(theme) {\n  return _extends(_extends({\n    /* Styles applied to the root element. */\n    root: {},\n\n    /* Styles applied to the root element if `container={true}`. */\n    container: {\n      boxSizing: 'border-box',\n      display: 'flex',\n      flexWrap: 'wrap',\n      width: '100%'\n    },\n\n    /* Styles applied to the root element if `item={true}`. */\n    item: {\n      boxSizing: 'border-box',\n      margin: '0' // For instance, it's useful when used with a `figure` element.\n\n    },\n\n    /* Styles applied to the root element if `zeroMinWidth={true}`. */\n    zeroMinWidth: {\n      minWidth: 0\n    },\n\n    /* Styles applied to the root element if `direction=\"column\"`. */\n    'direction-xs-column': {\n      flexDirection: 'column'\n    },\n\n    /* Styles applied to the root element if `direction=\"column-reverse\"`. */\n    'direction-xs-column-reverse': {\n      flexDirection: 'column-reverse'\n    },\n\n    /* Styles applied to the root element if `direction=\"row-reverse\"`. */\n    'direction-xs-row-reverse': {\n      flexDirection: 'row-reverse'\n    },\n\n    /* Styles applied to the root element if `wrap=\"nowrap\"`. */\n    'wrap-xs-nowrap': {\n      flexWrap: 'nowrap'\n    },\n\n    /* Styles applied to the root element if `wrap=\"reverse\"`. */\n    'wrap-xs-wrap-reverse': {\n      flexWrap: 'wrap-reverse'\n    },\n\n    /* Styles applied to the root element if `alignItems=\"center\"`. */\n    'align-items-xs-center': {\n      alignItems: 'center'\n    },\n\n    /* Styles applied to the root element if `alignItems=\"flex-start\"`. */\n    'align-items-xs-flex-start': {\n      alignItems: 'flex-start'\n    },\n\n    /* Styles applied to the root element if `alignItems=\"flex-end\"`. */\n    'align-items-xs-flex-end': {\n      alignItems: 'flex-end'\n    },\n\n    /* Styles applied to the root element if `alignItems=\"baseline\"`. */\n    'align-items-xs-baseline': {\n      alignItems: 'baseline'\n    },\n\n    /* Styles applied to the root element if `alignContent=\"center\"`. */\n    'align-content-xs-center': {\n      alignContent: 'center'\n    },\n\n    /* Styles applied to the root element if `alignContent=\"flex-start\"`. */\n    'align-content-xs-flex-start': {\n      alignContent: 'flex-start'\n    },\n\n    /* Styles applied to the root element if `alignContent=\"flex-end\"`. */\n    'align-content-xs-flex-end': {\n      alignContent: 'flex-end'\n    },\n\n    /* Styles applied to the root element if `alignContent=\"space-between\"`. */\n    'align-content-xs-space-between': {\n      alignContent: 'space-between'\n    },\n\n    /* Styles applied to the root element if `alignContent=\"space-around\"`. */\n    'align-content-xs-space-around': {\n      alignContent: 'space-around'\n    },\n\n    /* Styles applied to the root element if `justify=\"center\"`. */\n    'justify-xs-center': {\n      justifyContent: 'center'\n    },\n\n    /* Styles applied to the root element if `justify=\"flex-end\"`. */\n    'justify-xs-flex-end': {\n      justifyContent: 'flex-end'\n    },\n\n    /* Styles applied to the root element if `justify=\"space-between\"`. */\n    'justify-xs-space-between': {\n      justifyContent: 'space-between'\n    },\n\n    /* Styles applied to the root element if `justify=\"space-around\"`. */\n    'justify-xs-space-around': {\n      justifyContent: 'space-around'\n    },\n\n    /* Styles applied to the root element if `justify=\"space-evenly\"`. */\n    'justify-xs-space-evenly': {\n      justifyContent: 'space-evenly'\n    }\n  }, generateGutter(theme, 'xs')), theme.breakpoints.keys.reduce(function (accumulator, key) {\n    // Use side effect over immutability for better performance.\n    generateGrid(accumulator, theme, key);\n    return accumulator;\n  }, {}));\n};\nvar Grid = React.forwardRef(function Grid(props, ref) {\n  var _props$alignContent = props.alignContent,\n      alignContent = _props$alignContent === void 0 ? 'stretch' : _props$alignContent,\n      _props$alignItems = props.alignItems,\n      alignItems = _props$alignItems === void 0 ? 'stretch' : _props$alignItems,\n      classes = props.classes,\n      classNameProp = props.className,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'div' : _props$component,\n      _props$container = props.container,\n      container = _props$container === void 0 ? false : _props$container,\n      _props$direction = props.direction,\n      direction = _props$direction === void 0 ? 'row' : _props$direction,\n      _props$item = props.item,\n      item = _props$item === void 0 ? false : _props$item,\n      _props$justify = props.justify,\n      justify = _props$justify === void 0 ? 'flex-start' : _props$justify,\n      _props$lg = props.lg,\n      lg = _props$lg === void 0 ? false : _props$lg,\n      _props$md = props.md,\n      md = _props$md === void 0 ? false : _props$md,\n      _props$sm = props.sm,\n      sm = _props$sm === void 0 ? false : _props$sm,\n      _props$spacing = props.spacing,\n      spacing = _props$spacing === void 0 ? 0 : _props$spacing,\n      _props$wrap = props.wrap,\n      wrap = _props$wrap === void 0 ? 'wrap' : _props$wrap,\n      _props$xl = props.xl,\n      xl = _props$xl === void 0 ? false : _props$xl,\n      _props$xs = props.xs,\n      xs = _props$xs === void 0 ? false : _props$xs,\n      _props$zeroMinWidth = props.zeroMinWidth,\n      zeroMinWidth = _props$zeroMinWidth === void 0 ? false : _props$zeroMinWidth,\n      other = _objectWithoutProperties(props, [\"alignContent\", \"alignItems\", \"classes\", \"className\", \"component\", \"container\", \"direction\", \"item\", \"justify\", \"lg\", \"md\", \"sm\", \"spacing\", \"wrap\", \"xl\", \"xs\", \"zeroMinWidth\"]);\n\n  var className = clsx(classes.root, classNameProp, container && [classes.container, spacing !== 0 && classes[\"spacing-xs-\".concat(String(spacing))]], item && classes.item, zeroMinWidth && classes.zeroMinWidth, direction !== 'row' && classes[\"direction-xs-\".concat(String(direction))], wrap !== 'wrap' && classes[\"wrap-xs-\".concat(String(wrap))], alignItems !== 'stretch' && classes[\"align-items-xs-\".concat(String(alignItems))], alignContent !== 'stretch' && classes[\"align-content-xs-\".concat(String(alignContent))], justify !== 'flex-start' && classes[\"justify-xs-\".concat(String(justify))], xs !== false && classes[\"grid-xs-\".concat(String(xs))], sm !== false && classes[\"grid-sm-\".concat(String(sm))], md !== false && classes[\"grid-md-\".concat(String(md))], lg !== false && classes[\"grid-lg-\".concat(String(lg))], xl !== false && classes[\"grid-xl-\".concat(String(xl))]);\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    className: className,\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? Grid.propTypes = {\n  /**\n   * Defines the `align-content` style property.\n   * It's applied for all screen sizes.\n   */\n  alignContent: PropTypes.oneOf(['stretch', 'center', 'flex-start', 'flex-end', 'space-between', 'space-around']),\n\n  /**\n   * Defines the `align-items` style property.\n   * It's applied for all screen sizes.\n   */\n  alignItems: PropTypes.oneOf(['flex-start', 'center', 'flex-end', 'stretch', 'baseline']),\n\n  /**\n   * The content of the component.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object.isRequired,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * The component used for the root node.\n   * Either a string to use a HTML element or a component.\n   */\n  component: PropTypes.elementType,\n\n  /**\n   * If `true`, the component will have the flex *container* behavior.\n   * You should be wrapping *items* with a *container*.\n   */\n  container: PropTypes.bool,\n\n  /**\n   * Defines the `flex-direction` style property.\n   * It is applied for all screen sizes.\n   */\n  direction: PropTypes.oneOf(['row', 'row-reverse', 'column', 'column-reverse']),\n\n  /**\n   * If `true`, the component will have the flex *item* behavior.\n   * You should be wrapping *items* with a *container*.\n   */\n  item: PropTypes.bool,\n\n  /**\n   * Defines the `justify-content` style property.\n   * It is applied for all screen sizes.\n   */\n  justify: PropTypes.oneOf(['flex-start', 'center', 'flex-end', 'space-between', 'space-around', 'space-evenly']),\n\n  /**\n   * Defines the number of grids the component is going to use.\n   * It's applied for the `lg` breakpoint and wider screens if not overridden.\n   */\n  lg: PropTypes.oneOf([false, 'auto', true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),\n\n  /**\n   * Defines the number of grids the component is going to use.\n   * It's applied for the `md` breakpoint and wider screens if not overridden.\n   */\n  md: PropTypes.oneOf([false, 'auto', true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),\n\n  /**\n   * Defines the number of grids the component is going to use.\n   * It's applied for the `sm` breakpoint and wider screens if not overridden.\n   */\n  sm: PropTypes.oneOf([false, 'auto', true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),\n\n  /**\n   * Defines the space between the type `item` component.\n   * It can only be used on a type `container` component.\n   */\n  spacing: PropTypes.oneOf(SPACINGS),\n\n  /**\n   * Defines the `flex-wrap` style property.\n   * It's applied for all screen sizes.\n   */\n  wrap: PropTypes.oneOf(['nowrap', 'wrap', 'wrap-reverse']),\n\n  /**\n   * Defines the number of grids the component is going to use.\n   * It's applied for the `xl` breakpoint and wider screens.\n   */\n  xl: PropTypes.oneOf([false, 'auto', true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),\n\n  /**\n   * Defines the number of grids the component is going to use.\n   * It's applied for all the screen sizes with the lowest priority.\n   */\n  xs: PropTypes.oneOf([false, 'auto', true, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]),\n\n  /**\n   * If `true`, it sets `min-width: 0` on the item.\n   * Refer to the limitations section of the documentation to better understand the use case.\n   */\n  zeroMinWidth: PropTypes.bool\n} : void 0;\nvar StyledGrid = withStyles(styles, {\n  name: 'MuiGrid'\n})(Grid);\n\nif (process.env.NODE_ENV !== 'production') {\n  var requireProp = requirePropFactory('Grid');\n  StyledGrid.propTypes = _extends(_extends({}, StyledGrid.propTypes), {}, {\n    alignContent: requireProp('container'),\n    alignItems: requireProp('container'),\n    direction: requireProp('container'),\n    justify: requireProp('container'),\n    lg: requireProp('item'),\n    md: requireProp('item'),\n    sm: requireProp('item'),\n    spacing: requireProp('container'),\n    wrap: requireProp('container'),\n    xs: requireProp('item'),\n    zeroMinWidth: requireProp('item')\n  });\n}\n\nexport default StyledGrid;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nrequire('./index.css');\n\nvar _reactFlipMove = require('react-flip-move');\n\nvar _reactFlipMove2 = _interopRequireDefault(_reactFlipMove);\n\nvar _UploadIcon = require('./UploadIcon.svg');\n\nvar _UploadIcon2 = _interopRequireDefault(_UploadIcon);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar styles = {\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  flexWrap: \"wrap\",\n  width: \"100%\"\n};\n\nvar ERROR = {\n  NOT_SUPPORTED_EXTENSION: 'NOT_SUPPORTED_EXTENSION',\n  FILESIZE_TOO_LARGE: 'FILESIZE_TOO_LARGE'\n};\n\nvar ReactImageUploadComponent = function (_React$Component) {\n  _inherits(ReactImageUploadComponent, _React$Component);\n\n  function ReactImageUploadComponent(props) {\n    _classCallCheck(this, ReactImageUploadComponent);\n\n    var _this = _possibleConstructorReturn(this, (ReactImageUploadComponent.__proto__ || Object.getPrototypeOf(ReactImageUploadComponent)).call(this, props));\n\n    _this.state = {\n      pictures: [].concat(_toConsumableArray(props.defaultImages)),\n      files: [],\n      fileErrors: []\n    };\n    _this.inputElement = '';\n    _this.onDropFile = _this.onDropFile.bind(_this);\n    _this.onUploadClick = _this.onUploadClick.bind(_this);\n    _this.triggerFileUpload = _this.triggerFileUpload.bind(_this);\n    return _this;\n  }\n\n  _createClass(ReactImageUploadComponent, [{\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      if (prevState.files !== this.state.files) {\n        this.props.onChange(this.state.files, this.state.pictures);\n      }\n    }\n\n    /*\n     Load image at the beggining if defaultImage prop exists\n     */\n\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.defaultImages !== this.props.defaultImages) {\n        this.setState({ pictures: nextProps.defaultImages });\n      }\n    }\n\n    /*\n    Check file extension (onDropFile)\n    */\n\n  }, {\n    key: 'hasExtension',\n    value: function hasExtension(fileName) {\n      var pattern = '(' + this.props.imgExtension.join('|').replace(/\\./g, '\\\\.') + ')$';\n      return new RegExp(pattern, 'i').test(fileName);\n    }\n\n    /*\n     Handle file validation\n     */\n\n  }, {\n    key: 'onDropFile',\n    value: function onDropFile(e) {\n      var _this2 = this;\n\n      var files = e.target.files;\n      var allFilePromises = [];\n      var fileErrors = [];\n\n      // Iterate over all uploaded files\n      for (var i = 0; i < files.length; i++) {\n        var file = files[i];\n        var fileError = {\n          name: file.name\n        };\n        // Check for file extension\n        if (!this.hasExtension(file.name)) {\n          fileError = Object.assign(fileError, {\n            type: ERROR.NOT_SUPPORTED_EXTENSION\n          });\n          fileErrors.push(fileError);\n          continue;\n        }\n        // Check for file size\n        if (file.size > this.props.maxFileSize) {\n          fileError = Object.assign(fileError, {\n            type: ERROR.FILESIZE_TOO_LARGE\n          });\n          fileErrors.push(fileError);\n          continue;\n        }\n\n        allFilePromises.push(this.readFile(file));\n      }\n\n      this.setState({\n        fileErrors: fileErrors\n      });\n\n      var singleImage = this.props.singleImage;\n\n\n      Promise.all(allFilePromises).then(function (newFilesData) {\n        var dataURLs = singleImage ? [] : _this2.state.pictures.slice();\n        var files = singleImage ? [] : _this2.state.files.slice();\n\n        newFilesData.forEach(function (newFileData) {\n          dataURLs.push(newFileData.dataURL);\n          files.push(newFileData.file);\n        });\n\n        _this2.setState({ pictures: dataURLs, files: files });\n      });\n    }\n  }, {\n    key: 'onUploadClick',\n    value: function onUploadClick(e) {\n      // Fixes https://github.com/JakeHartnell/react-images-upload/issues/55\n      e.target.value = null;\n    }\n\n    /*\n       Read a file and return a promise that when resolved gives the file itself and the data URL\n     */\n\n  }, {\n    key: 'readFile',\n    value: function readFile(file) {\n      return new Promise(function (resolve, reject) {\n        var reader = new FileReader();\n\n        // Read the image via FileReader API and save image result in state.\n        reader.onload = function (e) {\n          // Add the file name to the data URL\n          var dataURL = e.target.result;\n          dataURL = dataURL.replace(\";base64\", ';name=' + file.name + ';base64');\n          resolve({ file: file, dataURL: dataURL });\n        };\n\n        reader.readAsDataURL(file);\n      });\n    }\n\n    /*\n     Remove the image from state\n     */\n\n  }, {\n    key: 'removeImage',\n    value: function removeImage(picture) {\n      var _this3 = this;\n\n      var removeIndex = this.state.pictures.findIndex(function (e) {\n        return e === picture;\n      });\n      var filteredPictures = this.state.pictures.filter(function (e, index) {\n        return index !== removeIndex;\n      });\n      var filteredFiles = this.state.files.filter(function (e, index) {\n        return index !== removeIndex;\n      });\n\n      this.setState({ pictures: filteredPictures, files: filteredFiles }, function () {\n        _this3.props.onChange(_this3.state.files, _this3.state.pictures);\n      });\n    }\n\n    /*\n     Check if any errors && render\n     */\n\n  }, {\n    key: 'renderErrors',\n    value: function renderErrors() {\n      var _this4 = this;\n\n      var fileErrors = this.state.fileErrors;\n\n      return fileErrors.map(function (fileError, index) {\n        return _react2.default.createElement(\n          'div',\n          { className: 'errorMessage ' + _this4.props.errorClass, key: index, style: _this4.props.errorStyle },\n          '* ',\n          fileError.name,\n          ' ',\n          fileError.type === ERROR.FILESIZE_TOO_LARGE ? _this4.props.fileSizeError : _this4.props.fileTypeError\n        );\n      });\n    }\n\n    /*\n     Render the upload icon\n     */\n\n  }, {\n    key: 'renderIcon',\n    value: function renderIcon() {\n      if (this.props.withIcon) {\n        return _react2.default.createElement('img', { src: _UploadIcon2.default, className: 'uploadIcon', alt: 'Upload Icon' });\n      }\n    }\n\n    /*\n     Render label\n     */\n\n  }, {\n    key: 'renderLabel',\n    value: function renderLabel() {\n      if (this.props.withLabel) {\n        return _react2.default.createElement(\n          'p',\n          { className: this.props.labelClass, style: this.props.labelStyles },\n          this.props.label\n        );\n      }\n    }\n\n    /*\n     Render preview images\n     */\n\n  }, {\n    key: 'renderPreview',\n    value: function renderPreview() {\n      return _react2.default.createElement(\n        'div',\n        { className: 'uploadPicturesWrapper' },\n        _react2.default.createElement(\n          _reactFlipMove2.default,\n          { enterAnimation: 'fade', leaveAnimation: 'fade', style: styles },\n          this.renderPreviewPictures()\n        )\n      );\n    }\n  }, {\n    key: 'renderPreviewPictures',\n    value: function renderPreviewPictures() {\n      var _this5 = this;\n\n      return this.state.pictures.map(function (picture, index) {\n        return _react2.default.createElement(\n          'div',\n          { key: index, className: 'uploadPictureContainer' },\n          _react2.default.createElement(\n            'div',\n            { className: 'deleteImage', onClick: function onClick() {\n                return _this5.removeImage(picture);\n              } },\n            'X'\n          ),\n          _react2.default.createElement('img', { src: picture, className: 'uploadPicture', alt: 'preview' })\n        );\n      });\n    }\n\n    /*\n     On button click, trigger input file to open\n     */\n\n  }, {\n    key: 'triggerFileUpload',\n    value: function triggerFileUpload() {\n      this.inputElement.click();\n    }\n  }, {\n    key: 'clearPictures',\n    value: function clearPictures() {\n      this.setState({ pictures: [] });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this6 = this;\n\n      return _react2.default.createElement(\n        'div',\n        { className: \"fileUploader \" + this.props.className, style: this.props.style },\n        _react2.default.createElement(\n          'div',\n          { className: 'fileContainer', style: this.props.fileContainerStyle },\n          this.renderIcon(),\n          this.renderLabel(),\n          _react2.default.createElement(\n            'div',\n            { className: 'errorsContainer' },\n            this.renderErrors()\n          ),\n          _react2.default.createElement(\n            'button',\n            {\n              type: this.props.buttonType,\n              className: \"chooseFileButton \" + this.props.buttonClassName,\n              style: this.props.buttonStyles,\n              onClick: this.triggerFileUpload\n            },\n            this.props.buttonText\n          ),\n          _react2.default.createElement('input', {\n            type: 'file',\n            ref: function ref(input) {\n              return _this6.inputElement = input;\n            },\n            name: this.props.name,\n            multiple: !this.props.singleImage,\n            onChange: this.onDropFile,\n            onClick: this.onUploadClick,\n            accept: this.props.accept\n          }),\n          this.props.withPreview ? this.renderPreview() : null\n        )\n      );\n    }\n  }]);\n\n  return ReactImageUploadComponent;\n}(_react2.default.Component);\n\nReactImageUploadComponent.defaultProps = {\n  className: '',\n  fileContainerStyle: {},\n  buttonClassName: \"\",\n  buttonStyles: {},\n  withPreview: false,\n  accept: \"image/*\",\n  name: \"\",\n  withIcon: true,\n  buttonText: \"Choose images\",\n  buttonType: \"button\",\n  withLabel: true,\n  label: \"Max file size: 5mb, accepted: jpg|gif|png\",\n  labelStyles: {},\n  labelClass: \"\",\n  imgExtension: ['.jpg', '.jpeg', '.gif', '.png'],\n  maxFileSize: 5242880,\n  fileSizeError: \" file size is too big\",\n  fileTypeError: \" is not a supported file extension\",\n  errorClass: \"\",\n  style: {},\n  errorStyle: {},\n  singleImage: false,\n  onChange: function onChange() {},\n  defaultImages: []\n};\n\nReactImageUploadComponent.propTypes = {\n  style: _propTypes2.default.object,\n  fileContainerStyle: _propTypes2.default.object,\n  className: _propTypes2.default.string,\n  onChange: _propTypes2.default.func,\n  onDelete: _propTypes2.default.func,\n  buttonClassName: _propTypes2.default.string,\n  buttonStyles: _propTypes2.default.object,\n  buttonType: _propTypes2.default.string,\n  withPreview: _propTypes2.default.bool,\n  accept: _propTypes2.default.string,\n  name: _propTypes2.default.string,\n  withIcon: _propTypes2.default.bool,\n  buttonText: _propTypes2.default.string,\n  withLabel: _propTypes2.default.bool,\n  label: _propTypes2.default.string,\n  labelStyles: _propTypes2.default.object,\n  labelClass: _propTypes2.default.string,\n  imgExtension: _propTypes2.default.array,\n  maxFileSize: _propTypes2.default.number,\n  fileSizeError: _propTypes2.default.string,\n  fileTypeError: _propTypes2.default.string,\n  errorClass: _propTypes2.default.string,\n  errorStyle: _propTypes2.default.object,\n  singleImage: _propTypes2.default.bool,\n  defaultImages: _propTypes2.default.array\n};\n\nexports.default = ReactImageUploadComponent;\n","import React, { Children, Component, cloneElement, createElement } from 'react';\nimport ReactDOM, { findDOMNode } from 'react-dom';\n\nfunction warnOnce(msg) {\n  var hasWarned = false;\n  return function () {\n    if (!hasWarned) {\n      console.warn(msg);\n      hasWarned = true;\n    }\n  };\n}\n\n\nvar statelessFunctionalComponentSupplied = warnOnce('\\n>> Error, via react-flip-move <<\\n\\nYou provided a stateless functional component as a child to <FlipMove>. Unfortunately, SFCs aren\\'t supported, because Flip Move needs access to the backing instances via refs, and SFCs don\\'t have a public instance that holds that info.\\n\\nPlease wrap your components in a native element (eg. <div>), or a non-functional component.\\n');\n\nvar primitiveNodeSupplied = warnOnce('\\n>> Error, via react-flip-move <<\\n\\nYou provided a primitive (text or number) node as a child to <FlipMove>. Flip Move needs containers with unique keys to move children around.\\n\\nPlease wrap your value in a native element (eg. <span>), or a component.\\n');\n\nvar invalidTypeForTimingProp = function invalidTypeForTimingProp(args\n// prettier-ignore\n) {\n  return console.error('\\n>> Error, via react-flip-move <<\\n\\nThe prop you provided for \\'' + args.prop + '\\' is invalid. It needs to be a positive integer, or a string that can be resolved to a number. The value you provided is \\'' + args.value + '\\'.\\n\\nAs a result,  the default value for this parameter will be used, which is \\'' + args.defaultValue + '\\'.\\n');\n};\n\nvar invalidEnterLeavePreset = function invalidEnterLeavePreset(args\n// prettier-ignore\n) {\n  return console.error('\\n>> Error, via react-flip-move <<\\n\\nThe enter/leave preset you provided is invalid. We don\\'t currently have a \\'' + args.value + ' preset.\\'\\n\\nAcceptable values are ' + args.acceptableValues + '. The default value of \\'' + args.defaultValue + '\\' will be used.\\n');\n};\n\nvar parentNodePositionStatic = warnOnce('\\n>> Warning, via react-flip-move <<\\n\\nWhen using \"wrapperless\" mode (by supplying \\'typeName\\' of \\'null\\'), strange things happen when the direct parent has the default \"static\" position.\\n\\nFlipMove has added \\'position: relative\\' to this node, to ensure Flip Move animates correctly.\\n\\nTo avoid seeing this warning, simply apply a non-static position to that parent node.\\n');\n\nvar childIsDisabled = warnOnce('\\n>> Warning, via react-flip-move <<\\n\\nOne or more of Flip Move\\'s child elements have the html attribute \\'disabled\\' set to true.\\n\\nPlease note that this will cause animations to break in Internet Explorer 11 and below. Either remove the disabled attribute or set \\'animation\\' to false.\\n');\n\nvar enterPresets = {\n  elevator: {\n    from: { transform: 'scale(0)', opacity: '0' },\n    to: { transform: '', opacity: '' }\n  },\n  fade: {\n    from: { opacity: '0' },\n    to: { opacity: '' }\n  },\n  accordionVertical: {\n    from: { transform: 'scaleY(0)', transformOrigin: 'center top' },\n    to: { transform: '', transformOrigin: 'center top' }\n  },\n  accordionHorizontal: {\n    from: { transform: 'scaleX(0)', transformOrigin: 'left center' },\n    to: { transform: '', transformOrigin: 'left center' }\n  },\n  none: null\n};\n/**\n * React Flip Move | enterLeavePresets\n * (c) 2016-present Joshua Comeau\n *\n * This contains the master list of presets available for enter/leave animations,\n * along with the mapping between preset and styles.\n */\n\n\nvar leavePresets = {\n  elevator: {\n    from: { transform: 'scale(1)', opacity: '1' },\n    to: { transform: 'scale(0)', opacity: '0' }\n  },\n  fade: {\n    from: { opacity: '1' },\n    to: { opacity: '0' }\n  },\n  accordionVertical: {\n    from: { transform: 'scaleY(1)', transformOrigin: 'center top' },\n    to: { transform: 'scaleY(0)', transformOrigin: 'center top' }\n  },\n  accordionHorizontal: {\n    from: { transform: 'scaleX(1)', transformOrigin: 'left center' },\n    to: { transform: 'scaleX(0)', transformOrigin: 'left center' }\n  },\n  none: null\n};\n\n// For now, appearPresets will be identical to enterPresets.\n// Assigning a custom export in case we ever want to add appear-specific ones.\nvar appearPresets = enterPresets;\n\nvar defaultPreset = 'elevator';\nvar disablePreset = 'none';\n\nvar find = function find(predicate, arr) {\n  for (var i = 0; i < arr.length; i++) {\n    if (predicate(arr[i], i, arr)) {\n      return arr[i];\n    }\n  }\n\n  return undefined;\n};\n\n\nvar every = function every(predicate, arr) {\n  for (var i = 0; i < arr.length; i++) {\n    if (!predicate(arr[i], i, arr)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n// eslint-disable-next-line import/no-mutable-exports\nvar _isArray = function isArray(arr) {\n  _isArray = Array.isArray || function (arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]';\n  };\n  return _isArray(arr);\n};\n\nvar isElementAnSFC = function isElementAnSFC(element) {\n  var isNativeDOMElement = typeof element.type === 'string';\n\n  if (isNativeDOMElement) {\n    return false;\n  }\n\n  return typeof element.type === 'function' && !element.type.prototype.isReactComponent;\n};\n\nfunction omit(obj) {\n  var attrs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  var result = {};\n  Object.keys(obj).forEach(function (key) {\n    if (attrs.indexOf(key) === -1) {\n      result[key] = obj[key];\n    }\n  });\n  return result;\n}\n\nfunction arraysEqual(a, b) {\n  var sameObject = a === b;\n  if (sameObject) {\n    return true;\n  }\n\n  var notBothArrays = !_isArray(a) || !_isArray(b);\n  var differentLengths = a.length !== b.length;\n\n  if (notBothArrays || differentLengths) {\n    return false;\n  }\n\n  return every(function (element, index) {\n    return element === b[index];\n  }, a);\n}\n\nfunction memoizeString(fn) {\n  var cache = {};\n\n  return function (str) {\n    if (!cache[str]) {\n      cache[str] = fn(str);\n    }\n    return cache[str];\n  };\n}\n\nvar hyphenate = memoizeString(function (str) {\n  return str.replace(/([A-Z])/g, '-$1').toLowerCase();\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n\n\n\n\n\n\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n/**\n * React Flip Move | propConverter\n * (c) 2016-present Joshua Comeau\n *\n * Abstracted away a bunch of the messy business with props.\n *   - props flow types and defaultProps\n *   - Type conversion (We accept 'string' and 'number' values for duration,\n *     delay, and other fields, but we actually need them to be ints.)\n *   - Children conversion (we need the children to be an array. May not always\n *     be, if a single child is passed in.)\n *   - Resolving animation presets into their base CSS styles\n */\n/* eslint-disable block-scoped-var */\n\n// eslint-disable-next-line no-duplicate-imports\n\n\nfunction propConverter(ComposedComponent) {\n  var _class, _temp;\n\n  return _temp = _class = function (_Component) {\n    inherits(FlipMovePropConverter, _Component);\n\n    function FlipMovePropConverter() {\n      classCallCheck(this, FlipMovePropConverter);\n      return possibleConstructorReturn(this, _Component.apply(this, arguments));\n    }\n\n    // eslint-disable-next-line class-methods-use-this\n    FlipMovePropConverter.prototype.checkChildren = function checkChildren(children) {\n      // Skip all console warnings in production.\n      // Bail early, to avoid unnecessary work.\n      if (process.env.NODE_ENV === 'production') {\n        return;\n      }\n\n      // same as React.Node, but without fragments, see https://github.com/facebook/flow/issues/4781\n\n\n      // FlipMove does not support stateless functional components.\n      // Check to see if any supplied components won't work.\n      // If the child doesn't have a key, it means we aren't animating it.\n      // It's allowed to be an SFC, since we ignore it.\n      Children.forEach(children, function (child) {\n        // null, undefined, and booleans will be filtered out by Children.toArray\n        if (child == null || typeof child === 'boolean') {\n          return;\n        }\n\n        if ((typeof child === 'undefined' ? 'undefined' : _typeof(child)) !== 'object') {\n          primitiveNodeSupplied();\n          return;\n        }\n\n        if (isElementAnSFC(child) && child.key != null) {\n          statelessFunctionalComponentSupplied();\n        }\n      });\n    };\n\n    FlipMovePropConverter.prototype.convertProps = function convertProps(props) {\n      var workingProps = {\n        // explicitly bypass the props that don't need conversion\n        children: props.children,\n        easing: props.easing,\n        onStart: props.onStart,\n        onFinish: props.onFinish,\n        onStartAll: props.onStartAll,\n        onFinishAll: props.onFinishAll,\n        typeName: props.typeName,\n        disableAllAnimations: props.disableAllAnimations,\n        getPosition: props.getPosition,\n        maintainContainerHeight: props.maintainContainerHeight,\n        verticalAlignment: props.verticalAlignment,\n\n        // Do string-to-int conversion for all timing-related props\n        duration: this.convertTimingProp('duration'),\n        delay: this.convertTimingProp('delay'),\n        staggerDurationBy: this.convertTimingProp('staggerDurationBy'),\n        staggerDelayBy: this.convertTimingProp('staggerDelayBy'),\n\n        // Our enter/leave animations can be specified as boolean (default or\n        // disabled), string (preset name), or object (actual animation values).\n        // Let's standardize this so that they're always objects\n        appearAnimation: this.convertAnimationProp(props.appearAnimation, appearPresets),\n        enterAnimation: this.convertAnimationProp(props.enterAnimation, enterPresets),\n        leaveAnimation: this.convertAnimationProp(props.leaveAnimation, leavePresets),\n\n        delegated: {}\n      };\n\n      this.checkChildren(workingProps.children);\n\n      // Gather any additional props;\n      // they will be delegated to the ReactElement created.\n      var primaryPropKeys = Object.keys(workingProps);\n      var delegatedProps = omit(this.props, primaryPropKeys);\n\n      // The FlipMove container element needs to have a non-static position.\n      // We use `relative` by default, but it can be overridden by the user.\n      // Now that we're delegating props, we need to merge this in.\n      delegatedProps.style = _extends({\n        position: 'relative'\n      }, delegatedProps.style);\n\n      workingProps.delegated = delegatedProps;\n\n      return workingProps;\n    };\n\n    FlipMovePropConverter.prototype.convertTimingProp = function convertTimingProp(prop) {\n      var rawValue = this.props[prop];\n\n      var value = typeof rawValue === 'number' ? rawValue : parseInt(rawValue, 10);\n\n      if (isNaN(value)) {\n        var defaultValue = FlipMovePropConverter.defaultProps[prop];\n\n        if (process.env.NODE_ENV !== 'production') {\n          invalidTypeForTimingProp({\n            prop: prop,\n            value: rawValue,\n            defaultValue: defaultValue\n          });\n        }\n\n        return defaultValue;\n      }\n\n      return value;\n    };\n\n    // eslint-disable-next-line class-methods-use-this\n\n\n    FlipMovePropConverter.prototype.convertAnimationProp = function convertAnimationProp(animation, presets) {\n      switch (typeof animation === 'undefined' ? 'undefined' : _typeof(animation)) {\n        case 'boolean':\n          {\n            // If it's true, we want to use the default preset.\n            // If it's false, we want to use the 'none' preset.\n            return presets[animation ? defaultPreset : disablePreset];\n          }\n\n        case 'string':\n          {\n            var presetKeys = Object.keys(presets);\n\n            if (presetKeys.indexOf(animation) === -1) {\n              if (process.env.NODE_ENV !== 'production') {\n                invalidEnterLeavePreset({\n                  value: animation,\n                  acceptableValues: presetKeys.join(', '),\n                  defaultValue: defaultPreset\n                });\n              }\n\n              return presets[defaultPreset];\n            }\n\n            return presets[animation];\n          }\n\n        default:\n          {\n            return animation;\n          }\n      }\n    };\n\n    FlipMovePropConverter.prototype.render = function render() {\n      return React.createElement(ComposedComponent, this.convertProps(this.props));\n    };\n\n    return FlipMovePropConverter;\n  }(Component), _class.defaultProps = {\n    easing: 'ease-in-out',\n    duration: 350,\n    delay: 0,\n    staggerDurationBy: 0,\n    staggerDelayBy: 0,\n    typeName: 'div',\n    enterAnimation: defaultPreset,\n    leaveAnimation: defaultPreset,\n    disableAllAnimations: false,\n    getPosition: function getPosition(node) {\n      return node.getBoundingClientRect();\n    },\n    maintainContainerHeight: false,\n    verticalAlignment: 'top'\n  }, _temp;\n}\n\n/**\n * React Flip Move\n * (c) 2016-present Joshua Comeau\n *\n * These methods read from and write to the DOM.\n * They almost always have side effects, and will hopefully become the\n * only spot in the codebase with impure functions.\n */\nfunction applyStylesToDOMNode(_ref) {\n  var domNode = _ref.domNode,\n      styles = _ref.styles;\n\n  // Can't just do an object merge because domNode.styles is no regular object.\n  // Need to do it this way for the engine to fire its `set` listeners.\n  Object.keys(styles).forEach(function (key) {\n    domNode.style.setProperty(hyphenate(key), styles[key]);\n  });\n}\n\n// Modified from Modernizr\nfunction whichTransitionEvent() {\n  var transitions = {\n    transition: 'transitionend',\n    '-o-transition': 'oTransitionEnd',\n    '-moz-transition': 'transitionend',\n    '-webkit-transition': 'webkitTransitionEnd'\n  };\n\n  // If we're running in a browserless environment (eg. SSR), it doesn't apply.\n  // Return a placeholder string, for consistent type return.\n  if (typeof document === 'undefined') return '';\n\n  var el = document.createElement('fakeelement');\n\n  var match = find(function (t) {\n    return el.style.getPropertyValue(t) !== undefined;\n  }, Object.keys(transitions));\n\n  // If no `transition` is found, we must be running in a browser so ancient,\n  // React itself won't run. Return an empty string, for consistent type return\n  return match ? transitions[match] : '';\n}\n\nvar getRelativeBoundingBox = function getRelativeBoundingBox(_ref2) {\n  var childDomNode = _ref2.childDomNode,\n      parentDomNode = _ref2.parentDomNode,\n      getPosition = _ref2.getPosition;\n\n  var parentBox = getPosition(parentDomNode);\n\n  var _getPosition = getPosition(childDomNode),\n      top = _getPosition.top,\n      left = _getPosition.left,\n      right = _getPosition.right,\n      bottom = _getPosition.bottom,\n      width = _getPosition.width,\n      height = _getPosition.height;\n\n  return {\n    top: top - parentBox.top,\n    left: left - parentBox.left,\n    right: parentBox.right - right,\n    bottom: parentBox.bottom - bottom,\n    width: width,\n    height: height\n  };\n};\n\n/** getPositionDelta\n * This method returns the delta between two bounding boxes, to figure out\n * how many pixels on each axis the element has moved.\n *\n */\nvar getPositionDelta = function getPositionDelta(_ref3) {\n  var childDomNode = _ref3.childDomNode,\n      childBoundingBox = _ref3.childBoundingBox,\n      parentBoundingBox = _ref3.parentBoundingBox,\n      getPosition = _ref3.getPosition;\n\n  // TEMP: A mystery bug is sometimes causing unnecessary boundingBoxes to\n  var defaultBox = {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    height: 0,\n    width: 0\n  };\n\n  // Our old box is its last calculated position, derived on mount or at the\n  // start of the previous animation.\n  var oldRelativeBox = childBoundingBox || defaultBox;\n  var parentBox = parentBoundingBox || defaultBox;\n\n  // Our new box is the new final resting place: Where we expect it to wind up\n  // after the animation. First we get the box in absolute terms (AKA relative\n  // to the viewport), and then we calculate its relative box (relative to the\n  // parent container)\n  var newAbsoluteBox = getPosition(childDomNode);\n  var newRelativeBox = {\n    top: newAbsoluteBox.top - parentBox.top,\n    left: newAbsoluteBox.left - parentBox.left\n  };\n\n  return [oldRelativeBox.left - newRelativeBox.left, oldRelativeBox.top - newRelativeBox.top];\n};\n\n/** removeNodeFromDOMFlow\n * This method does something very sneaky: it removes a DOM node from the\n * document flow, but without actually changing its on-screen position.\n *\n * It works by calculating where the node is, and then applying styles\n * so that it winds up being positioned absolutely, but in exactly the\n * same place.\n *\n * This is a vital part of the FLIP technique.\n */\nvar removeNodeFromDOMFlow = function removeNodeFromDOMFlow(childData, verticalAlignment) {\n  var domNode = childData.domNode,\n      boundingBox = childData.boundingBox;\n\n\n  if (!domNode || !boundingBox) {\n    return;\n  }\n\n  // For this to work, we have to offset any given `margin`.\n  var computed = window.getComputedStyle(domNode);\n\n  // We need to clean up margins, by converting and removing suffix:\n  // eg. '21px' -> 21\n  var marginAttrs = ['margin-top', 'margin-left', 'margin-right'];\n  var margins = marginAttrs.reduce(function (acc, margin) {\n    var _babelHelpers$extends;\n\n    var propertyVal = computed.getPropertyValue(margin);\n\n    return _extends({}, acc, (_babelHelpers$extends = {}, _babelHelpers$extends[margin] = Number(propertyVal.replace('px', '')), _babelHelpers$extends));\n  }, {});\n\n  // If we're bottom-aligned, we need to add the height of the child to its\n  // top offset. This is because, when the container is bottom-aligned, its\n  // height shrinks from the top, not the bottom. We're removing this node\n  // from the flow, so the top is going to drop by its height.\n  var topOffset = verticalAlignment === 'bottom' ? boundingBox.top - boundingBox.height : boundingBox.top;\n\n  var styles = {\n    position: 'absolute',\n    top: topOffset - margins['margin-top'] + 'px',\n    left: boundingBox.left - margins['margin-left'] + 'px',\n    right: boundingBox.right - margins['margin-right'] + 'px'\n  };\n\n  applyStylesToDOMNode({ domNode: domNode, styles: styles });\n};\n\n/** updateHeightPlaceholder\n * An optional property to FlipMove is a `maintainContainerHeight` boolean.\n * This property creates a node that fills space, so that the parent\n * container doesn't collapse when its children are removed from the\n * document flow.\n */\nvar updateHeightPlaceholder = function updateHeightPlaceholder(_ref4) {\n  var domNode = _ref4.domNode,\n      parentData = _ref4.parentData,\n      getPosition = _ref4.getPosition;\n\n  var parentDomNode = parentData.domNode;\n  var parentBoundingBox = parentData.boundingBox;\n\n  if (!parentDomNode || !parentBoundingBox) {\n    return;\n  }\n\n  // We need to find the height of the container *without* the placeholder.\n  // Since it's possible that the placeholder might already be present,\n  // we first set its height to 0.\n  // This allows the container to collapse down to the size of just its\n  // content (plus container padding or borders if any).\n  applyStylesToDOMNode({ domNode: domNode, styles: { height: '0' } });\n\n  // Find the distance by which the container would be collapsed by elements\n  // leaving. We compare the freshly-available parent height with the original,\n  // cached container height.\n  var originalParentHeight = parentBoundingBox.height;\n  var collapsedParentHeight = getPosition(parentDomNode).height;\n  var reductionInHeight = originalParentHeight - collapsedParentHeight;\n\n  // If the container has become shorter, update the padding element's\n  // height to take up the difference. Otherwise set its height to zero,\n  // so that it has no effect.\n  var styles = {\n    height: reductionInHeight > 0 ? reductionInHeight + 'px' : '0'\n  };\n\n  applyStylesToDOMNode({ domNode: domNode, styles: styles });\n};\n\nvar getNativeNode = function getNativeNode(element) {\n  // When running in a windowless environment, abort!\n  if (typeof HTMLElement === 'undefined') {\n    return null;\n  }\n\n  // `element` may already be a native node.\n  if (element instanceof HTMLElement) {\n    return element;\n  }\n\n  // While ReactDOM's `findDOMNode` is discouraged, it's the only\n  // publicly-exposed way to find the underlying DOM node for\n  // composite components.\n  var foundNode = findDOMNode(element);\n\n  if (foundNode && foundNode.nodeType === Node.TEXT_NODE) {\n    // Text nodes are not supported\n    return null;\n  }\n  // eslint-disable-next-line flowtype/no-weak-types\n  return foundNode;\n};\n\nvar createTransitionString = function createTransitionString(index, props) {\n  var delay = props.delay,\n      duration = props.duration;\n  var staggerDurationBy = props.staggerDurationBy,\n      staggerDelayBy = props.staggerDelayBy,\n      easing = props.easing;\n\n\n  delay += index * staggerDelayBy;\n  duration += index * staggerDurationBy;\n\n  var cssProperties = ['transform', 'opacity'];\n\n  return cssProperties.map(function (prop) {\n    return prop + ' ' + duration + 'ms ' + easing + ' ' + delay + 'ms';\n  }).join(', ');\n};\n\n/**\n * React Flip Move\n * (c) 2016-present Joshua Comeau\n *\n * For information on how this code is laid out, check out CODE_TOUR.md\n */\n\n/* eslint-disable react/prop-types */\n\n// eslint-disable-next-line no-duplicate-imports\n\n\nvar transitionEnd = whichTransitionEvent();\nvar noBrowserSupport = !transitionEnd;\n\nfunction getKey(childData) {\n  return childData.key || '';\n}\n\nfunction getElementChildren(children) {\n  // Fix incomplete typing of Children.toArray\n  // eslint-disable-next-line flowtype/no-weak-types\n  return Children.toArray(children);\n}\n\nvar FlipMove$1 = function (_Component) {\n  inherits(FlipMove, _Component);\n\n  function FlipMove() {\n    var _temp, _this, _ret;\n\n    classCallCheck(this, FlipMove);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.state = {\n      children: getElementChildren(\n      // `this.props` ought to always be defined at this point, but a report\n      // was made about it not being defined in IE10.\n      // TODO: Test in IE10, to see if there's an underlying cause that can\n      // be addressed.\n      _this.props ? _this.props.children : []).map(function (element) {\n        return _extends({}, element, {\n          element: element,\n          appearing: true\n        });\n      })\n    }, _this.childrenData = {}, _this.parentData = {\n      domNode: null,\n      boundingBox: null\n    }, _this.heightPlaceholderData = {\n      domNode: null\n    }, _this.remainingAnimations = 0, _this.childrenToAnimate = [], _this.findDOMContainer = function () {\n      // eslint-disable-next-line react/no-find-dom-node\n      var domNode = ReactDOM.findDOMNode(_this);\n      var parentNode = domNode && domNode.parentNode;\n\n      // This ought to be impossible, but handling it for Flow's sake.\n      if (!parentNode || !(parentNode instanceof HTMLElement)) {\n        return;\n      }\n\n      // If the parent node has static positioning, leave animations might look\n      // really funky. Let's automatically apply `position: relative` in this\n      // case, to prevent any quirkiness.\n      if (window.getComputedStyle(parentNode).position === 'static') {\n        parentNode.style.position = 'relative';\n        parentNodePositionStatic();\n      }\n\n      _this.parentData.domNode = parentNode;\n    }, _this.runAnimation = function () {\n      var dynamicChildren = _this.state.children.filter(_this.doesChildNeedToBeAnimated);\n\n      // Splitting DOM reads and writes to be peformed in batches\n      var childrenInitialStyles = dynamicChildren.map(function (child) {\n        return _this.computeInitialStyles(child);\n      });\n      dynamicChildren.forEach(function (child, index) {\n        _this.remainingAnimations += 1;\n        _this.childrenToAnimate.push(getKey(child));\n        _this.animateChild(child, index, childrenInitialStyles[index]);\n      });\n\n      if (typeof _this.props.onStartAll === 'function') {\n        _this.callChildrenHook(_this.props.onStartAll);\n      }\n    }, _this.doesChildNeedToBeAnimated = function (child) {\n      // If the child doesn't have a key, it's an immovable child (one that we\n      // do not want to do FLIP stuff to.)\n      if (!getKey(child)) {\n        return false;\n      }\n\n      var childData = _this.getChildData(getKey(child));\n      var childDomNode = childData.domNode;\n      var childBoundingBox = childData.boundingBox;\n      var parentBoundingBox = _this.parentData.boundingBox;\n\n      if (!childDomNode) {\n        return false;\n      }\n\n      var _this$props = _this.props,\n          appearAnimation = _this$props.appearAnimation,\n          enterAnimation = _this$props.enterAnimation,\n          leaveAnimation = _this$props.leaveAnimation,\n          getPosition = _this$props.getPosition;\n\n\n      var isAppearingWithAnimation = child.appearing && appearAnimation;\n      var isEnteringWithAnimation = child.entering && enterAnimation;\n      var isLeavingWithAnimation = child.leaving && leaveAnimation;\n\n      if (isAppearingWithAnimation || isEnteringWithAnimation || isLeavingWithAnimation) {\n        return true;\n      }\n\n      // If it isn't entering/leaving, we want to animate it if it's\n      // on-screen position has changed.\n\n      var _getPositionDelta = getPositionDelta({\n        childDomNode: childDomNode,\n        childBoundingBox: childBoundingBox,\n        parentBoundingBox: parentBoundingBox,\n        getPosition: getPosition\n      }),\n          dX = _getPositionDelta[0],\n          dY = _getPositionDelta[1];\n\n      return dX !== 0 || dY !== 0;\n    }, _temp), possibleConstructorReturn(_this, _ret);\n  }\n  // Copy props.children into state.\n  // To understand why this is important (and not an anti-pattern), consider\n  // how \"leave\" animations work. An item has \"left\" when the component\n  // receives a new set of props that do NOT contain the item.\n  // If we just render the props as-is, the item would instantly disappear.\n  // We want to keep the item rendered for a little while, until its animation\n  // can complete. Because we cannot mutate props, we make `state` the source\n  // of truth.\n\n\n  // FlipMove needs to know quite a bit about its children in order to do\n  // its job. We store these as a property on the instance. We're not using\n  // state, because we don't want changes to trigger re-renders, we just\n  // need a place to keep the data for reference, when changes happen.\n  // This field should not be accessed directly. Instead, use getChildData,\n  // putChildData, etc...\n\n\n  // Similarly, track the dom node and box of our parent element.\n\n\n  // If `maintainContainerHeight` prop is set to true, we'll create a\n  // placeholder element which occupies space so that the parent height\n  // doesn't change when items are removed from the document flow (which\n  // happens during leave animations)\n\n\n  // Keep track of remaining animations so we know when to fire the\n  // all-finished callback, and clean up after ourselves.\n  // NOTE: we can't simply use childrenToAnimate.length to track remaining\n  // animations, because we need to maintain the list of animating children,\n  // to pass to the `onFinishAll` handler.\n\n\n  FlipMove.prototype.componentDidMount = function componentDidMount() {\n    // Because React 16 no longer requires wrapping elements, Flip Move can opt\n    // to not wrap the children in an element. In that case, find the parent\n    // element using `findDOMNode`.\n    if (this.props.typeName === null) {\n      this.findDOMContainer();\n    }\n\n    // Run our `appearAnimation` if it was requested, right after the\n    // component mounts.\n    var shouldTriggerFLIP = this.props.appearAnimation && !this.isAnimationDisabled(this.props);\n\n    if (shouldTriggerFLIP) {\n      this.prepForAnimation();\n      this.runAnimation();\n    }\n  };\n\n  FlipMove.prototype.componentDidUpdate = function componentDidUpdate(previousProps) {\n    if (this.props.typeName === null) {\n      this.findDOMContainer();\n    }\n    // If the children have been re-arranged, moved, or added/removed,\n    // trigger the main FLIP animation.\n    //\n    // IMPORTANT: We need to make sure that the children have actually changed.\n    // At the end of the transition, we clean up nodes that need to be removed.\n    // We DON'T want this cleanup to trigger another update.\n\n    var oldChildrenKeys = getElementChildren(this.props.children).map(function (d) {\n      return d.key;\n    });\n    var nextChildrenKeys = getElementChildren(previousProps.children).map(function (d) {\n      return d.key;\n    });\n\n    var shouldTriggerFLIP = !arraysEqual(oldChildrenKeys, nextChildrenKeys) && !this.isAnimationDisabled(this.props);\n\n    if (shouldTriggerFLIP) {\n      this.prepForAnimation();\n      this.runAnimation();\n    }\n  };\n\n  FlipMove.prototype.calculateNextSetOfChildren = function calculateNextSetOfChildren(nextChildren) {\n    var _this2 = this;\n\n    // We want to:\n    //   - Mark all new children as `entering`\n    //   - Pull in previous children that aren't in nextChildren, and mark them\n    //     as `leaving`\n    //   - Preserve the nextChildren list order, with leaving children in their\n    //     appropriate places.\n    //\n\n    var updatedChildren = nextChildren.map(function (nextChild) {\n      var child = _this2.findChildByKey(nextChild.key);\n\n      // If the current child did exist, but it was in the midst of leaving,\n      // we want to treat it as though it's entering\n      var isEntering = !child || child.leaving;\n\n      return _extends({}, nextChild, { element: nextChild, entering: isEntering });\n    });\n\n    // This is tricky. We want to keep the nextChildren's ordering, but with\n    // any just-removed items maintaining their original position.\n    // eg.\n    //   this.state.children  = [ 1, 2, 3, 4 ]\n    //   nextChildren         = [ 3, 1 ]\n    //\n    // In this example, we've removed the '2' & '4'\n    // We want to end up with:  [ 2, 3, 1, 4 ]\n    //\n    // To accomplish that, we'll iterate through this.state.children. whenever\n    // we find a match, we'll append our `leaving` flag to it, and insert it\n    // into the nextChildren in its ORIGINAL position. Note that, as we keep\n    // inserting old items into the new list, the \"original\" position will\n    // keep incrementing.\n    var numOfChildrenLeaving = 0;\n    this.state.children.forEach(function (child, index) {\n      var isLeaving = !find(function (_ref) {\n        var key = _ref.key;\n        return key === getKey(child);\n      }, nextChildren);\n\n      // If the child isn't leaving (or, if there is no leave animation),\n      // we don't need to add it into the state children.\n      if (!isLeaving || !_this2.props.leaveAnimation) return;\n\n      var nextChild = _extends({}, child, { leaving: true });\n      var nextChildIndex = index + numOfChildrenLeaving;\n\n      updatedChildren.splice(nextChildIndex, 0, nextChild);\n      numOfChildrenLeaving += 1;\n    });\n\n    return updatedChildren;\n  };\n\n  FlipMove.prototype.prepForAnimation = function prepForAnimation() {\n    var _this3 = this;\n\n    // Our animation prep consists of:\n    // - remove children that are leaving from the DOM flow, so that the new\n    //   layout can be accurately calculated,\n    // - update the placeholder container height, if needed, to ensure that\n    //   the parent's height doesn't collapse.\n\n    var _props = this.props,\n        leaveAnimation = _props.leaveAnimation,\n        maintainContainerHeight = _props.maintainContainerHeight,\n        getPosition = _props.getPosition;\n\n    // we need to make all leaving nodes \"invisible\" to the layout calculations\n    // that will take place in the next step (this.runAnimation).\n\n    if (leaveAnimation) {\n      var leavingChildren = this.state.children.filter(function (child) {\n        return child.leaving;\n      });\n\n      leavingChildren.forEach(function (leavingChild) {\n        var childData = _this3.getChildData(getKey(leavingChild));\n\n        // Warn if child is disabled\n        if (!_this3.isAnimationDisabled(_this3.props) && childData.domNode && childData.domNode.disabled) {\n          childIsDisabled();\n        }\n\n        // We need to take the items out of the \"flow\" of the document, so that\n        // its siblings can move to take its place.\n        if (childData.boundingBox) {\n          removeNodeFromDOMFlow(childData, _this3.props.verticalAlignment);\n        }\n      });\n\n      if (maintainContainerHeight && this.heightPlaceholderData.domNode) {\n        updateHeightPlaceholder({\n          domNode: this.heightPlaceholderData.domNode,\n          parentData: this.parentData,\n          getPosition: getPosition\n        });\n      }\n    }\n\n    // For all children not in the middle of entering or leaving,\n    // we need to reset the transition, so that the NEW shuffle starts from\n    // the right place.\n    this.state.children.forEach(function (child) {\n      var _getChildData = _this3.getChildData(getKey(child)),\n          domNode = _getChildData.domNode;\n\n      // Ignore children that don't render DOM nodes (eg. by returning null)\n\n\n      if (!domNode) {\n        return;\n      }\n\n      if (!child.entering && !child.leaving) {\n        applyStylesToDOMNode({\n          domNode: domNode,\n          styles: {\n            transition: ''\n          }\n        });\n      }\n    });\n  };\n\n  // eslint-disable-next-line camelcase\n\n\n  FlipMove.prototype.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps(nextProps) {\n    // When the component is handed new props, we need to figure out the\n    // \"resting\" position of all currently-rendered DOM nodes.\n    // We store that data in this.parent and this.children,\n    // so it can be used later to work out the animation.\n    this.updateBoundingBoxCaches();\n\n    // Convert opaque children object to array.\n    var nextChildren = getElementChildren(nextProps.children);\n\n    // Next, we need to update our state, so that it contains our new set of\n    // children. If animation is disabled or unsupported, this is easy;\n    // we just copy our props into state.\n    // Assuming that we can animate, though, we have to do some work.\n    // Essentially, we want to keep just-deleted nodes in the DOM for a bit\n    // longer, so that we can animate them away.\n    this.setState({\n      children: this.isAnimationDisabled(nextProps) ? nextChildren.map(function (element) {\n        return _extends({}, element, { element: element });\n      }) : this.calculateNextSetOfChildren(nextChildren)\n    });\n  };\n\n  FlipMove.prototype.animateChild = function animateChild(child, index, childInitialStyles) {\n    var _this4 = this;\n\n    var _getChildData2 = this.getChildData(getKey(child)),\n        domNode = _getChildData2.domNode;\n\n    if (!domNode) {\n      return;\n    }\n\n    // Apply the relevant style for this DOM node\n    // This is the offset from its actual DOM position.\n    // eg. if an item has been re-rendered 20px lower, we want to apply a\n    // style of 'transform: translate(-20px)', so that it appears to be where\n    // it started.\n    // In FLIP terminology, this is the 'Invert' stage.\n    applyStylesToDOMNode({\n      domNode: domNode,\n      styles: childInitialStyles\n    });\n\n    // Start by invoking the onStart callback for this child.\n    if (this.props.onStart) this.props.onStart(child, domNode);\n\n    // Next, animate the item from it's artificially-offset position to its\n    // new, natural position.\n    requestAnimationFrame(function () {\n      requestAnimationFrame(function () {\n        // NOTE, RE: the double-requestAnimationFrame:\n        // Sadly, this is the most browser-compatible way to do this I've found.\n        // Essentially we need to set the initial styles outside of any request\n        // callbacks to avoid batching them. Then, a frame needs to pass with\n        // the styles above rendered. Then, on the second frame, we can apply\n        // our final styles to perform the animation.\n\n        // Our first order of business is to \"undo\" the styles applied in the\n        // previous frames, while also adding a `transition` property.\n        // This way, the item will smoothly transition from its old position\n        // to its new position.\n\n        // eslint-disable-next-line flowtype/require-variable-type\n        var styles = {\n          transition: createTransitionString(index, _this4.props),\n          transform: '',\n          opacity: ''\n        };\n\n        if (child.appearing && _this4.props.appearAnimation) {\n          styles = _extends({}, styles, _this4.props.appearAnimation.to);\n        } else if (child.entering && _this4.props.enterAnimation) {\n          styles = _extends({}, styles, _this4.props.enterAnimation.to);\n        } else if (child.leaving && _this4.props.leaveAnimation) {\n          styles = _extends({}, styles, _this4.props.leaveAnimation.to);\n        }\n\n        // In FLIP terminology, this is the 'Play' stage.\n        applyStylesToDOMNode({ domNode: domNode, styles: styles });\n      });\n    });\n\n    this.bindTransitionEndHandler(child);\n  };\n\n  FlipMove.prototype.bindTransitionEndHandler = function bindTransitionEndHandler(child) {\n    var _this5 = this;\n\n    var _getChildData3 = this.getChildData(getKey(child)),\n        domNode = _getChildData3.domNode;\n\n    if (!domNode) {\n      return;\n    }\n\n    // The onFinish callback needs to be bound to the transitionEnd event.\n    // We also need to unbind it when the transition completes, so this ugly\n    // inline function is required (we need it here so it closes over\n    // dependent variables `child` and `domNode`)\n    var transitionEndHandler = function transitionEndHandler(ev) {\n      // It's possible that this handler is fired not on our primary transition,\n      // but on a nested transition (eg. a hover effect). Ignore these cases.\n      if (ev.target !== domNode) return;\n\n      // Remove the 'transition' inline style we added. This is cleanup.\n      domNode.style.transition = '';\n\n      // Trigger any applicable onFinish/onFinishAll hooks\n      _this5.triggerFinishHooks(child, domNode);\n\n      domNode.removeEventListener(transitionEnd, transitionEndHandler);\n\n      if (child.leaving) {\n        _this5.removeChildData(getKey(child));\n      }\n    };\n\n    domNode.addEventListener(transitionEnd, transitionEndHandler);\n  };\n\n  FlipMove.prototype.triggerFinishHooks = function triggerFinishHooks(child, domNode) {\n    var _this6 = this;\n\n    if (this.props.onFinish) this.props.onFinish(child, domNode);\n\n    // Reduce the number of children we need to animate by 1,\n    // so that we can tell when all children have finished.\n    this.remainingAnimations -= 1;\n\n    if (this.remainingAnimations === 0) {\n      // Remove any items from the DOM that have left, and reset `entering`.\n      var nextChildren = this.state.children.filter(function (_ref2) {\n        var leaving = _ref2.leaving;\n        return !leaving;\n      }).map(function (item) {\n        return _extends({}, item, {\n          // fix for Flow\n          element: item.element,\n          appearing: false,\n          entering: false\n        });\n      });\n\n      this.setState({ children: nextChildren }, function () {\n        if (typeof _this6.props.onFinishAll === 'function') {\n          _this6.callChildrenHook(_this6.props.onFinishAll);\n        }\n\n        // Reset our variables for the next iteration\n        _this6.childrenToAnimate = [];\n      });\n\n      // If the placeholder was holding the container open while elements were\n      // leaving, we we can now set its height to zero.\n      if (this.heightPlaceholderData.domNode) {\n        this.heightPlaceholderData.domNode.style.height = '0';\n      }\n    }\n  };\n\n  FlipMove.prototype.callChildrenHook = function callChildrenHook(hook) {\n    var _this7 = this;\n\n    var elements = [];\n    var domNodes = [];\n\n    this.childrenToAnimate.forEach(function (childKey) {\n      // If this was an exit animation, the child may no longer exist.\n      // If so, skip it.\n      var child = _this7.findChildByKey(childKey);\n\n      if (!child) {\n        return;\n      }\n\n      elements.push(child);\n\n      if (_this7.hasChildData(childKey)) {\n        domNodes.push(_this7.getChildData(childKey).domNode);\n      }\n    });\n\n    hook(elements, domNodes);\n  };\n\n  FlipMove.prototype.updateBoundingBoxCaches = function updateBoundingBoxCaches() {\n    var _this8 = this;\n\n    // This is the ONLY place that parentData and childrenData's\n    // bounding boxes are updated. They will be calculated at other times\n    // to be compared to this value, but it's important that the cache is\n    // updated once per update.\n    var parentDomNode = this.parentData.domNode;\n\n    if (!parentDomNode) {\n      return;\n    }\n\n    this.parentData.boundingBox = this.props.getPosition(parentDomNode);\n\n    // Splitting DOM reads and writes to be peformed in batches\n    var childrenBoundingBoxes = [];\n\n    this.state.children.forEach(function (child) {\n      var childKey = getKey(child);\n\n      // It is possible that a child does not have a `key` property;\n      // Ignore these children, they don't need to be moved.\n      if (!childKey) {\n        childrenBoundingBoxes.push(null);\n        return;\n      }\n\n      // In very rare circumstances, for reasons unknown, the ref is never\n      // populated for certain children. In this case, avoid doing this update.\n      // see: https://github.com/joshwcomeau/react-flip-move/pull/91\n      if (!_this8.hasChildData(childKey)) {\n        childrenBoundingBoxes.push(null);\n        return;\n      }\n\n      var childData = _this8.getChildData(childKey);\n\n      // If the child element returns null, we need to avoid trying to\n      // account for it\n      if (!childData.domNode || !child) {\n        childrenBoundingBoxes.push(null);\n        return;\n      }\n\n      childrenBoundingBoxes.push(getRelativeBoundingBox({\n        childDomNode: childData.domNode,\n        parentDomNode: parentDomNode,\n        getPosition: _this8.props.getPosition\n      }));\n    });\n\n    this.state.children.forEach(function (child, index) {\n      var childKey = getKey(child);\n\n      var childBoundingBox = childrenBoundingBoxes[index];\n\n      if (!childKey) {\n        return;\n      }\n\n      _this8.setChildData(childKey, {\n        boundingBox: childBoundingBox\n      });\n    });\n  };\n\n  FlipMove.prototype.computeInitialStyles = function computeInitialStyles(child) {\n    if (child.appearing) {\n      return this.props.appearAnimation ? this.props.appearAnimation.from : {};\n    } else if (child.entering) {\n      if (!this.props.enterAnimation) {\n        return {};\n      }\n      // If this child was in the middle of leaving, it still has its\n      // absolute positioning styles applied. We need to undo those.\n      return _extends({\n        position: '',\n        top: '',\n        left: '',\n        right: '',\n        bottom: ''\n      }, this.props.enterAnimation.from);\n    } else if (child.leaving) {\n      return this.props.leaveAnimation ? this.props.leaveAnimation.from : {};\n    }\n\n    var childData = this.getChildData(getKey(child));\n    var childDomNode = childData.domNode;\n    var childBoundingBox = childData.boundingBox;\n    var parentBoundingBox = this.parentData.boundingBox;\n\n    if (!childDomNode) {\n      return {};\n    }\n\n    var _getPositionDelta2 = getPositionDelta({\n      childDomNode: childDomNode,\n      childBoundingBox: childBoundingBox,\n      parentBoundingBox: parentBoundingBox,\n      getPosition: this.props.getPosition\n    }),\n        dX = _getPositionDelta2[0],\n        dY = _getPositionDelta2[1];\n\n    return {\n      transform: 'translate(' + dX + 'px, ' + dY + 'px)'\n    };\n  };\n\n  // eslint-disable-next-line class-methods-use-this\n\n\n  FlipMove.prototype.isAnimationDisabled = function isAnimationDisabled(props) {\n    // If the component is explicitly passed a `disableAllAnimations` flag,\n    // we can skip this whole process. Similarly, if all of the numbers have\n    // been set to 0, there is no point in trying to animate; doing so would\n    // only cause a flicker (and the intent is probably to disable animations)\n    // We can also skip this rigamarole if there's no browser support for it.\n    return noBrowserSupport || props.disableAllAnimations || props.duration === 0 && props.delay === 0 && props.staggerDurationBy === 0 && props.staggerDelayBy === 0;\n  };\n\n  FlipMove.prototype.findChildByKey = function findChildByKey(key) {\n    return find(function (child) {\n      return getKey(child) === key;\n    }, this.state.children);\n  };\n\n  FlipMove.prototype.hasChildData = function hasChildData(key) {\n    // Object has some built-in properties on its prototype, such as toString.  hasOwnProperty makes\n    // sure that key is present on childrenData itself, not on its prototype.\n    return Object.prototype.hasOwnProperty.call(this.childrenData, key);\n  };\n\n  FlipMove.prototype.getChildData = function getChildData(key) {\n    return this.hasChildData(key) ? this.childrenData[key] : {};\n  };\n\n  FlipMove.prototype.setChildData = function setChildData(key, data) {\n    this.childrenData[key] = _extends({}, this.getChildData(key), data);\n  };\n\n  FlipMove.prototype.removeChildData = function removeChildData(key) {\n    delete this.childrenData[key];\n    this.setState(function (prevState) {\n      return _extends({}, prevState, {\n        children: prevState.children.filter(function (child) {\n          return child.element.key !== key;\n        })\n      });\n    });\n  };\n\n  FlipMove.prototype.createHeightPlaceholder = function createHeightPlaceholder() {\n    var _this9 = this;\n\n    var typeName = this.props.typeName;\n\n    // If requested, create an invisible element at the end of the list.\n    // Its height will be modified to prevent the container from collapsing\n    // prematurely.\n\n    var isContainerAList = typeName === 'ul' || typeName === 'ol';\n    var placeholderType = isContainerAList ? 'li' : 'div';\n\n    return createElement(placeholderType, {\n      key: 'height-placeholder',\n      ref: function ref(domNode) {\n        _this9.heightPlaceholderData.domNode = domNode;\n      },\n      style: { visibility: 'hidden', height: 0 }\n    });\n  };\n\n  FlipMove.prototype.childrenWithRefs = function childrenWithRefs() {\n    var _this10 = this;\n\n    // We need to clone the provided children, capturing a reference to the\n    // underlying DOM node. Flip Move needs to use the React escape hatches to\n    // be able to do its calculations.\n    return this.state.children.map(function (child) {\n      return cloneElement(child.element, {\n        ref: function ref(element) {\n          // Stateless Functional Components are not supported by FlipMove,\n          // because they don't have instances.\n          if (!element) {\n            return;\n          }\n\n          var domNode = getNativeNode(element);\n          _this10.setChildData(getKey(child), { domNode: domNode });\n        }\n      });\n    });\n  };\n\n  FlipMove.prototype.render = function render() {\n    var _this11 = this;\n\n    var _props2 = this.props,\n        typeName = _props2.typeName,\n        delegated = _props2.delegated,\n        leaveAnimation = _props2.leaveAnimation,\n        maintainContainerHeight = _props2.maintainContainerHeight;\n\n\n    var children = this.childrenWithRefs();\n    if (leaveAnimation && maintainContainerHeight) {\n      children.push(this.createHeightPlaceholder());\n    }\n\n    if (!typeName) return children;\n\n    var props = _extends({}, delegated, {\n      children: children,\n      ref: function ref(node) {\n        _this11.parentData.domNode = node;\n      }\n    });\n\n    return createElement(typeName, props);\n  };\n\n  return FlipMove;\n}(Component);\n\nvar enhancedFlipMove = /* #__PURE__ */propConverter(FlipMove$1);\n\n/**\n * React Flip Move\n * (c) 2016-present Joshua Comeau\n */\n\nexport default enhancedFlipMove;\n","module.exports = __webpack_public_path__ + \"static/media/UploadIcon.1cedb6e9.svg\";","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport { isFragment } from 'react-is';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {},\n\n  /* Styles applied to the root element if `orientation=\"horizontal\"`. */\n  horizontal: {\n    paddingLeft: 8,\n    paddingRight: 8\n  },\n\n  /* Styles applied to the root element if `orientation=\"vertical\"`. */\n  vertical: {},\n\n  /* Styles applied to the root element if `alternativeLabel={true}`. */\n  alternativeLabel: {\n    flex: 1,\n    position: 'relative'\n  },\n\n  /* Pseudo-class applied to the root element if `completed={true}`. */\n  completed: {}\n};\nvar Step = React.forwardRef(function Step(props, ref) {\n  var _props$active = props.active,\n      active = _props$active === void 0 ? false : _props$active,\n      alternativeLabel = props.alternativeLabel,\n      children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$completed = props.completed,\n      completed = _props$completed === void 0 ? false : _props$completed,\n      connector = props.connector,\n      _props$disabled = props.disabled,\n      disabled = _props$disabled === void 0 ? false : _props$disabled,\n      _props$expanded = props.expanded,\n      expanded = _props$expanded === void 0 ? false : _props$expanded,\n      index = props.index,\n      last = props.last,\n      orientation = props.orientation,\n      other = _objectWithoutProperties(props, [\"active\", \"alternativeLabel\", \"children\", \"classes\", \"className\", \"completed\", \"connector\", \"disabled\", \"expanded\", \"index\", \"last\", \"orientation\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, classes[orientation], className, alternativeLabel && classes.alternativeLabel, completed && classes.completed),\n    ref: ref\n  }, other), connector && alternativeLabel && index !== 0 && React.cloneElement(connector, {\n    orientation: orientation,\n    alternativeLabel: alternativeLabel,\n    index: index,\n    active: active,\n    completed: completed,\n    disabled: disabled\n  }), React.Children.map(children, function (child) {\n    if (!React.isValidElement(child)) {\n      return null;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (isFragment(child)) {\n        console.error([\"Material-UI: The Step component doesn't accept a Fragment as a child.\", 'Consider providing an array instead.'].join('\\n'));\n      }\n    }\n\n    return React.cloneElement(child, _extends({\n      active: active,\n      alternativeLabel: alternativeLabel,\n      completed: completed,\n      disabled: disabled,\n      expanded: expanded,\n      last: last,\n      icon: index + 1,\n      orientation: orientation\n    }, child.props));\n  }));\n});\nprocess.env.NODE_ENV !== \"production\" ? Step.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * Sets the step as active. Is passed to child components.\n   */\n  active: PropTypes.bool,\n\n  /**\n   * Should be `Step` sub-components such as `StepLabel`, `StepContent`.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * Mark the step as completed. Is passed to child components.\n   */\n  completed: PropTypes.bool,\n\n  /**\n   * Mark the step as disabled, will also disable the button if\n   * `StepButton` is a child of `Step`. Is passed to child components.\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * Expand the step.\n   */\n  expanded: PropTypes.bool\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiStep'\n})(Step);","import * as React from 'react';\nimport createSvgIcon from '../../utils/createSvgIcon';\n/**\n * @ignore - internal component.\n */\n\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z\"\n}), 'CheckCircle');","import * as React from 'react';\nimport createSvgIcon from '../../utils/createSvgIcon';\n/**\n * @ignore - internal component.\n */\n\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\"\n}), 'Warning');","import * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport CheckCircle from '../internal/svg-icons/CheckCircle';\nimport Warning from '../internal/svg-icons/Warning';\nimport withStyles from '../styles/withStyles';\nimport SvgIcon from '../SvgIcon';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'block',\n      color: theme.palette.text.disabled,\n      '&$completed': {\n        color: theme.palette.primary.main\n      },\n      '&$active': {\n        color: theme.palette.primary.main\n      },\n      '&$error': {\n        color: theme.palette.error.main\n      }\n    },\n\n    /* Styles applied to the SVG text element. */\n    text: {\n      fill: theme.palette.primary.contrastText,\n      fontSize: theme.typography.caption.fontSize,\n      fontFamily: theme.typography.fontFamily\n    },\n\n    /* Pseudo-class applied to the root element if `active={true}`. */\n    active: {},\n\n    /* Pseudo-class applied to the root element if `completed={true}`. */\n    completed: {},\n\n    /* Pseudo-class applied to the root element if `error={true}`. */\n    error: {}\n  };\n};\n\nvar _ref = /*#__PURE__*/React.createElement(\"circle\", {\n  cx: \"12\",\n  cy: \"12\",\n  r: \"12\"\n});\n\nvar StepIcon = React.forwardRef(function StepIcon(props, ref) {\n  var _props$completed = props.completed,\n      completed = _props$completed === void 0 ? false : _props$completed,\n      icon = props.icon,\n      _props$active = props.active,\n      active = _props$active === void 0 ? false : _props$active,\n      _props$error = props.error,\n      error = _props$error === void 0 ? false : _props$error,\n      classes = props.classes;\n\n  if (typeof icon === 'number' || typeof icon === 'string') {\n    var className = clsx(classes.root, active && classes.active, error && classes.error, completed && classes.completed);\n\n    if (error) {\n      return /*#__PURE__*/React.createElement(Warning, {\n        className: className,\n        ref: ref\n      });\n    }\n\n    if (completed) {\n      return /*#__PURE__*/React.createElement(CheckCircle, {\n        className: className,\n        ref: ref\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(SvgIcon, {\n      className: className,\n      ref: ref\n    }, _ref, /*#__PURE__*/React.createElement(\"text\", {\n      className: classes.text,\n      x: \"12\",\n      y: \"16\",\n      textAnchor: \"middle\"\n    }, icon));\n  }\n\n  return icon;\n});\nprocess.env.NODE_ENV !== \"production\" ? StepIcon.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * Whether this step is active.\n   */\n  active: PropTypes.bool,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * Mark the step as completed. Is passed to child components.\n   */\n  completed: PropTypes.bool,\n\n  /**\n   * Mark the step as failed.\n   */\n  error: PropTypes.bool,\n\n  /**\n   * The label displayed in the step icon.\n   */\n  icon: PropTypes.node\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiStepIcon'\n})(StepIcon);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport Typography from '../Typography';\nimport StepIcon from '../StepIcon';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'flex',\n      alignItems: 'center',\n      '&$alternativeLabel': {\n        flexDirection: 'column'\n      },\n      '&$disabled': {\n        cursor: 'default'\n      }\n    },\n\n    /* Styles applied to the root element if `orientation=\"horizontal\"`. */\n    horizontal: {},\n\n    /* Styles applied to the root element if `orientation=\"vertical\"`. */\n    vertical: {},\n\n    /* Styles applied to the `Typography` component which wraps `children`. */\n    label: {\n      color: theme.palette.text.secondary,\n      '&$active': {\n        color: theme.palette.text.primary,\n        fontWeight: 500\n      },\n      '&$completed': {\n        color: theme.palette.text.primary,\n        fontWeight: 500\n      },\n      '&$alternativeLabel': {\n        textAlign: 'center',\n        marginTop: 16\n      },\n      '&$error': {\n        color: theme.palette.error.main\n      }\n    },\n\n    /* Pseudo-class applied to the `Typography` component if `active={true}`. */\n    active: {},\n\n    /* Pseudo-class applied to the `Typography` component if `completed={true}`. */\n    completed: {},\n\n    /* Pseudo-class applied to the root element and `Typography` component if `error={true}`. */\n    error: {},\n\n    /* Pseudo-class applied to the root element and `Typography` component if `disabled={true}`. */\n    disabled: {},\n\n    /* Styles applied to the `icon` container element. */\n    iconContainer: {\n      flexShrink: 0,\n      // Fix IE 11 issue\n      display: 'flex',\n      paddingRight: 8,\n      '&$alternativeLabel': {\n        paddingRight: 0\n      }\n    },\n\n    /* Pseudo-class applied to the root and icon container and `Typography` if `alternativeLabel={true}`. */\n    alternativeLabel: {},\n\n    /* Styles applied to the container element which wraps `Typography` and `optional`. */\n    labelContainer: {\n      width: '100%'\n    }\n  };\n};\nvar StepLabel = React.forwardRef(function StepLabel(props, ref) {\n  var _props$active = props.active,\n      active = _props$active === void 0 ? false : _props$active,\n      _props$alternativeLab = props.alternativeLabel,\n      alternativeLabel = _props$alternativeLab === void 0 ? false : _props$alternativeLab,\n      children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$completed = props.completed,\n      completed = _props$completed === void 0 ? false : _props$completed,\n      _props$disabled = props.disabled,\n      disabled = _props$disabled === void 0 ? false : _props$disabled,\n      _props$error = props.error,\n      error = _props$error === void 0 ? false : _props$error,\n      expanded = props.expanded,\n      icon = props.icon,\n      last = props.last,\n      optional = props.optional,\n      _props$orientation = props.orientation,\n      orientation = _props$orientation === void 0 ? 'horizontal' : _props$orientation,\n      StepIconComponentProp = props.StepIconComponent,\n      StepIconProps = props.StepIconProps,\n      other = _objectWithoutProperties(props, [\"active\", \"alternativeLabel\", \"children\", \"classes\", \"className\", \"completed\", \"disabled\", \"error\", \"expanded\", \"icon\", \"last\", \"optional\", \"orientation\", \"StepIconComponent\", \"StepIconProps\"]);\n\n  var StepIconComponent = StepIconComponentProp;\n\n  if (icon && !StepIconComponent) {\n    StepIconComponent = StepIcon;\n  }\n\n  return /*#__PURE__*/React.createElement(\"span\", _extends({\n    className: clsx(classes.root, classes[orientation], className, disabled && classes.disabled, alternativeLabel && classes.alternativeLabel, error && classes.error),\n    ref: ref\n  }, other), icon || StepIconComponent ? /*#__PURE__*/React.createElement(\"span\", {\n    className: clsx(classes.iconContainer, alternativeLabel && classes.alternativeLabel)\n  }, /*#__PURE__*/React.createElement(StepIconComponent, _extends({\n    completed: completed,\n    active: active,\n    error: error,\n    icon: icon\n  }, StepIconProps))) : null, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.labelContainer\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"body2\",\n    component: \"span\",\n    className: clsx(classes.label, alternativeLabel && classes.alternativeLabel, completed && classes.completed, active && classes.active, error && classes.error),\n    display: \"block\"\n  }, children), optional));\n});\nprocess.env.NODE_ENV !== \"production\" ? StepLabel.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * In most cases will simply be a string containing a title for the label.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * Mark the step as disabled, will also disable the button if\n   * `StepLabelButton` is a child of `StepLabel`. Is passed to child components.\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * Mark the step as failed.\n   */\n  error: PropTypes.bool,\n\n  /**\n   * Override the default label of the step icon.\n   */\n  icon: PropTypes.node,\n\n  /**\n   * The optional node to display.\n   */\n  optional: PropTypes.node,\n\n  /**\n   * The component to render in place of the [`StepIcon`](/api/step-icon/).\n   */\n  StepIconComponent: PropTypes.elementType,\n\n  /**\n   * Props applied to the [`StepIcon`](/api/step-icon/) element.\n   */\n  StepIconProps: PropTypes.object\n} : void 0;\nStepLabel.muiName = 'StepLabel';\nexport default withStyles(styles, {\n  name: 'MuiStepLabel'\n})(StepLabel);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      flex: '1 1 auto'\n    },\n\n    /* Styles applied to the root element if `orientation=\"horizontal\"`. */\n    horizontal: {},\n\n    /* Styles applied to the root element if `orientation=\"vertical\"`. */\n    vertical: {\n      marginLeft: 12,\n      // half icon\n      padding: '0 0 8px'\n    },\n\n    /* Styles applied to the root element if `alternativeLabel={true}`. */\n    alternativeLabel: {\n      position: 'absolute',\n      top: 8 + 4,\n      left: 'calc(-50% + 20px)',\n      right: 'calc(50% + 20px)'\n    },\n\n    /* Pseudo-class applied to the root element if `active={true}`. */\n    active: {},\n\n    /* Pseudo-class applied to the root element if `completed={true}`. */\n    completed: {},\n\n    /* Pseudo-class applied to the root element if `disabled={true}`. */\n    disabled: {},\n\n    /* Styles applied to the line element. */\n    line: {\n      display: 'block',\n      borderColor: theme.palette.type === 'light' ? theme.palette.grey[400] : theme.palette.grey[600]\n    },\n\n    /* Styles applied to the root element if `orientation=\"horizontal\"`. */\n    lineHorizontal: {\n      borderTopStyle: 'solid',\n      borderTopWidth: 1\n    },\n\n    /* Styles applied to the root element if `orientation=\"vertical\"`. */\n    lineVertical: {\n      borderLeftStyle: 'solid',\n      borderLeftWidth: 1,\n      minHeight: 24\n    }\n  };\n};\nvar StepConnector = React.forwardRef(function StepConnector(props, ref) {\n  var active = props.active,\n      _props$alternativeLab = props.alternativeLabel,\n      alternativeLabel = _props$alternativeLab === void 0 ? false : _props$alternativeLab,\n      classes = props.classes,\n      className = props.className,\n      completed = props.completed,\n      disabled = props.disabled,\n      index = props.index,\n      _props$orientation = props.orientation,\n      orientation = _props$orientation === void 0 ? 'horizontal' : _props$orientation,\n      other = _objectWithoutProperties(props, [\"active\", \"alternativeLabel\", \"classes\", \"className\", \"completed\", \"disabled\", \"index\", \"orientation\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, classes[orientation], className, alternativeLabel && classes.alternativeLabel, active && classes.active, completed && classes.completed, disabled && classes.disabled),\n    ref: ref\n  }, other), /*#__PURE__*/React.createElement(\"span\", {\n    className: clsx(classes.line, {\n      'horizontal': classes.lineHorizontal,\n      'vertical': classes.lineVertical\n    }[orientation])\n  }));\n});\nprocess.env.NODE_ENV !== \"production\" ? StepConnector.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiStepConnector'\n})(StepConnector);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport Paper from '../Paper';\nimport StepConnector from '../StepConnector';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    display: 'flex',\n    padding: 24\n  },\n\n  /* Styles applied to the root element if `orientation=\"horizontal\"`. */\n  horizontal: {\n    flexDirection: 'row',\n    alignItems: 'center'\n  },\n\n  /* Styles applied to the root element if `orientation=\"vertical\"`. */\n  vertical: {\n    flexDirection: 'column'\n  },\n\n  /* Styles applied to the root element if `alternativeLabel={true}`. */\n  alternativeLabel: {\n    alignItems: 'flex-start'\n  }\n};\nvar defaultConnector = /*#__PURE__*/React.createElement(StepConnector, null);\nvar Stepper = React.forwardRef(function Stepper(props, ref) {\n  var _props$activeStep = props.activeStep,\n      activeStep = _props$activeStep === void 0 ? 0 : _props$activeStep,\n      _props$alternativeLab = props.alternativeLabel,\n      alternativeLabel = _props$alternativeLab === void 0 ? false : _props$alternativeLab,\n      children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$connector = props.connector,\n      connectorProp = _props$connector === void 0 ? defaultConnector : _props$connector,\n      _props$nonLinear = props.nonLinear,\n      nonLinear = _props$nonLinear === void 0 ? false : _props$nonLinear,\n      _props$orientation = props.orientation,\n      orientation = _props$orientation === void 0 ? 'horizontal' : _props$orientation,\n      other = _objectWithoutProperties(props, [\"activeStep\", \"alternativeLabel\", \"children\", \"classes\", \"className\", \"connector\", \"nonLinear\", \"orientation\"]);\n\n  var connector = React.isValidElement(connectorProp) ? React.cloneElement(connectorProp, {\n    orientation: orientation\n  }) : null;\n  var childrenArray = React.Children.toArray(children);\n  var steps = childrenArray.map(function (step, index) {\n    var controlProps = {\n      alternativeLabel: alternativeLabel,\n      connector: connectorProp,\n      last: index + 1 === childrenArray.length,\n      orientation: orientation\n    };\n    var state = {\n      index: index,\n      active: false,\n      completed: false,\n      disabled: false\n    };\n\n    if (activeStep === index) {\n      state.active = true;\n    } else if (!nonLinear && activeStep > index) {\n      state.completed = true;\n    } else if (!nonLinear && activeStep < index) {\n      state.disabled = true;\n    }\n\n    return [!alternativeLabel && connector && index !== 0 && React.cloneElement(connector, _extends({\n      key: index\n    }, state)), React.cloneElement(step, _extends(_extends(_extends({}, controlProps), state), step.props))];\n  });\n  return /*#__PURE__*/React.createElement(Paper, _extends({\n    square: true,\n    elevation: 0,\n    className: clsx(classes.root, classes[orientation], className, alternativeLabel && classes.alternativeLabel),\n    ref: ref\n  }, other), steps);\n});\nprocess.env.NODE_ENV !== \"production\" ? Stepper.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * Set the active step (zero based index).\n   * Set to -1 to disable all the steps.\n   */\n  activeStep: PropTypes.number,\n\n  /**\n   * If set to 'true' and orientation is horizontal,\n   * then the step label will be positioned under the icon.\n   */\n  alternativeLabel: PropTypes.bool,\n\n  /**\n   * Two or more `<Step />` components.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * An element to be placed between each step.\n   */\n  connector: PropTypes.element,\n\n  /**\n   * If set the `Stepper` will not assist in controlling steps for linear flow.\n   */\n  nonLinear: PropTypes.bool,\n\n  /**\n   * The stepper orientation (layout flow direction).\n   */\n  orientation: PropTypes.oneOf(['horizontal', 'vertical'])\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiStepper'\n})(Stepper);"],"sourceRoot":""}